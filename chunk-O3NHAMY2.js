import{a as Ae,b as Wt}from"./chunk-5EU4ND3L.js";import{a as tn,b as zn}from"./chunk-562WGZFS.js";import{a as me,b as _t}from"./chunk-FDJYKZED.js";import{a as ke,b as Ln}from"./chunk-QHM7Z56U.js";import{a as D,b as ft}from"./chunk-DQYI455W.js";import{c as pe,d as ht}from"./chunk-PVQPB666.js";import{a as en,b as $n}from"./chunk-4LG2RD24.js";import{a as de,b as Nn}from"./chunk-UOQFKZ5Q.js";import{a as Ji,b as Pn}from"./chunk-ITSNA3JG.js";import{a as Zi,b as On}from"./chunk-DKBVEZ2J.js";import{$ as nt,Ca as lt,Da as Ui,F as Mi,Fa as Qi,G as ki,H as Ai,Ha as Wi,I as Mn,Ia as He,J as Pi,K as kn,Ka as pt,L as Oi,Ma as dt,Na as mt,O as Ni,P as $i,Pa as qi,Q as Re,R as ze,Ra as ut,S as Li,Sa as Gi,T as zi,Ta as Ki,U as zt,Ua as Yi,V as it,Va as Xi,W as Vi,Wa as Me,X as ji,_ as Fe,aa as Ve,c as wi,da as w,ea as Bi,f as Fn,fa as ot,ga as Te,h as Di,ha as O,i as Tn,ia as rt,ja as at,ka as st,la as je,ma as H,na as Hi,oa as Be,u as Ei,v as Ri,w as Fi,x as tt,y as Ti,ya as ct,z as Lt}from"./chunk-OX4MXTMU.js";import{$b as m,Aa as M,Ab as f,Bc as gi,Cc as bi,Cd as An,D as ai,Da as mi,Ea as ui,Eb as _e,Ec as yi,Fb as d,Ga as re,Gb as _i,Hb as P,I as si,Ia as ae,Jb as Ee,Ka as Ye,Kb as vi,La as hi,Lb as _,Lc as ee,M as R,Ma as se,Mb as Z,Na as ce,Nb as Xe,Oa as Ne,Ob as $,Pb as L,Pc as le,Q as ci,Qb as l,Qc as Si,Rb as p,Rc as xi,Sb as y,V as li,Vb as ve,Vc as C,Wb as A,Y as xe,Z as pi,Zb as S,Zc as Ot,_ as he,a as V,aa as Ge,ac as ge,b as Q,ba as J,bc as be,ca as Rt,cb as De,cc as K,cd as Nt,dc as Je,dd as Ci,e as W,ea as Ke,ec as j,fa as Ce,fc as B,ga as Ie,hd as Ii,i as qe,ia as Pe,ib as c,jb as g,jc as Mt,ka as Oe,kc as b,la as u,lb as fe,lc as Y,ma as Ft,mc as kt,md as $t,n as N,na as Tt,o as ni,pa as F,pd as Vt,qa as we,qb as fi,qd as jt,ra as q,rc as At,rd as Bt,sc as k,tb as G,tc as v,td as ye,u as oe,uc as z,ud as Se,v as oi,vc as x,wb as $e,wc as Ze,wd as Ht,xb as Le,xc as et,xd as Ut,y as E,ya as di,yc as Pt,yd as Qt,z as ri,za as T}from"./chunk-LUSYJMV7.js";var ue,Ue=W(()=>{"use strict";C();Be();Me();J();Nn();Ln();C();ue=(()=>{let o=class o{constructor(){this._networkService=u(Qi),this._reservations$=new ni([]),this.refresh$=new N,this.date=G(new Date),this.reservations$=this._reservations$.asObservable(),this.filteredReservations$=ri([this._reservations$,Hi(this.date)]).pipe(E(([e,t])=>{let n=(t.getMonth()+1).toString().padStart(2,"0"),r=t.getFullYear();return e.filter(s=>s.bookedDate.startsWith(`${r}-${n}`))})),this.customersLov$=this._reservations$.pipe(E(e=>{let t=new Map;for(let n of e){let r=n.person.name.toLowerCase().trim();t.has(r)||t.set(r,n.person.name.trim())}return Array.from(t.values()).map(n=>({name:n,value:n})).sort((n,r)=>n.name.localeCompare(r.name))})),this.source$=this._reservations$.pipe(E(e=>{let t=new Map;for(let n of e){let r=n.source?.toLowerCase().trim()||"";t.has(r)||t.set(r,n.source?.trim()||"")}return Array.from(t.values()).map(n=>({name:n,value:n})).sort((n,r)=>n.name.localeCompare(r.name))}))}changeDate(e){this.date.update(t=>{if(typeof e=="string"){let n=new Date(t);return n.setDate(15),e==="next"?n.setMonth(t.getMonth()+1):n.setMonth(t.getMonth()-1),n}else return new Date(e.year,e.month-1,15)})}getReservations(){this._networkService.get(de.RESERVATIONS.reservations).pipe(R(1)).subscribe({next:e=>{e.data&&this._reservations$.next(e.data.map(t=>this._updateReservation(t)))}})}addReservation(e){this._networkService.post(de.RESERVATIONS.reservations,e).pipe(R(1)).subscribe(t=>{t.data&&ke.UpdateArrayBehaviorSubject(this._reservations$,this._updateReservation(t.data),"add","_id")})}updateReservation(e){this._networkService.patch(de.RESERVATIONS.reservations,e,e._id).pipe(R(1)).subscribe(t=>{t.data&&ke.UpdateArrayBehaviorSubject(this._reservations$,this._updateReservation(t.data),"edit","_id")})}addRevenue(e,t,n,r,s){this._networkService.post(de.REVENUES,{reservationId:e._id,name:t,notes:s,amount:n,date:r}).pipe(R(1)).subscribe(h=>{if(h){let I=Q(V({},e),{revenues:e.revenues?e.revenues:[]});I.revenues?.push({amount:n,revenueId:""}),ke.UpdateArrayBehaviorSubject(this._reservations$,this._updateReservation(I),"edit","_id"),this.refresh$.next()}})}addExpense(e,t,n,r,s){this._networkService.post(de.EXPENSES,{reservationId:e._id,name:t,notes:s,amount:n,date:r}).pipe(R(1)).subscribe(h=>{if(h){let I=Q(V({},e),{expenses:e.expenses?e.expenses:[]});I.expenses?.push({amount:n,expenseId:""}),ke.UpdateArrayBehaviorSubject(this._reservations$,this._updateReservation(I),"edit","_id"),this.refresh$.next()}})}deleteReservation(e,t){this._networkService.delete(de.RESERVATIONS.reservations,t,e._id).pipe(R(1)).subscribe(()=>{ke.UpdateArrayBehaviorSubject(this._reservations$,e,"delete","_id")})}addMultipleReservation(e,t){this._networkService.post(de.RESERVATIONS.multiple,{bookedDates:e,sharedBody:t}).pipe(R(1)).subscribe({next:()=>{this.getReservations()}})}_updateReservation(e){let t=e.revenues?.reduce((n,r)=>n+r.amount,0)||0;return Q(V({},e),{done:!e.price||t===e.price,deposit:!!e.price&&t>0&&t<e.price,amountPayed:e.revenues?.reduce((n,r)=>n+(r.amount||0),0)})}};o.\u0275fac=function(t){return new(t||o)},o.\u0275prov=Ce({token:o,factory:o.\u0275fac,providedIn:"root"});let i=o;return i})()});var vt,qt=W(()=>{"use strict";C();Ve();C();vt=(()=>{let o=class o{constructor(){this.tooltip=u(Fe)}onTouchStart(){this.tooltip.show()}};o.\u0275fac=function(t){return new(t||o)},o.\u0275dir=q({type:o,selectors:[["","dir-tooltip",""]],hostBindings:function(t,n){t&1&&S("touchstart",function(s){return n.onTouchStart(s)})},standalone:!0});let i=o;return i})()});function Bn(i,o){i&1&&(l(0,"div",2),y(1,"ks-base-icon",6),p()),i&2&&(d("matTooltip",o),c(),d("config",v(2,jn)))}function Hn(i,o){if(i&1&&(l(0,"div",5)(1,"span",7),b(2),p()()),i&2){let a=o.$implicit;c(2),Y(a)}}function Un(i,o){if(i&1){let a=A();l(0,"button",10),S("click",function(){T(a);let t=m().$implicit,n=m(2);return M(n.selectDate(t))}),b(1),p()}if(i&2){let a=m().$implicit,e=m(2);Ee(e.getClass(a)),P("editor",e.isAdmin||e.isEditor),c(),kt(" ",a," ")}}function Qn(i,o){if(i&1&&(l(0,"div",8),f(1,Un,2,5,"button",9),p()),i&2){let a=o.$implicit;c(),_(a?1:-1)}}function Wn(i,o){if(i&1&&(l(0,"div",4),$(1,Qn,2,1,"div",8,Z),p()),i&2){let a=o.$implicit;c(),L(a)}}var jn,nn,on=W(()=>{"use strict";C();Be();Ve();Me();J();ht();_t();Ue();ft();qt();C();Ve();jn=()=>({icon:"icon_information_in_circle"});nn=(()=>{let o=class o{constructor(){this._cdr=u(ee),this._destroyRef=u(re),this._sharedService=u(me),this._sessionService=u(pe),this._reservationService=u(ue),this._date=this._reservationService.date,this._reservations=[],this.dateOutput=new ae,this.weeks=[],this.bungalow=se.required(),this.isAdmin=this._sessionService.checkAccess(D.ADMIN),this.isEditor=this._sessionService.checkAccess(D.ACTIVE),this.weekDays=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]}ngOnInit(){this._reservationService.filteredReservations$.pipe(H(this._destroyRef)).pipe(E(e=>e.filter(t=>t.bungalowId===this.bungalow()._id))).subscribe(e=>{this._reservations=e,this.generateCalendar()})}selectDate(e){if(e===0)return;let t=this._date().getMonth(),n=this._date().getFullYear(),r=this._sharedService.getUtcDate(new Date(n,t,e)),s={date:r,bungalowId:this.bungalow()._id,reservation:this._reservations.find(h=>this._sharedService.getUtcDate(h.bookedDate).getTime()===r.getTime())};this.dateOutput.emit(s)}getClass(e){let t="click d-flex align-items-center justify-content-center ",n=this._reservations.find(r=>new Date(r.bookedDate).getDate()===e);return n&&(t+=" bg-success ",n.deposit&&(t+=" bg-danger "),n.done&&(t=t.replace("bg-success",""),t=t.replace("bg-danger",""),t+=" bg-primary ")),t}generateCalendar(){let e=this._date().getFullYear(),t=this._date().getMonth(),n=new Date(e,t,1),s=new Date(e,t+1,0).getDate(),h=n.getDay();this.weeks=[];let I=1;for(let U=0;U<6;U++){let X=[];for(let Et=0;Et<7;Et++)U===0&&Et<h||I>s?X.push(0):(X.push(I),I++);this.weeks.push(X)}this._cdr.markForCheck()}};o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=F({type:o,selectors:[["reservations-calendar"]],inputs:{bungalow:[1,"bungalow"]},outputs:{dateOutput:"dateOutput"},standalone:!0,features:[k],decls:12,vars:2,consts:[[1,"cs-shadow","pt-3","pb-0","pt-sm-4","pb-sm-2"],[1,"d-flex","align-items-center","justify-content-center","mb-3","name"],["dir-tooltip","",1,"ms-2",3,"matTooltip"],[1,"shared-calendar","mx-auto"],[1,"d7"],[1,"d-flex","align-items-center","justify-content-center","w-100","pb-3"],[3,"config"],[1,"day","d-flex","align-items-center","justify-content-center"],[1,"d-flex","align-items-center","justify-content-center","w-100","pb-2"],[1,"click","d-flex","align-items-center","justify-content-center",3,"class","editor"],[1,"click","d-flex","align-items-center","justify-content-center",3,"click"]],template:function(t,n){if(t&1&&(l(0,"div",0)(1,"div",1),b(2),f(3,Bn,2,3,"div",2),p(),l(4,"div",3)(5,"div")(6,"div",4),$(7,Hn,3,1,"div",5,Z),p(),l(9,"div"),$(10,Wn,3,0,"div",4,Z),p()()()()),t&2){let r;c(2),kt(" ",n.bungalow().name," "),c(),_((r=n.bungalow().description)?3:-1,r),c(4),L(n.weekDays),c(3),L(n.weeks)}},dependencies:[pt,nt,Fe,vt],styles:[".shared-calendar[_ngcontent-%COMP%]{max-width:700px}.name[_ngcontent-%COMP%]{font-size:16px;font-weight:500;text-align:center}.d7[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr 1fr 1fr 1fr 1fr 1fr}.day[_ngcontent-%COMP%]{font-weight:bolder;font-size:15px;color:var(--primary-color)}.click[_ngcontent-%COMP%]{border-radius:40%;width:40px;height:40px;background-color:#52545b;border:none;color:#fff;font-weight:700;cursor:pointer}.editor[_ngcontent-%COMP%]:hover{background-color:#7e7e99}.editor[_ngcontent-%COMP%]:active{background-color:var(--primary-color)}@media screen and (max-width: 400px){.click[_ngcontent-%COMP%]{width:30px;height:30px}}"],changeDetection:0});let i=o;return i})()});function Jn(i,o){i&1&&be(0)}var Xn,Gt,Kt,Zn,ie,Yt,gt,bt,rn,an=W(()=>{"use strict";$i();Lt();Lt();kn();C();C();je();Fi();J();Rt();Xn=["*"];Gt=(()=>{let o=class o{constructor(e){this._elementRef=e}focus(){this._elementRef.nativeElement.focus()}};o.\u0275fac=function(t){return new(t||o)(g(ce))},o.\u0275dir=q({type:o,selectors:[["","cdkStepHeader",""]],hostAttrs:["role","tab"],standalone:!0});let i=o;return i})(),Kt=(()=>{let o=class o{constructor(e){this.template=e}};o.\u0275fac=function(t){return new(t||o)(g(fe))},o.\u0275dir=q({type:o,selectors:[["","cdkStepLabel",""]],standalone:!0});let i=o;return i})(),Zn=0,ie={NUMBER:"number",EDIT:"edit",DONE:"done",ERROR:"error"},Yt=new Pe("STEPPER_GLOBAL_OPTIONS"),gt=(()=>{let o=class o{get completed(){return this._completedOverride==null?this._getDefaultCompleted():this._completedOverride}set completed(e){this._completedOverride=e}_getDefaultCompleted(){return this.stepControl?this.stepControl.valid&&this.interacted:this.interacted}get hasError(){return this._customError==null?this._getDefaultError():this._customError}set hasError(e){this._customError=e}_getDefaultError(){return this.stepControl&&this.stepControl.invalid&&this.interacted}constructor(e,t){this._stepper=e,this.interacted=!1,this.interactedStream=new ae,this.editable=!0,this.optional=!1,this._completedOverride=null,this._customError=null,this._stepperOptions=t||{},this._displayDefaultIndicatorType=this._stepperOptions.displayDefaultIndicatorType!==!1}select(){this._stepper.selected=this}reset(){this.interacted=!1,this._completedOverride!=null&&(this._completedOverride=!1),this._customError!=null&&(this._customError=!1),this.stepControl&&(this._childForms?.forEach(e=>e.resetForm?.()),this.stepControl.reset())}ngOnChanges(){this._stepper._stateChanged()}_markAsInteracted(){this.interacted||(this.interacted=!0,this.interactedStream.emit(this))}_showError(){return this._stepperOptions.showError??this._customError!=null}};o.\u0275fac=function(t){return new(t||o)(g(Ke(()=>bt)),g(Yt,8))},o.\u0275cmp=F({type:o,selectors:[["cdk-step"]],contentQueries:function(t,n,r){if(t&1&&(K(r,Kt,5),K(r,Bi,5)),t&2){let s;j(s=B())&&(n.stepLabel=s.first),j(s=B())&&(n._childForms=s)}},viewQuery:function(t,n){if(t&1&&Je(fe,7),t&2){let r;j(r=B())&&(n.content=r.first)}},inputs:{stepControl:"stepControl",label:"label",errorMessage:"errorMessage",ariaLabel:[0,"aria-label","ariaLabel"],ariaLabelledby:[0,"aria-labelledby","ariaLabelledby"],state:"state",editable:[2,"editable","editable",le],optional:[2,"optional","optional",le],completed:[2,"completed","completed",le],hasError:[2,"hasError","hasError",le]},outputs:{interactedStream:"interacted"},exportAs:["cdkStep"],standalone:!0,features:[Le,di,k],ngContentSelectors:Xn,decls:1,vars:0,template:function(t,n){t&1&&(ge(),f(0,Jn,1,0,"ng-template"))},encapsulation:2,changeDetection:0});let i=o;return i})(),bt=(()=>{let o=class o{get selectedIndex(){return this._selectedIndex}set selectedIndex(e){this.steps&&this._steps?(this._isValidIndex(e),this.selected?._markAsInteracted(),this._selectedIndex!==e&&!this._anyControlsInvalidOrPending(e)&&(e>=this._selectedIndex||this.steps.toArray()[e].editable)&&this._updateSelectedItemIndex(e)):this._selectedIndex=e}get selected(){return this.steps?this.steps.toArray()[this.selectedIndex]:void 0}set selected(e){this.selectedIndex=e&&this.steps?this.steps.toArray().indexOf(e):-1}get orientation(){return this._orientation}set orientation(e){this._orientation=e,this._keyManager&&this._keyManager.withVerticalOrientation(e==="vertical")}constructor(e,t,n){this._dir=e,this._changeDetectorRef=t,this._elementRef=n,this._destroyed=new N,this.steps=new Ne,this._sortedHeaders=new Ne,this.linear=!1,this._selectedIndex=0,this.selectionChange=new ae,this.selectedIndexChange=new ae,this._orientation="horizontal",this._groupId=Zn++}ngAfterContentInit(){this._steps.changes.pipe(xe(this._steps),he(this._destroyed)).subscribe(e=>{this.steps.reset(e.filter(t=>t._stepper===this)),this.steps.notifyOnChanges()})}ngAfterViewInit(){this._stepHeader.changes.pipe(xe(this._stepHeader),he(this._destroyed)).subscribe(e=>{this._sortedHeaders.reset(e.toArray().sort((t,n)=>t._elementRef.nativeElement.compareDocumentPosition(n._elementRef.nativeElement)&Node.DOCUMENT_POSITION_FOLLOWING?-1:1)),this._sortedHeaders.notifyOnChanges()}),this._keyManager=new Oi(this._sortedHeaders).withWrap().withHomeAndEnd().withVerticalOrientation(this._orientation==="vertical"),(this._dir?this._dir.change:oe()).pipe(xe(this._layoutDirection()),he(this._destroyed)).subscribe(e=>this._keyManager.withHorizontalOrientation(e)),this._keyManager.updateActiveItem(this._selectedIndex),this.steps.changes.subscribe(()=>{this.selected||(this._selectedIndex=Math.max(this._selectedIndex-1,0))}),this._isValidIndex(this._selectedIndex)||(this._selectedIndex=0)}ngOnDestroy(){this._keyManager?.destroy(),this.steps.destroy(),this._sortedHeaders.destroy(),this._destroyed.next(),this._destroyed.complete()}next(){this.selectedIndex=Math.min(this._selectedIndex+1,this.steps.length-1)}previous(){this.selectedIndex=Math.max(this._selectedIndex-1,0)}reset(){this._updateSelectedItemIndex(0),this.steps.forEach(e=>e.reset()),this._stateChanged()}_getStepLabelId(e){return`cdk-step-label-${this._groupId}-${e}`}_getStepContentId(e){return`cdk-step-content-${this._groupId}-${e}`}_stateChanged(){this._changeDetectorRef.markForCheck()}_getAnimationDirection(e){let t=e-this._selectedIndex;return t<0?this._layoutDirection()==="rtl"?"next":"previous":t>0?this._layoutDirection()==="rtl"?"previous":"next":"current"}_getIndicatorType(e,t=ie.NUMBER){let n=this.steps.toArray()[e],r=this._isCurrentStep(e);return n._displayDefaultIndicatorType?this._getDefaultIndicatorLogic(n,r):this._getGuidelineLogic(n,r,t)}_getDefaultIndicatorLogic(e,t){return e._showError()&&e.hasError&&!t?ie.ERROR:!e.completed||t?ie.NUMBER:e.editable?ie.EDIT:ie.DONE}_getGuidelineLogic(e,t,n=ie.NUMBER){return e._showError()&&e.hasError&&!t?ie.ERROR:e.completed&&!t?ie.DONE:e.completed&&t?n:e.editable&&t?ie.EDIT:n}_isCurrentStep(e){return this._selectedIndex===e}_getFocusIndex(){return this._keyManager?this._keyManager.activeItemIndex:this._selectedIndex}_updateSelectedItemIndex(e){let t=this.steps.toArray();this.selectionChange.emit({selectedIndex:e,previouslySelectedIndex:this._selectedIndex,selectedStep:t[e],previouslySelectedStep:t[this._selectedIndex]}),this._containsFocus()?this._keyManager.setActiveItem(e):this._keyManager.updateActiveItem(e),this._selectedIndex=e,this.selectedIndexChange.emit(this._selectedIndex),this._stateChanged()}_onKeydown(e){let t=Pi(e),n=e.keyCode,r=this._keyManager;r.activeItemIndex!=null&&!t&&(n===32||n===13)?(this.selectedIndex=r.activeItemIndex,e.preventDefault()):r.setFocusOrigin("keyboard").onKeydown(e)}_anyControlsInvalidOrPending(e){return this.linear&&e>=0?this.steps.toArray().slice(0,e).some(t=>{let n=t.stepControl;return(n?n.invalid||n.pending||!t.interacted:!t.completed)&&!t.optional&&!t._completedOverride}):!1}_layoutDirection(){return this._dir&&this._dir.value==="rtl"?"rtl":"ltr"}_containsFocus(){let e=this._elementRef.nativeElement,t=Ri();return e===t||e.contains(t)}_isValidIndex(e){return e>-1&&(!this.steps||e<this.steps.length)}};o.\u0275fac=function(t){return new(t||o)(g(tt,8),g(ee),g(ce))},o.\u0275dir=q({type:o,selectors:[["","cdkStepper",""]],contentQueries:function(t,n,r){if(t&1&&(K(r,gt,5),K(r,Gt,5)),t&2){let s;j(s=B())&&(n._steps=s),j(s=B())&&(n._stepHeader=s)}},inputs:{linear:[2,"linear","linear",le],selectedIndex:[2,"selectedIndex","selectedIndex",Si],selected:"selected",orientation:"orientation"},outputs:{selectionChange:"selectionChange",selectedIndexChange:"selectedIndexChange"},exportAs:["cdkStepper"],standalone:!0,features:[Le]});let i=o;return i})(),rn=(()=>{let o=class o{};o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=we({type:o}),o.\u0275inj=Ie({imports:[Ti]});let i=o;return i})()});function to(){if(yt===void 0&&(yt=null,typeof window<"u")){let i=window;i.trustedTypes!==void 0&&(yt=i.trustedTypes.createPolicy("angular#components",{createHTML:o=>o}))}return yt}function Qe(i){return to()?.createHTML(i)||i}function sn(i){return Error(`Unable to find icon with the name "${i}"`)}function io(){return Error("Could not find HttpClient for use with Angular Material icons. Please add provideHttpClient() to your providers.")}function cn(i){return Error(`The URL provided to MatIconRegistry was not trusted as a resource URL via Angular's DomSanitizer. Attempted URL was "${i}".`)}function ln(i){return Error(`The literal provided to MatIconRegistry was not trusted as safe HTML by Angular's DomSanitizer. Attempted literal was "${i}".`)}function St(i){return i.cloneNode(!0)}function pn(i,o){return i+":"+o}function oo(i){return!!(i.url&&i.options)}function so(){let i=u(Ot),o=i?i.location:null;return{getPathname:()=>o?o.pathname+o.search:""}}var eo,yt,ne,no,ro,ao,dn,co,lo,mn,un,hn=W(()=>{"use strict";C();C();zt();$t();J();Rt();Fn();Tn();eo=["*"];ne=class{constructor(o,a,e){this.url=o,this.svgText=a,this.options=e}},no=(()=>{let o=class o{constructor(e,t,n,r){this._httpClient=e,this._sanitizer=t,this._errorHandler=r,this._svgIconConfigs=new Map,this._iconSetConfigs=new Map,this._cachedIconsByUrl=new Map,this._inProgressUrlFetches=new Map,this._fontCssClassesByAlias=new Map,this._resolvers=[],this._defaultFontSetClass=["material-icons","mat-ligature-font"],this._document=n}addSvgIcon(e,t,n){return this.addSvgIconInNamespace("",e,t,n)}addSvgIconLiteral(e,t,n){return this.addSvgIconLiteralInNamespace("",e,t,n)}addSvgIconInNamespace(e,t,n,r){return this._addSvgIconConfig(e,t,new ne(n,null,r))}addSvgIconResolver(e){return this._resolvers.push(e),this}addSvgIconLiteralInNamespace(e,t,n,r){let s=this._sanitizer.sanitize(De.HTML,n);if(!s)throw ln(n);let h=Qe(s);return this._addSvgIconConfig(e,t,new ne("",h,r))}addSvgIconSet(e,t){return this.addSvgIconSetInNamespace("",e,t)}addSvgIconSetLiteral(e,t){return this.addSvgIconSetLiteralInNamespace("",e,t)}addSvgIconSetInNamespace(e,t,n){return this._addSvgIconSetConfig(e,new ne(t,null,n))}addSvgIconSetLiteralInNamespace(e,t,n){let r=this._sanitizer.sanitize(De.HTML,t);if(!r)throw ln(t);let s=Qe(r);return this._addSvgIconSetConfig(e,new ne("",s,n))}registerFontClassAlias(e,t=e){return this._fontCssClassesByAlias.set(e,t),this}classNameForFontAlias(e){return this._fontCssClassesByAlias.get(e)||e}setDefaultFontSetClass(...e){return this._defaultFontSetClass=e,this}getDefaultFontSetClass(){return this._defaultFontSetClass}getSvgIconFromUrl(e){let t=this._sanitizer.sanitize(De.RESOURCE_URL,e);if(!t)throw cn(e);let n=this._cachedIconsByUrl.get(t);return n?oe(St(n)):this._loadSvgIconFromConfig(new ne(e,null)).pipe(Ge(r=>this._cachedIconsByUrl.set(t,r)),E(r=>St(r)))}getNamedSvgIcon(e,t=""){let n=pn(t,e),r=this._svgIconConfigs.get(n);if(r)return this._getSvgFromConfig(r);if(r=this._getIconConfigFromResolvers(t,e),r)return this._svgIconConfigs.set(n,r),this._getSvgFromConfig(r);let s=this._iconSetConfigs.get(t);return s?this._getSvgFromIconSetConfigs(e,s):oi(sn(n))}ngOnDestroy(){this._resolvers=[],this._svgIconConfigs.clear(),this._iconSetConfigs.clear(),this._cachedIconsByUrl.clear()}_getSvgFromConfig(e){return e.svgText?oe(St(this._svgElementFromConfig(e))):this._loadSvgIconFromConfig(e).pipe(E(t=>St(t)))}_getSvgFromIconSetConfigs(e,t){let n=this._extractIconWithNameFromAnySet(e,t);if(n)return oe(n);let r=t.filter(s=>!s.svgText).map(s=>this._loadSvgIconSetFromConfig(s).pipe(si(h=>{let U=`Loading icon set URL: ${this._sanitizer.sanitize(De.RESOURCE_URL,s.url)} failed: ${h.message}`;return this._errorHandler.handleError(new Error(U)),oe(null)})));return ai(r).pipe(E(()=>{let s=this._extractIconWithNameFromAnySet(e,t);if(!s)throw sn(e);return s}))}_extractIconWithNameFromAnySet(e,t){for(let n=t.length-1;n>=0;n--){let r=t[n];if(r.svgText&&r.svgText.toString().indexOf(e)>-1){let s=this._svgElementFromConfig(r),h=this._extractSvgIconFromSet(s,e,r.options);if(h)return h}}return null}_loadSvgIconFromConfig(e){return this._fetchIcon(e).pipe(Ge(t=>e.svgText=t),E(()=>this._svgElementFromConfig(e)))}_loadSvgIconSetFromConfig(e){return e.svgText?oe(null):this._fetchIcon(e).pipe(Ge(t=>e.svgText=t))}_extractSvgIconFromSet(e,t,n){let r=e.querySelector(`[id="${t}"]`);if(!r)return null;let s=r.cloneNode(!0);if(s.removeAttribute("id"),s.nodeName.toLowerCase()==="svg")return this._setSvgAttributes(s,n);if(s.nodeName.toLowerCase()==="symbol")return this._setSvgAttributes(this._toSvgElement(s),n);let h=this._svgElementFromString(Qe("<svg></svg>"));return h.appendChild(s),this._setSvgAttributes(h,n)}_svgElementFromString(e){let t=this._document.createElement("DIV");t.innerHTML=e;let n=t.querySelector("svg");if(!n)throw Error("<svg> tag not found");return n}_toSvgElement(e){let t=this._svgElementFromString(Qe("<svg></svg>")),n=e.attributes;for(let r=0;r<n.length;r++){let{name:s,value:h}=n[r];s!=="id"&&t.setAttribute(s,h)}for(let r=0;r<e.childNodes.length;r++)e.childNodes[r].nodeType===this._document.ELEMENT_NODE&&t.appendChild(e.childNodes[r].cloneNode(!0));return t}_setSvgAttributes(e,t){return e.setAttribute("fit",""),e.setAttribute("height","100%"),e.setAttribute("width","100%"),e.setAttribute("preserveAspectRatio","xMidYMid meet"),e.setAttribute("focusable","false"),t&&t.viewBox&&e.setAttribute("viewBox",t.viewBox),e}_fetchIcon(e){let{url:t,options:n}=e,r=n?.withCredentials??!1;if(!this._httpClient)throw io();if(t==null)throw Error(`Cannot fetch icon from URL "${t}".`);let s=this._sanitizer.sanitize(De.RESOURCE_URL,t);if(!s)throw cn(t);let h=this._inProgressUrlFetches.get(s);if(h)return h;let I=this._httpClient.get(s,{responseType:"text",withCredentials:r}).pipe(E(U=>Qe(U)),ci(()=>this._inProgressUrlFetches.delete(s)),li());return this._inProgressUrlFetches.set(s,I),I}_addSvgIconConfig(e,t,n){return this._svgIconConfigs.set(pn(e,t),n),this}_addSvgIconSetConfig(e,t){let n=this._iconSetConfigs.get(e);return n?n.push(t):this._iconSetConfigs.set(e,[t]),this}_svgElementFromConfig(e){if(!e.svgElement){let t=this._svgElementFromString(e.svgText);this._setSvgAttributes(t,e.options),e.svgElement=t}return e.svgElement}_getIconConfigFromResolvers(e,t){for(let n=0;n<this._resolvers.length;n++){let r=this._resolvers[n](t,e);if(r)return oo(r)?new ne(r.url,null,r.options):new ne(r,null)}}};o.\u0275fac=function(t){return new(t||o)(Oe(wi,8),Oe(Di),Oe(Ot,8),Oe(Ye))},o.\u0275prov=Ce({token:o,factory:o.\u0275fac,providedIn:"root"});let i=o;return i})();ro=new Pe("MAT_ICON_DEFAULT_OPTIONS"),ao=new Pe("mat-icon-location",{providedIn:"root",factory:so});dn=["clip-path","color-profile","src","cursor","fill","filter","marker","marker-start","marker-mid","marker-end","mask","stroke"],co=dn.map(i=>`[${i}]`).join(", "),lo=/^url\(['"]?#(.*?)['"]?\)$/,mn=(()=>{let o=class o{get color(){return this._color||this._defaultColor}set color(e){this._color=e}get svgIcon(){return this._svgIcon}set svgIcon(e){e!==this._svgIcon&&(e?this._updateSvgIcon(e):this._svgIcon&&this._clearSvgElement(),this._svgIcon=e)}get fontSet(){return this._fontSet}set fontSet(e){let t=this._cleanupFontValue(e);t!==this._fontSet&&(this._fontSet=t,this._updateFontIconClasses())}get fontIcon(){return this._fontIcon}set fontIcon(e){let t=this._cleanupFontValue(e);t!==this._fontIcon&&(this._fontIcon=t,this._updateFontIconClasses())}constructor(e,t,n,r,s,h){this._elementRef=e,this._iconRegistry=t,this._location=r,this._errorHandler=s,this.inline=!1,this._previousFontSetClass=[],this._currentIconFetch=qe.EMPTY,h&&(h.color&&(this.color=this._defaultColor=h.color),h.fontSet&&(this.fontSet=h.fontSet)),n||e.nativeElement.setAttribute("aria-hidden","true")}_splitIconName(e){if(!e)return["",""];let t=e.split(":");switch(t.length){case 1:return["",t[0]];case 2:return t;default:throw Error(`Invalid icon name: "${e}"`)}}ngOnInit(){this._updateFontIconClasses()}ngAfterViewChecked(){let e=this._elementsWithExternalReferences;if(e&&e.size){let t=this._location.getPathname();t!==this._previousPath&&(this._previousPath=t,this._prependPathToReferences(t))}}ngOnDestroy(){this._currentIconFetch.unsubscribe(),this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear()}_usingFontIcon(){return!this.svgIcon}_setSvgElement(e){this._clearSvgElement();let t=this._location.getPathname();this._previousPath=t,this._cacheChildrenWithExternalReferences(e),this._prependPathToReferences(t),this._elementRef.nativeElement.appendChild(e)}_clearSvgElement(){let e=this._elementRef.nativeElement,t=e.childNodes.length;for(this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear();t--;){let n=e.childNodes[t];(n.nodeType!==1||n.nodeName.toLowerCase()==="svg")&&n.remove()}}_updateFontIconClasses(){if(!this._usingFontIcon())return;let e=this._elementRef.nativeElement,t=(this.fontSet?this._iconRegistry.classNameForFontAlias(this.fontSet).split(/ +/):this._iconRegistry.getDefaultFontSetClass()).filter(n=>n.length>0);this._previousFontSetClass.forEach(n=>e.classList.remove(n)),t.forEach(n=>e.classList.add(n)),this._previousFontSetClass=t,this.fontIcon!==this._previousFontIconClass&&!t.includes("mat-ligature-font")&&(this._previousFontIconClass&&e.classList.remove(this._previousFontIconClass),this.fontIcon&&e.classList.add(this.fontIcon),this._previousFontIconClass=this.fontIcon)}_cleanupFontValue(e){return typeof e=="string"?e.trim().split(" ")[0]:e}_prependPathToReferences(e){let t=this._elementsWithExternalReferences;t&&t.forEach((n,r)=>{n.forEach(s=>{r.setAttribute(s.name,`url('${e}#${s.value}')`)})})}_cacheChildrenWithExternalReferences(e){let t=e.querySelectorAll(co),n=this._elementsWithExternalReferences=this._elementsWithExternalReferences||new Map;for(let r=0;r<t.length;r++)dn.forEach(s=>{let h=t[r],I=h.getAttribute(s),U=I?I.match(lo):null;if(U){let X=n.get(h);X||(X=[],n.set(h,X)),X.push({name:s,value:U[1]})}})}_updateSvgIcon(e){if(this._svgNamespace=null,this._svgName=null,this._currentIconFetch.unsubscribe(),e){let[t,n]=this._splitIconName(e);t&&(this._svgNamespace=t),n&&(this._svgName=n),this._currentIconFetch=this._iconRegistry.getNamedSvgIcon(n,t).pipe(R(1)).subscribe(r=>this._setSvgElement(r),r=>{let s=`Error retrieving icon ${t}:${n}! ${r.message}`;this._errorHandler.handleError(new Error(s))})}}};o.\u0275fac=function(t){return new(t||o)(g(ce),g(no),ui("aria-hidden"),g(ao),g(Ye),g(ro,8))},o.\u0275cmp=F({type:o,selectors:[["mat-icon"]],hostAttrs:["role","img",1,"mat-icon","notranslate"],hostVars:10,hostBindings:function(t,n){t&2&&(_e("data-mat-icon-type",n._usingFontIcon()?"font":"svg")("data-mat-icon-name",n._svgName||n.fontIcon)("data-mat-icon-namespace",n._svgNamespace||n.fontSet)("fontIcon",n._usingFontIcon()?n.fontIcon:null),Ee(n.color?"mat-"+n.color:""),P("mat-icon-inline",n.inline)("mat-icon-no-color",n.color!=="primary"&&n.color!=="accent"&&n.color!=="warn"))},inputs:{color:"color",inline:[2,"inline","inline",le],svgIcon:"svgIcon",fontSet:"fontSet",fontIcon:"fontIcon"},exportAs:["matIcon"],standalone:!0,features:[Le,k],ngContentSelectors:eo,decls:1,vars:0,template:function(t,n){t&1&&(ge(),be(0))},styles:["mat-icon,mat-icon.mat-primary,mat-icon.mat-accent,mat-icon.mat-warn{color:var(--mat-icon-color)}.mat-icon{-webkit-user-select:none;user-select:none;background-repeat:no-repeat;display:inline-block;fill:currentColor;height:24px;width:24px;overflow:hidden}.mat-icon.mat-icon-inline{font-size:inherit;height:inherit;line-height:inherit;width:inherit}.mat-icon.mat-ligature-font[fontIcon]::before{content:attr(fontIcon)}[dir=rtl] .mat-icon-rtl-mirror{transform:scale(-1, 1)}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon{display:block}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button .mat-icon{margin:auto}"],encapsulation:2,changeDetection:0});let i=o;return i})(),un=(()=>{let o=class o{};o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=we({type:o}),o.\u0275inj=Ie({imports:[Re,Re]});let i=o;return i})()});function po(i,o){if(i&1&&ve(0,2),i&2){let a=m();d("ngTemplateOutlet",a.iconOverrides[a.state])("ngTemplateOutletContext",a._getIconContext())}}function mo(i,o){if(i&1&&(l(0,"span",7),b(1),p()),i&2){let a=m(2);c(),Y(a._getDefaultTextForState(a.state))}}function uo(i,o){if(i&1&&(l(0,"span",8),b(1),p()),i&2){let a=m(3);c(),Y(a._intl.completedLabel)}}function ho(i,o){if(i&1&&(l(0,"span",8),b(1),p()),i&2){let a=m(3);c(),Y(a._intl.editableLabel)}}function fo(i,o){if(i&1&&(f(0,uo,2,1,"span",8)(1,ho,2,1,"span",8),l(2,"mat-icon",7),b(3),p()),i&2){let a=m(2);_(a.state==="done"?0:a.state==="edit"?1:-1),c(3),Y(a._getDefaultTextForState(a.state))}}function _o(i,o){if(i&1&&f(0,mo,2,1,"span",7)(1,fo,4,2,"mat-icon",7),i&2){let a,e=m();_((a=e.state)==="number"?0:1)}}function vo(i,o){i&1&&(l(0,"div",4),ve(1,9),p()),i&2&&(c(),d("ngTemplateOutlet",o.template))}function go(i,o){if(i&1&&(l(0,"div",4),b(1),p()),i&2){let a=m();c(),Y(a.label)}}function bo(i,o){if(i&1&&(l(0,"div",5),b(1),p()),i&2){let a=m();c(),Y(a._intl.optionalLabel)}}function yo(i,o){if(i&1&&(l(0,"div",6),b(1),p()),i&2){let a=m();c(),Y(a.errorMessage)}}function So(i,o){}function xo(i,o){if(i&1&&(be(0),f(1,So,0,0,"ng-template",0)),i&2){let a=m();c(),d("cdkPortalOutlet",a._portal)}}function Co(i,o){i&1&&be(0)}function Io(i,o){i&1&&y(0,"div",6)}function wo(i,o){if(i&1&&(ve(0,5),f(1,Io,1,0,"div",6)),i&2){let a=o.$implicit,e=o.$index,t=o.$count;m(2);let n=Mt(4);d("ngTemplateOutlet",n)("ngTemplateOutletContext",x(3,vn,a,e)),c(),_(e!==t-1?1:-1)}}function Do(i,o){if(i&1){let a=A();l(0,"div",7),S("@horizontalStepTransition.done",function(t){T(a);let n=m(2);return M(n._animationDone.next(t))}),ve(1,8),p()}if(i&2){let a=o.$implicit,e=o.$index,t=m(2);P("mat-horizontal-stepper-content-inactive",t.selectedIndex!==e),d("@horizontalStepTransition",x(8,bn,t._getAnimationDirection(e),z(6,gn,t._getAnimationDuration())))("id",t._getStepContentId(e)),_e("aria-labelledby",t._getStepLabelId(e)),c(),d("ngTemplateOutlet",a.content)}}function Eo(i,o){if(i&1&&(l(0,"div",1)(1,"div",2),$(2,wo,2,6,null,null,Xe),p(),l(4,"div",3),$(5,Do,2,11,"div",4,Xe),p()()),i&2){let a=m();c(2),L(a.steps),c(3),L(a.steps)}}function Ro(i,o){if(i&1){let a=A();l(0,"div",9),ve(1,5),l(2,"div",10)(3,"div",11),S("@verticalStepTransition.done",function(t){T(a);let n=m(2);return M(n._animationDone.next(t))}),l(4,"div",12),ve(5,8),p()()()()}if(i&2){let a=o.$implicit,e=o.$index,t=o.$count,n=m(2),r=Mt(4);c(),d("ngTemplateOutlet",r)("ngTemplateOutletContext",x(10,vn,a,e)),c(),P("mat-stepper-vertical-line",e!==t-1),c(),P("mat-vertical-stepper-content-inactive",n.selectedIndex!==e),d("@verticalStepTransition",x(15,bn,n._getAnimationDirection(e),z(13,gn,n._getAnimationDuration())))("id",n._getStepContentId(e)),_e("aria-labelledby",n._getStepLabelId(e)),c(2),d("ngTemplateOutlet",a.content)}}function Fo(i,o){if(i&1&&$(0,Ro,6,18,"div",9,Xe),i&2){let a=m();L(a.steps)}}function To(i,o){if(i&1){let a=A();l(0,"mat-step-header",13),S("click",function(){let t=T(a).step;return M(t.select())})("keydown",function(t){T(a);let n=m();return M(n._onKeydown(t))}),p()}if(i&2){let a=o.step,e=o.i,t=m();P("mat-horizontal-stepper-header",t.orientation==="horizontal")("mat-vertical-stepper-header",t.orientation==="vertical"),d("tabIndex",t._getFocusIndex()===e?0:-1)("id",t._getStepLabelId(e))("index",e)("state",t._getIndicatorType(e,a.state))("label",a.stepLabel||a.label)("selected",t.selectedIndex===e)("active",t._stepIsNavigable(e,a))("optional",a.optional)("errorMessage",a.errorMessage)("iconOverrides",t._iconOverrides)("disableRipple",t.disableRipple||!t._stepIsNavigable(e,a))("color",a.color||t.color),_e("aria-posinset",e+1)("aria-setsize",t.steps.length)("aria-controls",t._getStepContentId(e))("aria-selected",t.selectedIndex==e)("aria-label",a.ariaLabel||null)("aria-labelledby",!a.ariaLabel&&a.ariaLabelledby?a.ariaLabelledby:null)("aria-disabled",t._stepIsNavigable(e,a)?null:!0)}}function Mo(i){return i||new xt}var _n,vn,gn,bn,We,xt,ko,Xt,yn,Sn,fn,Ao,Po,Jt,Ct,xn,Zt=W(()=>{"use strict";Mn();an();$t();C();C();zt();zt();hn();$i();J();Lt();Rt();An();Fi();_n=["*"];vn=(i,o)=>({step:i,i:o}),gn=i=>({animationDuration:i}),bn=(i,o)=>({value:i,params:o});We=(()=>{let o=class o extends Kt{};o.\u0275fac=(()=>{let e;return function(n){return(e||(e=mi(o)))(n||o)}})(),o.\u0275dir=q({type:o,selectors:[["","matStepLabel",""]],standalone:!0,features:[$e]});let i=o;return i})(),xt=(()=>{let o=class o{constructor(){this.changes=new N,this.optionalLabel="Optional",this.completedLabel="Completed",this.editableLabel="Editable"}};o.\u0275fac=function(t){return new(t||o)},o.\u0275prov=Ce({token:o,factory:o.\u0275fac,providedIn:"root"});let i=o;return i})();ko={provide:xt,deps:[[new Ft,new Tt,xt]],useFactory:Mo},Xt=(()=>{let o=class o extends Gt{constructor(e,t,n,r){super(n),this._intl=e,this._focusMonitor=t,this._intlSubscription=e.changes.subscribe(()=>r.markForCheck())}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){this._intlSubscription.unsubscribe(),this._focusMonitor.stopMonitoring(this._elementRef)}focus(e,t){e?this._focusMonitor.focusVia(this._elementRef,e,t):this._elementRef.nativeElement.focus(t)}_stringLabel(){return this.label instanceof We?null:this.label}_templateLabel(){return this.label instanceof We?this.label:null}_getHostElement(){return this._elementRef.nativeElement}_getIconContext(){return{index:this.index,active:this.active,optional:this.optional}}_getDefaultTextForState(e){return e=="number"?`${this.index+1}`:e=="edit"?"create":e=="error"?"warning":e}};o.\u0275fac=function(t){return new(t||o)(g(xt),g(Ni),g(ce),g(ee))},o.\u0275cmp=F({type:o,selectors:[["mat-step-header"]],hostAttrs:["role","tab",1,"mat-step-header"],hostVars:2,hostBindings:function(t,n){t&2&&Ee("mat-"+(n.color||"primary"))},inputs:{state:"state",label:"label",errorMessage:"errorMessage",iconOverrides:"iconOverrides",index:"index",selected:"selected",active:"active",optional:"optional",disableRipple:"disableRipple",color:"color"},standalone:!0,features:[$e,k],decls:10,vars:17,consts:[["matRipple","",1,"mat-step-header-ripple","mat-focus-indicator",3,"matRippleTrigger","matRippleDisabled"],[1,"mat-step-icon-content"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"mat-step-label"],[1,"mat-step-text-label"],[1,"mat-step-optional"],[1,"mat-step-sub-label-error"],["aria-hidden","true"],[1,"cdk-visually-hidden"],[3,"ngTemplateOutlet"]],template:function(t,n){if(t&1&&(y(0,"div",0),l(1,"div")(2,"div",1),f(3,po,1,2,"ng-container",2)(4,_o,2,1),p()(),l(5,"div",3),f(6,vo,2,1,"div",4)(7,go,2,1,"div",4)(8,bo,2,1,"div",5)(9,yo,2,1,"div",6),p()),t&2){let r;d("matRippleTrigger",n._getHostElement())("matRippleDisabled",n.disableRipple),c(),vi("mat-step-icon-state-",n.state," mat-step-icon"),P("mat-step-icon-selected",n.selected),c(2),_(n.iconOverrides&&n.iconOverrides[n.state]?3:4),c(2),P("mat-step-label-active",n.active)("mat-step-label-selected",n.selected)("mat-step-label-error",n.state=="error"),c(),_((r=n._templateLabel())?6:n._stringLabel()?7:-1,r),c(2),_(n.optional&&n.state!="error"?8:-1),c(),_(n.state==="error"?9:-1)}},dependencies:[Li,Nt,mn],styles:['.mat-step-header{overflow:hidden;outline:none;cursor:pointer;position:relative;box-sizing:content-box;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-step-header:focus .mat-focus-indicator::before{content:""}.mat-step-header:hover[aria-disabled=true]{cursor:default}.mat-step-header:hover:not([aria-disabled]),.mat-step-header:hover[aria-disabled=false]{background-color:var(--mat-stepper-header-hover-state-layer-color);border-radius:var(--mat-stepper-header-hover-state-layer-shape, var(--mat-app-corner-medium))}.mat-step-header.cdk-keyboard-focused,.mat-step-header.cdk-program-focused{background-color:var(--mat-stepper-header-focus-state-layer-color);border-radius:var(--mat-stepper-header-focus-state-layer-shape, var(--mat-app-corner-medium))}@media(hover: none){.mat-step-header:hover{background:none}}.cdk-high-contrast-active .mat-step-header{outline:solid 1px}.cdk-high-contrast-active .mat-step-header[aria-selected=true] .mat-step-label{text-decoration:underline}.cdk-high-contrast-active .mat-step-header[aria-disabled=true]{outline-color:GrayText}.cdk-high-contrast-active .mat-step-header[aria-disabled=true] .mat-step-label,.cdk-high-contrast-active .mat-step-header[aria-disabled=true] .mat-step-icon,.cdk-high-contrast-active .mat-step-header[aria-disabled=true] .mat-step-optional{color:GrayText}.mat-step-optional{font-size:12px;color:var(--mat-stepper-header-optional-label-text-color, var(--mat-app-on-surface-variant))}.mat-step-sub-label-error{font-size:12px;font-weight:normal}.mat-step-icon{border-radius:50%;height:24px;width:24px;flex-shrink:0;position:relative;color:var(--mat-stepper-header-icon-foreground-color, var(--mat-app-surface));background-color:var(--mat-stepper-header-icon-background-color, var(--mat-app-on-surface-variant))}.mat-step-icon-content{position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);display:flex}.mat-step-icon .mat-icon{font-size:16px;height:16px;width:16px}.mat-step-icon-state-error{background-color:var(--mat-stepper-header-error-state-icon-background-color);color:var(--mat-stepper-header-error-state-icon-foreground-color, var(--mat-app-error))}.mat-step-icon-state-error .mat-icon{font-size:24px;height:24px;width:24px}.mat-step-label{display:inline-block;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;min-width:50px;vertical-align:middle;font-family:var(--mat-stepper-header-label-text-font, var(--mat-app-title-small-font));font-size:var(--mat-stepper-header-label-text-size, var(--mat-app-title-small-size));font-weight:var(--mat-stepper-header-label-text-weight, var(--mat-app-title-small-weight));color:var(--mat-stepper-header-label-text-color, var(--mat-app-on-surface-variant))}.mat-step-label.mat-step-label-active{color:var(--mat-stepper-header-selected-state-label-text-color, var(--mat-app-on-surface-variant))}.mat-step-label.mat-step-label-error{color:var(--mat-stepper-header-error-state-label-text-color, var(--mat-app-error));font-size:var(--mat-stepper-header-error-state-label-text-size, var(--mat-app-title-small-size))}.mat-step-label.mat-step-label-selected{font-size:var(--mat-stepper-header-selected-state-label-text-size, var(--mat-app-title-small-size));font-weight:var(--mat-stepper-header-selected-state-label-text-weight, var(--mat-app-title-small-weight))}.mat-step-text-label{text-overflow:ellipsis;overflow:hidden}.mat-step-header .mat-step-header-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-step-icon-selected{background-color:var(--mat-stepper-header-selected-state-icon-background-color, var(--mat-app-primary));color:var(--mat-stepper-header-selected-state-icon-foreground-color, var(--mat-app-on-primary))}.mat-step-icon-state-done{background-color:var(--mat-stepper-header-done-state-icon-background-color);color:var(--mat-stepper-header-done-state-icon-foreground-color)}.mat-step-icon-state-edit{background-color:var(--mat-stepper-header-edit-state-icon-background-color, var(--mat-app-primary));color:var(--mat-stepper-header-edit-state-icon-foreground-color, var(--mat-app-on-primary))}'],encapsulation:2,changeDetection:0});let i=o;return i})(),yn="500ms",Sn="225ms",fn={horizontalStepTransition:Vt("horizontalStepTransition",[Se("previous",ye({transform:"translate3d(-100%, 0, 0)",visibility:"hidden"})),Se("current",ye({transform:"none",visibility:"inherit"})),Se("next",ye({transform:"translate3d(100%, 0, 0)",visibility:"hidden"})),Ht("* => *",Bt([jt("{{animationDuration}} cubic-bezier(0.35, 0, 0.25, 1)"),Qt("@*",Ut(),{optional:!0})]),{params:{animationDuration:yn}})]),verticalStepTransition:Vt("verticalStepTransition",[Se("previous",ye({height:"0px",visibility:"hidden"})),Se("next",ye({height:"0px",visibility:"hidden"})),Se("current",ye({height:"*",visibility:"inherit"})),Ht("* <=> current",Bt([jt("{{animationDuration}} cubic-bezier(0.4, 0.0, 0.2, 1)"),Qt("@*",Ut(),{optional:!0})]),{params:{animationDuration:Sn}})])},Ao=(()=>{let o=class o{constructor(e){this.templateRef=e}};o.\u0275fac=function(t){return new(t||o)(g(fe))},o.\u0275dir=q({type:o,selectors:[["ng-template","matStepperIcon",""]],inputs:{name:[0,"matStepperIcon","name"]},standalone:!0});let i=o;return i})(),Po=(()=>{let o=class o{constructor(e){this._template=e}};o.\u0275fac=function(t){return new(t||o)(g(fe))},o.\u0275dir=q({type:o,selectors:[["ng-template","matStepContent",""]],standalone:!0});let i=o;return i})(),Jt=(()=>{let o=class o extends gt{constructor(e,t,n,r){super(e,r),this._errorStateMatcher=t,this._viewContainerRef=n,this._isSelected=qe.EMPTY,this.stepLabel=void 0}ngAfterContentInit(){this._isSelected=this._stepper.steps.changes.pipe(pi(()=>this._stepper.selectionChange.pipe(E(e=>e.selectedStep===this),xe(this._stepper.selected===this)))).subscribe(e=>{e&&this._lazyContent&&!this._portal&&(this._portal=new Mi(this._lazyContent._template,this._viewContainerRef))})}ngOnDestroy(){this._isSelected.unsubscribe()}isErrorState(e,t){let n=this._errorStateMatcher.isErrorState(e,t),r=!!(e&&e.invalid&&this.interacted);return n||r}};o.\u0275fac=function(t){return new(t||o)(g(Ke(()=>Ct)),g(ze,4),g(fi),g(Yt,8))},o.\u0275cmp=F({type:o,selectors:[["mat-step"]],contentQueries:function(t,n,r){if(t&1&&(K(r,We,5),K(r,Po,5)),t&2){let s;j(s=B())&&(n.stepLabel=s.first),j(s=B())&&(n._lazyContent=s.first)}},hostAttrs:["hidden",""],inputs:{color:"color"},exportAs:["matStep"],standalone:!0,features:[At([{provide:ze,useExisting:o},{provide:gt,useExisting:o}]),$e,k],ngContentSelectors:_n,decls:1,vars:0,consts:[[3,"cdkPortalOutlet"]],template:function(t,n){t&1&&(ge(),f(0,xo,2,1,"ng-template"))},dependencies:[ki],encapsulation:2,changeDetection:0});let i=o;return i})(),Ct=(()=>{let o=class o extends bt{get animationDuration(){return this._animationDuration}set animationDuration(e){this._animationDuration=/^\d+$/.test(e)?e+"ms":e}constructor(e,t,n){super(e,t,n),this._stepHeader=void 0,this._steps=void 0,this.steps=new Ne,this.animationDone=new ae,this.labelPosition="end",this.headerPosition="top",this._iconOverrides={},this._animationDone=new N,this._animationDuration="",this._isServer=!u(Ei).isBrowser;let r=n.nativeElement.nodeName.toLowerCase();this.orientation=r==="mat-vertical-stepper"?"vertical":"horizontal"}ngAfterContentInit(){super.ngAfterContentInit(),this._icons.forEach(({name:e,templateRef:t})=>this._iconOverrides[e]=t),this.steps.changes.pipe(he(this._destroyed)).subscribe(()=>{this._stateChanged()}),this._animationDone.pipe(he(this._destroyed)).subscribe(e=>{e.toState==="current"&&this.animationDone.emit()})}_stepIsNavigable(e,t){return t.completed||this.selectedIndex===e||!this.linear}_getAnimationDuration(){return this.animationDuration?this.animationDuration:this.orientation==="horizontal"?yn:Sn}};o.\u0275fac=function(t){return new(t||o)(g(tt,8),g(ee),g(ce))},o.\u0275cmp=F({type:o,selectors:[["mat-stepper"],["mat-vertical-stepper"],["mat-horizontal-stepper"],["","matStepper",""]],contentQueries:function(t,n,r){if(t&1&&(K(r,Jt,5),K(r,Ao,5)),t&2){let s;j(s=B())&&(n._steps=s),j(s=B())&&(n._icons=s)}},viewQuery:function(t,n){if(t&1&&Je(Xt,5),t&2){let r;j(r=B())&&(n._stepHeader=r)}},hostAttrs:["role","tablist"],hostVars:11,hostBindings:function(t,n){t&2&&(_e("aria-orientation",n.orientation),P("mat-stepper-horizontal",n.orientation==="horizontal")("mat-stepper-vertical",n.orientation==="vertical")("mat-stepper-label-position-end",n.orientation==="horizontal"&&n.labelPosition=="end")("mat-stepper-label-position-bottom",n.orientation==="horizontal"&&n.labelPosition=="bottom")("mat-stepper-header-position-bottom",n.headerPosition==="bottom"))},inputs:{disableRipple:"disableRipple",color:"color",labelPosition:"labelPosition",headerPosition:"headerPosition",animationDuration:"animationDuration"},outputs:{animationDone:"animationDone"},exportAs:["matStepper","matVerticalStepper","matHorizontalStepper"],standalone:!0,features:[At([{provide:bt,useExisting:o}]),$e,k],ngContentSelectors:_n,decls:5,vars:2,consts:[["stepTemplate",""],[1,"mat-horizontal-stepper-wrapper"],[1,"mat-horizontal-stepper-header-container"],[1,"mat-horizontal-content-container"],["role","tabpanel",1,"mat-horizontal-stepper-content",3,"id","mat-horizontal-stepper-content-inactive"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"mat-stepper-horizontal-line"],["role","tabpanel",1,"mat-horizontal-stepper-content",3,"id"],[3,"ngTemplateOutlet"],[1,"mat-step"],[1,"mat-vertical-content-container"],["role","tabpanel",1,"mat-vertical-stepper-content",3,"id"],[1,"mat-vertical-content"],[3,"click","keydown","tabIndex","id","index","state","label","selected","active","optional","errorMessage","iconOverrides","disableRipple","color"]],template:function(t,n){if(t&1&&(ge(),f(0,Co,1,0)(1,Eo,7,0,"div",1)(2,Fo,2,0)(3,To,1,23,"ng-template",null,0,yi)),t&2){let r;_(n._isServer?0:-1),c(),_((r=n.orientation)==="horizontal"?1:r==="vertical"?2:-1)}},dependencies:[Nt,Xt],styles:['.mat-stepper-vertical,.mat-stepper-horizontal{display:block;font-family:var(--mat-stepper-container-text-font, var(--mat-app-body-medium-font));background:var(--mat-stepper-container-color, var(--mat-app-surface))}.mat-horizontal-stepper-header-container{white-space:nowrap;display:flex;align-items:center}.mat-stepper-label-position-bottom .mat-horizontal-stepper-header-container{align-items:flex-start}.mat-stepper-header-position-bottom .mat-horizontal-stepper-header-container{order:1}.mat-stepper-horizontal-line{border-top-width:1px;border-top-style:solid;flex:auto;height:0;margin:0 -16px;min-width:32px;border-top-color:var(--mat-stepper-line-color, var(--mat-app-outline))}.mat-stepper-label-position-bottom .mat-stepper-horizontal-line{margin:0;min-width:0;position:relative;top:calc(calc((var(--mat-stepper-header-height) - 24px) / 2) + 12px)}.mat-stepper-label-position-bottom .mat-horizontal-stepper-header:not(:first-child)::before,[dir=rtl] .mat-stepper-label-position-bottom .mat-horizontal-stepper-header:not(:last-child)::before,.mat-stepper-label-position-bottom .mat-horizontal-stepper-header:not(:last-child)::after,[dir=rtl] .mat-stepper-label-position-bottom .mat-horizontal-stepper-header:not(:first-child)::after{border-top-width:1px;border-top-style:solid;content:"";display:inline-block;height:0;position:absolute;width:calc(50% - 20px)}.mat-horizontal-stepper-header{display:flex;height:72px;overflow:hidden;align-items:center;padding:0 24px;height:var(--mat-stepper-header-height)}.mat-horizontal-stepper-header .mat-step-icon{margin-right:8px;flex:none}[dir=rtl] .mat-horizontal-stepper-header .mat-step-icon{margin-right:0;margin-left:8px}.mat-horizontal-stepper-header::before,.mat-horizontal-stepper-header::after{border-top-color:var(--mat-stepper-line-color, var(--mat-app-outline))}.mat-stepper-label-position-bottom .mat-horizontal-stepper-header{padding:calc((var(--mat-stepper-header-height) - 24px) / 2) 24px}.mat-stepper-label-position-bottom .mat-horizontal-stepper-header::before,.mat-stepper-label-position-bottom .mat-horizontal-stepper-header::after{top:calc(calc((var(--mat-stepper-header-height) - 24px) / 2) + 12px)}.mat-stepper-label-position-bottom .mat-horizontal-stepper-header{box-sizing:border-box;flex-direction:column;height:auto}.mat-stepper-label-position-bottom .mat-horizontal-stepper-header:not(:last-child)::after,[dir=rtl] .mat-stepper-label-position-bottom .mat-horizontal-stepper-header:not(:first-child)::after{right:0}.mat-stepper-label-position-bottom .mat-horizontal-stepper-header:not(:first-child)::before,[dir=rtl] .mat-stepper-label-position-bottom .mat-horizontal-stepper-header:not(:last-child)::before{left:0}[dir=rtl] .mat-stepper-label-position-bottom .mat-horizontal-stepper-header:last-child::before,[dir=rtl] .mat-stepper-label-position-bottom .mat-horizontal-stepper-header:first-child::after{display:none}.mat-stepper-label-position-bottom .mat-horizontal-stepper-header .mat-step-icon{margin-right:0;margin-left:0}.mat-stepper-label-position-bottom .mat-horizontal-stepper-header .mat-step-label{padding:16px 0 0 0;text-align:center;width:100%}.mat-vertical-stepper-header{display:flex;align-items:center;height:24px;padding:calc((var(--mat-stepper-header-height) - 24px) / 2) 24px}.mat-vertical-stepper-header .mat-step-icon{margin-right:12px}[dir=rtl] .mat-vertical-stepper-header .mat-step-icon{margin-right:0;margin-left:12px}.mat-horizontal-stepper-wrapper{display:flex;flex-direction:column}.mat-horizontal-stepper-content{outline:0}.mat-horizontal-stepper-content.mat-horizontal-stepper-content-inactive{height:0;overflow:hidden}.mat-horizontal-stepper-content:not(.mat-horizontal-stepper-content-inactive){visibility:inherit !important}.mat-horizontal-content-container{overflow:hidden;padding:0 24px 24px 24px}.cdk-high-contrast-active .mat-horizontal-content-container{outline:solid 1px}.mat-stepper-header-position-bottom .mat-horizontal-content-container{padding:24px 24px 0 24px}.mat-vertical-content-container{margin-left:36px;border:0;position:relative}.cdk-high-contrast-active .mat-vertical-content-container{outline:solid 1px}[dir=rtl] .mat-vertical-content-container{margin-left:0;margin-right:36px}.mat-stepper-vertical-line::before{content:"";position:absolute;left:0;border-left-width:1px;border-left-style:solid;border-left-color:var(--mat-stepper-line-color, var(--mat-app-outline));top:calc(8px - calc((var(--mat-stepper-header-height) - 24px) / 2));bottom:calc(8px - calc((var(--mat-stepper-header-height) - 24px) / 2))}[dir=rtl] .mat-stepper-vertical-line::before{left:auto;right:0}.mat-vertical-stepper-content{overflow:hidden;outline:0}.mat-vertical-stepper-content:not(.mat-vertical-stepper-content-inactive){visibility:inherit !important}.mat-vertical-content{padding:0 24px 24px 24px}.mat-step:last-child .mat-vertical-content-container{border:none}'],encapsulation:2,data:{animation:[fn.horizontalStepTransition,fn.verticalStepTransition]},changeDetection:0});let i=o;return i})(),xn=(()=>{let o=class o{};o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=we({type:o}),o.\u0275inj=Ie({providers:[ko,ze],imports:[Re,Ii,Ai,rn,un,zi,Ct,Xt,Re]});let i=o;return i})()});function cr(i,o){if(i&1&&(l(0,"div",6),y(1,"ks-base-icon",5),p()),i&2){let a=m(2);d("matTooltip",a.getTooltipContent()),c(),d("config",v(2,qo))}}function lr(i,o){if(i&1){let a=A();l(0,"ks-base-button",7),S("onClick",function(){T(a);let t=m(2);return M(t.addPayment())}),p()}i&2&&d("config",z(2,Ko,v(1,Go)))}function pr(i,o){if(i&1){let a=A();l(0,"ks-base-button",7),S("onClick",function(){T(a);let t=m(2);return M(t.delete())}),p()}i&2&&d("config",x(3,Jo,v(1,Yo),v(2,Xo)))}function dr(i,o){if(i&1&&(l(0,"div",0),f(1,cr,2,3,"div",6)(2,lr,1,4,"ks-base-button",5)(3,pr,1,6,"ks-base-button",5),p()),i&2){let a=o,e=m();c(),_(e.isAdmin?1:-1),c(),_(a.price&&e.canAddRevenue&&e.showAddRevenues()?2:-1),c(),_(e.canDeleteReservation&&(a.expenses!=null&&a.expenses.length&&e.canDeleteExpense||!(a.expenses!=null&&a.expenses.length))&&(a.revenues!=null&&a.revenues.length&&e.canDeleteRevenue||!(a.revenues!=null&&a.revenues.length))?3:-1)}}function mr(i,o){if(i&1&&(l(0,"div",4),y(1,"ks-base-input",5),p(),l(2,"div",4),y(3,"ks-base-autocomplete",5),p()),i&2){let a=m();c(),d("config",x(3,er,v(2,Zo),a.form.controls.bookedDate)),c(2),d("config",et(12,nr,v(6,ei),v(7,tr),a.form.controls.bungalowId,x(9,ti,a.bungalows$,v(8,ir))))}}function ur(i,o){if(i&1&&(l(0,"div",4),y(1,"ks-base-input",5),p()),i&2){let a=m();c(),d("config",x(2,rr,v(1,or),a.form.controls.addPayment))}}function hr(i,o){if(i&1&&y(0,"ks-base-input",5),i&2){let a=m(2);d("config",x(2,sr,v(1,ar),a.RevenuesControl))}}function fr(i,o){i&1&&(l(0,"div",8)(1,"div",9),b(2,"Fully Payed"),p()())}function _r(i,o){if(i&1&&(l(0,"div",4),f(1,hr,1,5,"ks-base-input",5)(2,fr,3,0,"div",8),p()),i&2){let a,e=m();c(),_(e.minimumPrice<(((a=e.reservation())==null?null:a.price)||0)?1:2)}}var ei,$o,Cn,ti,Lo,zo,Vo,jo,Bo,Ho,Uo,Qo,Wo,qo,Go,Ko,Yo,Xo,Jo,Zo,er,tr,ir,nr,or,rr,ar,sr,It,ii=W(()=>{"use strict";C();Be();je();Ve();Me();J();ht();_t();Wt();Ue();ft();qt();C();je();Ve();ei=()=>[],$o=()=>({text:"Customer Name"}),Cn=()=>({valueKey:"value",nameKey:"name"}),ti=(i,o)=>({stream:i,transformer:o}),Lo=(i,o,a,e,t)=>({options:i,flexibleValue:!0,readonly:o,label:a,control:e,stream:t}),zo=()=>({text:"Customer information"}),Vo=(i,o,a)=>({label:i,readonly:o,control:a}),jo=()=>({text:"Amount in $"}),Bo=(i,o,a)=>({label:i,type:"number",readonly:o,control:a}),Ho=()=>({text:"Notes"}),Uo=(i,o,a)=>({label:i,readonly:o,type:"text",control:a}),Qo=()=>({text:"Source"}),Wo=(i,o,a,e,t)=>({options:i,flexibleValue:!0,label:o,control:a,readonly:e,stream:t}),qo=()=>({icon:"icon_information_in_circle"}),Go=()=>({text:"Add Payment"}),Ko=i=>({label:i,matType:"mat-stroked-button"}),Yo=()=>({text:"Delete"}),Xo=()=>({icon:"icon_delete"}),Jo=(i,o)=>({label:i,matType:"mat-icon-button",color:"warn",prefixIcon:o}),Zo=()=>({text:"Date"}),er=(i,o)=>({label:i,type:"date",readonly:!0,control:o}),tr=()=>({text:"Bungalow"}),ir=()=>({valueKey:"_id",nameKey:"name"}),nr=(i,o,a,e)=>({options:i,readonly:!0,label:o,control:a,stream:e}),or=()=>({text:"Payed Amount in $"}),rr=(i,o)=>({label:i,type:"number",control:o}),ar=()=>({text:"Amount Received"}),sr=(i,o)=>({label:i,type:"number",readonly:!0,control:o});It=(()=>{let o=class o{constructor(){this._cdr=u(ee),this._destroyRef=u(re),this._dialog=u(lt),this._sharedService=u(me),this._sessionService=u(pe),this._bungalowsService=u(Ae),this._reservationService=u(ue),this.date=se.required(),this.hideDate=se(!1),this.bungalowId=se.required(),this.reservation=se(),this.callSave$=se.required(),this.sources$=this._reservationService.source$,this.bungalows$=this._bungalowsService.bungalow$,this.customersNames$=this._reservationService.customersLov$,this.emitFormDate=hi(),this.form=new Te({bungalowId:new O("",[w.required]),bookedDate:new O(new Date,[w.required]),price:new O(null,[w.required]),addPayment:new O(null),notes:new O("",w.maxLength(200)),source:new O("",w.maxLength(30)),person:new Te({name:new O("",[w.required,w.minLength(3),w.maxLength(40)]),contact:new O("",[w.required,w.minLength(3),w.maxLength(40)])})}),this.RevenuesControl=new O(0),this.isAdmin=this._sessionService.checkAccess(D.ADMIN),this.canAddExpense=this._sessionService.checkAccess(D.ADD_EXPENSE),this.canAddRevenue=this._sessionService.checkAccess(D.ADD_REVENUE),this.canDeleteExpense=this._sessionService.checkAccess(D.DELETE_EXPENSE),this.canDeleteRevenue=this._sessionService.checkAccess(D.DELETE_REVENUE),this.canEditReservation=this._sessionService.checkAccess(D.EDIT_RESERVATION),this.canDeleteReservation=this._sessionService.checkAccess(D.DELETE_RESERVATION),this.showAddRevenues=G(!1),this.minimumPrice=0}ngOnInit(){let e=this.reservation();this.form.controls.bungalowId.setValue(this.bungalowId()),this.form.controls.bookedDate.setValue(this._sharedService.getUtcDate(this.date())),e?(this._editForm(e),e.revenues?.forEach(t=>{this.minimumPrice=this.minimumPrice+t.amount}),this.RevenuesControl.setValue(this.minimumPrice),this.form.controls.price.addValidators([w.required,w.min(this.minimumPrice)]),e.price>this.minimumPrice&&this.showAddRevenues.set(!0)):this.form.controls.price.valueChanges.pipe(H(this._destroyRef)).subscribe(t=>{this.form.controls.addPayment.setValidators([w.max(Number(t))]),this.form.controls.addPayment.updateValueAndValidity()}),this._reservationService.refresh$.pipe(H(this._destroyRef)).subscribe(()=>{let t=this.reservation();t&&(this.minimumPrice=0,t.revenues?.forEach(n=>{this.minimumPrice=this.minimumPrice+n.amount}),this.RevenuesControl.setValue(this.minimumPrice),t.price<=this.minimumPrice&&this.showAddRevenues.set(!1)),this._cdr.markForCheck()}),this.callSave$().pipe(H(this._destroyRef)).subscribe(()=>{this.save()})}save(){this._submit()}getTooltipContent(){let e=this.reservation();if(e){let t="";return e.createdAt!==e.updatedAt&&e.updatedBy?t=`Created by ${e.createdBy} at ${ct.formatDate(new Date(e.createdAt),"dddd dd MMMM yyyy - HH:mm:ss a")}
Updated by ${e.updatedBy} at ${ct.formatDate(new Date(e.updatedAt),"dddd dd MMMM yyyy - HH:mm:ss a")}`:t=`Created by ${e.createdBy} at ${ct.formatDate(new Date(e.createdAt),"dddd dd MMMM yyyy - HH:mm:ss a")}`,t}return""}addPayment(){let e=this.reservation(),t=e?.price||0;e?.revenues?.forEach(r=>t=t-r.amount);let n={hideClearButton:!0,title:{text:"Add Payment"},form:{fields:[{name:"amount",label:{text:"Amount in $"},type:"number",range:{max:t},required:!0},{name:"notes",label:{text:"Notes"},type:"text",maxLength:100}]}};this._dialog.openFormPopup(n,"400px").afterClosed().pipe(R(1)).subscribe(r=>{r&&e&&this._reservationService.addRevenue(e,r.name,r.amount,e.bookedDate,r.notes)})}delete(){let e=this.reservation();if(e)if(e.expenses?.length||e.revenues?.length){let t={hideClearButton:!0,title:{text:"Delete Reservation"},saveButton:{label:{text:"Confirm Deletion"},color:"warn",matType:"mat-flat-button"},form:{fields:[{name:"expenses",label:{text:"Also Delete This Reservation Expenses"},type:"toggle",hide:!e.expenses?.length},{name:"revenues",label:{text:"Also Delete This Reservation Payments"},type:"toggle",hide:!e.revenues?.length}]}};this._dialog.openFormPopup(t,"400px").afterClosed().pipe(R(1)).subscribe(n=>{n&&e&&(this._reservationService.deleteReservation(e,n),this._dialog.closeAll())})}else this._dialog.openConfirmPopup({title:{text:"Delete Reservation"},message:{text:"Are you sure you want to delete this reservation?"}}).afterClosed().pipe(R(1)).subscribe(t=>{t&&e&&(this._reservationService.deleteReservation(e,{}),this._dialog.closeAll())})}_closeDialog(e){this.emitFormDate.emit({data:e,addPayment:this.form.controls.addPayment.value})}_submit(){He(this.form)&&this._closeDialog(this._format(this.form.value))}_editForm(e){this.form.patchValue(e)}_format(e){let t=this._sharedService.getUtcDate(this.date()),n=this.reservation(),r=n?V({},n):{bookedDate:`${t.getFullYear()}-${(t.getMonth()+1).toString().padStart(2,"0")}-${t.getDate().toString().padStart(2,"0")}`,bungalowId:this.bungalowId()};return r.notes=e.notes||"",r.source=e.source||"",r.person={contact:e.person?.contact,name:e.person?.name},r.price=Number(this.form.value.price),r}};o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=F({type:o,selectors:[["ks-solutions-reservation"]],inputs:{date:[1,"date"],hideDate:[1,"hideDate"],bungalowId:[1,"bungalowId"],reservation:[1,"reservation"],callSave$:[1,"callSave$"]},outputs:{emitFormDate:"emitFormDate"},standalone:!0,features:[k],decls:17,vars:49,consts:[[1,"d-flex","align-items-center","justify-content-center","gap-3"],[1,"px-2",3,"ngSubmit","formGroup"],[1,"container-fluid","text-start"],[1,"row","mt-3"],[1,"col-12","col-lg-6"],[3,"config"],["dir-tooltip","",3,"matTooltip"],[3,"onClick","config"],[1,"pb-3","w-100"],[1,"text-bg-primary","cs-c","w-100","mx-auto"]],template:function(t,n){if(t&1&&(f(0,dr,4,3,"div",0),l(1,"form",1),S("ngSubmit",function(){return n.save()}),l(2,"div",2)(3,"div",3),f(4,mr,4,17),l(5,"div",4),y(6,"ks-base-autocomplete",5),p(),l(7,"div",4),y(8,"ks-base-input",5),p(),l(9,"div",4),y(10,"ks-base-input",5),p(),f(11,ur,2,5,"div",4),l(12,"div",4),y(13,"ks-base-input",5),p(),l(14,"div",4),y(15,"ks-base-autocomplete",5),p(),f(16,_r,3,1,"div",4),p()()()),t&2){let r,s;_((r=n.reservation())?0:-1,r),c(),d("formGroup",n.form),c(3),_(n.hideDate()?-1:4),c(2),d("config",Pt(16,Lo,v(10,ei),!n.canEditReservation,v(11,$o),n.form.controls.person.controls.name,x(13,ti,n.customersNames$,v(12,Cn)))),c(2),d("config",Ze(23,Vo,v(22,zo),!n.canEditReservation,n.form.controls.person.controls.contact)),c(2),d("config",Ze(28,Bo,v(27,jo),!n.canEditReservation,n.form.controls.price)),c(),_(n.reservation()?-1:11),c(2),d("config",Ze(33,Uo,v(32,Ho),!n.canEditReservation,n.form.controls.notes)),c(2),d("config",Pt(43,Wo,v(37,ei),v(38,Qo),n.form.controls.source,!n.canEditReservation,x(40,ti,n.sources$,v(39,Cn)))),c(),_(n.reservation()&&(n.minimumPrice||!n.minimumPrice&&!((s=n.reservation())!=null&&s.price))?16:-1)}},dependencies:[st,rt,ot,at,nt,Fe,vt,dt,Gi,mt,pt],styles:[".cs-c[_ngcontent-%COMP%]{width:100px;height:53px;display:flex;align-items:center;justify-content:center;padding:4px;margin-left:4px;border-radius:4px;margin-top:8px}"],changeDetection:0});let i=o;return i})()});function wr(i,o){i&1&&b(0,"Choose Bungalow")}function Dr(i,o){i&1&&b(0,"Choose Dates")}function Er(i,o){if(i&1&&y(0,"ks-base-input",1)(1,"ks-base-input",1),i&2){let a=m();d("config",x(3,Dt,v(2,wt),a.dateForm.controls.start)),c(),d("config",x(7,Dt,v(6,wt),a.dateForm.controls.end))}}function Rr(i,o){if(i&1&&y(0,"ks-base-input",1)(1,"ks-base-input",1),i&2){let a=m();d("config",x(3,Dt,v(2,wt),a.dateForm.controls.start)),c(),d("config",x(7,Dt,v(6,wt),a.dateForm.controls.end))}}function Fr(i,o){i&1&&b(0,"Confirm Dates")}function Tr(i,o){i&1&&(l(0,"span"),b(1,"No Available Days !"),p())}function Mr(i,o){if(i&1){let a=A();l(0,"ks-base-button",13),S("onClick",function(){let t=T(a).$implicit,n=m();return M(n.removeDate(t))}),p()}if(i&2){let a=o.$implicit,e=m();d("config",x(4,Cr,z(1,In,e.formatDisplayDate(a)),v(3,xr)))}}function kr(i,o){if(i&1&&y(0,"ks-base-button",1),i&2){let a=o.$implicit,e=m(2);d("config",z(3,Ir,z(1,In,e.formatDisplayDate(a))))}}function Ar(i,o){if(i&1&&(l(0,"div",11)(1,"div",8)(2,"div",9),b(3,"Unavailable Days"),p(),l(4,"div",10),$(5,kr,1,5,"ks-base-button",1,Z),p()()()),i&2){let a=m();c(5),L(a.unavailableDates)}}function Pr(i,o){i&1&&b(0,"Reservation Information")}var vr,gr,br,yr,Sr,wt,Dt,In,xr,Cr,Ir,wn,Dn=W(()=>{"use strict";C();Be();je();ji();Zt();Me();J();_t();Wt();Ue();ii();C();Zt();je();vr=()=>({text:"Bungalow"}),gr=()=>[],br=()=>({nameKey:"name",valueKey:"_id"}),yr=(i,o)=>({stream:i,transformer:o}),Sr=(i,o,a,e)=>({label:i,options:o,stream:a,control:e}),wt=()=>({text:"Date Range"}),Dt=(i,o)=>({label:i,type:"date",control:o}),In=i=>({text:i}),xr=()=>({icon:"icon_delete"}),Cr=(i,o)=>({label:i,color:"primary",matType:"mat-flat-button",suffixIcon:o}),Ir=i=>({label:i,color:"warn",matType:"mat-flat-button"});wn=(()=>{let o=class o{constructor(){this._sharedService=u(me),this._bungalowService=u(Ae),this._snackbarService=u(Wi),this._reservationService=u(ue),this._dialogRef=u(it),this.cardConfig={header:{title:{text:"Multiple Reservations",tag:"h3",fontWeight:"700"},position:"center",suffixButton:{label:{text:"Close"},matType:"mat-icon-button",prefixIcon:{icon:"icon_x_circle"},onClick:()=>this._dialogRef.close()}},content:{addClass:"card"},footer:{position:"center",buttons:[{label:{text:"Save"},matType:"mat-flat-button",prefixIcon:{icon:"icon_save"},onClick:()=>this._submit()}]}},this.mockDate=new Date,this.reset=G(!1),this.bungalowForm=new Te({id:new O("",[w.required])}),this.dateForm=new Te({start:new O(null,[w.required]),end:new O(null,[w.required])}),this.dates=[],this.unavailableDates=[],this.bungalow$=this._bungalowService.bungalow$.pipe(E(e=>e.filter(t=>t.active))),this.save$=new N,this.reservations=[],this._destroyRef=u(re)}ngOnInit(){this._reservationService.reservations$.pipe(H(this._destroyRef)).subscribe(e=>this.reservations=e),this.bungalowForm.valueChanges.pipe(H(this._destroyRef)).subscribe(()=>{this.dateForm.reset(),this.reset.update(e=>!e),this.dates=[],this.unavailableDates=[]}),this.dateForm.valueChanges.pipe(H(this._destroyRef)).subscribe(e=>{if(this.dateForm.valid&&e.start&&e.end){this.dates=[],this.unavailableDates=[];let t=this._sharedService.getUtcDate(e.start),n=this._sharedService.getUtcDate(e.end);for(let r=this._sharedService.getUtcDate(t);r<=n;r.setDate(r.getDate()+1)){let s=this._sharedService.getUtcDate(new Date(r));this.reservations.find(I=>I.bungalowId===this.bungalowForm.value.id&&this._sharedService.getUtcDate(I.bookedDate).getTime()===s.getTime())?this.unavailableDates.push(this._formatDate(s)):this.dates.push(this._formatDate(s))}}else this.dates=[],this.unavailableDates=[]})}successSave(e){this.dates.length?this._dialogRef.close({dates:this.dates.map(t=>this._sharedService.getUtcDate(t)),reservation:Q(V({},e.data),{bungalowId:this.bungalowForm.value.id,addPayment:e.addPayment})}):this.dates.length||this._snackbarService.open({text:"No available dates!"},"error")}removeDate(e){let t=this.dates.indexOf(e);t!==-1&&this.dates.splice(t,1)}formatDisplayDate(e){let t=e.split("-");return`${t[2]}/${t[1]}/${t[0]}`}_submit(){He(this.bungalowForm)&&He(this.dateForm)&&this.save$.next()}_formatDate(e){let t=new Date(e);if(isNaN(t.getTime()))return"Invalid Date";let n=t.getDate().toString().padStart(2,"0"),r=(t.getMonth()+1).toString().padStart(2,"0");return`${t.getFullYear()}-${r}-${n}`}};o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=F({type:o,selectors:[["app-multiple-reservation-popup"]],standalone:!0,features:[k],decls:28,vars:25,consts:[["stepper",""],[3,"config"],["orientation","vertical",3,"linear"],[3,"stepControl"],[3,"formGroup"],["matStepLabel",""],[1,"mt-2"],[1,"container","mt-1"],[1,"row"],[1,"col-12","text-center","h3"],[1,"col-12","d-flex","align-items-center","justify-content-center","flex-wrap","gap-2"],[1,"container","mt-4"],[3,"emitFormDate","bungalowId","hideDate","callSave$","date"],[3,"onClick","config"]],template:function(t,n){if(t&1){let r=A();l(0,"ks-base-card",1)(1,"mat-stepper",2,0)(3,"mat-step",3)(4,"form",4),f(5,wr,1,0,"ng-template",5),l(6,"div",6),y(7,"ks-base-select",1),p()()(),l(8,"mat-step",3)(9,"form",4),f(10,Dr,1,0,"ng-template",5),l(11,"div",6),f(12,Er,2,10)(13,Rr,2,10),p()()(),l(14,"mat-step"),f(15,Fr,1,0,"ng-template",5),l(16,"div",7)(17,"div",8)(18,"div",9),b(19,"Available Days"),p(),l(20,"div",10),f(21,Tr,2,0,"span"),$(22,Mr,1,7,"ks-base-button",1,Z),p()()(),f(24,Ar,7,0,"div",11),p(),l(25,"mat-step"),f(26,Pr,1,0,"ng-template",5),l(27,"ks-solutions-reservation",12),S("emitFormDate",function(h){return T(r),M(n.successSave(h))}),p()()()()}t&2&&(d("config",n.cardConfig),c(),d("linear",!0),c(2),d("stepControl",n.bungalowForm),c(),d("formGroup",n.bungalowForm),c(3),d("config",et(20,Sr,v(14,vr),v(15,gr),x(17,yr,n.bungalow$,v(16,br)),n.bungalowForm.controls.id)),c(),d("stepControl",n.dateForm),c(),d("formGroup",n.dateForm),c(3),_(n.reset()?12:13),c(9),_(n.dates.length?-1:21),c(),L(n.dates),c(2),_(n.unavailableDates&&n.unavailableDates.length?24:-1),c(3),d("bungalowId","12345")("hideDate",!0)("callSave$",n.save$)("date",n.mockDate))},dependencies:[ut,qi,dt,mt,xn,Jt,We,Ct,st,rt,ot,at,It],changeDetection:0});let i=o;return i})()});function Nr(i,o){if(i&1){let a=A();l(0,"ks-solutions-reservation",3),S("emitFormDate",function(t){T(a);let n=m();return M(n.successSave(t))}),p()}if(i&2){let a=m();d("bungalowId",a.data.bungalowId)("callSave$",a.save$)("date",a.data.date)("reservation",a.data.reservation)}}var Or,En,Rn=W(()=>{"use strict";C();ji();Me();J();ht();ft();ii();C();Or=i=>({loading:i});En=(()=>{let o=class o{constructor(){this._loaderService=u(Ui),this._sessionService=u(pe),this._dialogRef=u(it),this._canAdd=this._sessionService.checkAccess(D.EDIT_RESERVATION),this._canEdit=this._sessionService.checkAccess(D.EDIT_RESERVATION),this.data=u(Vi),this.save$=new N,this.loading=this._loaderService.isLoading,this.cardConfig={header:{title:{text:this.data.reservation?this._canEdit?"Edit Reservation":"Reservation":this._canAdd?"Add Reservation":"Reservation",tag:"h3",fontWeight:"700"},position:"center",suffixButton:{label:{text:"Close"},matType:"mat-icon-button",prefixIcon:{icon:"icon_x_circle"},onClick:()=>this._closeDialog()}},content:{addClass:"card"},footer:{position:"center",buttons:[this._canEdit&&this.data.reservation||this._canAdd&&!this.data.reservation?{label:{text:"Save"},matType:"mat-flat-button",prefixIcon:{icon:"icon_save"},onClick:()=>{this.save$.next()}}:{label:{text:"Close"},matType:"mat-flat-button",onClick:()=>{this._dialogRef.close()}}]}}}successSave(e){this._closeDialog(e.data,e.addPayment)}_closeDialog(e,t){this._dialogRef.close(e?Q(V({},e),{addPayment:t}):void 0)}};o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=F({type:o,selectors:[["ks-solutions-reservation-popup"]],standalone:!0,features:[k],decls:4,vars:5,consts:[[3,"config"],[1,"py-3"],[3,"bungalowId","callSave$","date","reservation"],[3,"emitFormDate","bungalowId","callSave$","date","reservation"]],template:function(t,n){t&1&&(l(0,"ks-base-card",0)(1,"div",1),f(2,Nr,1,4,"ks-solutions-reservation",2),p()(),y(3,"ks-loader-overlay",0)),t&2&&(d("config",n.cardConfig),c(2),_(n.data&&n.data.bungalowId?2:-1),c(),d("config",z(3,Or,n.loading)))},dependencies:[ut,Ki,It],styles:[".cs-c[_ngcontent-%COMP%]{width:100px;height:30px;display:flex;align-items:center;justify-content:center;padding:4px;margin-left:4px;border-radius:4px;margin-top:17px}"],changeDetection:0});let i=o;return i})()});function Lr(i,o){if(i&1&&(l(0,"div",4)(1,"div",5),b(2,"Reserved"),p(),l(3,"div",6),b(4,"Deposit"),p(),l(5,"div",7),b(6,"Payed"),p()()),i&2){let a=m();P("justify-content-end",a.innerWidth>700)("justify-content-center",a.innerWidth<=700)}}function zr(i,o){if(i&1){let a=A();l(0,"div",9)(1,"reservations-calendar",10),S("dateOutput",function(t){T(a);let n=m(2);return M(n.openReservation(t))}),p()()}if(i&2){let a=o.$implicit;c(),d("bungalow",a)}}function Vr(i,o){if(i&1&&(l(0,"div",2)(1,"div",8),$(2,zr,2,1,"div",9,Z),gi(4,"async"),p()()),i&2){let a=m();c(2),L(bi(4,0,a.bungalows))}}function jr(i,o){if(i&1){let a=A();l(0,"ks-basic-grid",11),S("selectionChange",function(t){T(a);let n=m();return M(n.selectionChanges(t))}),p()}if(i&2){let a=m();d("config",a.gridConfig)("refresh$",a.refresh$)}}var $r,Ac,Br=W(()=>{$t();C();Be();Me();J();on();Dn();Rn();On();$n();Pn();ht();_t();Wt();zn();Ue();ft();C();$r=i=>({date:i,format:"MMMM yyyy"});Ac=(()=>{let o=class o{constructor(){this._destroyRef=u(re),this._dialog=u(lt),this._navService=u(Ji),this._configService=u(en),this._sharedService=u(me),this._sessionService=u(pe),this._expensesService=u(tn),this._bungalowService=u(Ae),this._reservationService=u(ue),this._selectedReservations=G([]),this._isAdmin=this._sessionService.checkAccess(D.ADMIN),this._showGridBtns=xi(()=>!!this._selectedReservations().length),this._canAdd=this._sessionService.checkAccess(D.ADD_RESERVATION),this._canEdit=this._sessionService.checkAccess(D.EDIT_RESERVATION),this._canDelete=this._sessionService.checkAccess(D.DELETE_RESERVATION),this.innerWidth=window.innerWidth,this.date=this._reservationService.date,this.view=G("calendar"),this.refresh$=new N,this.bungalows=this._bungalowService.bungalow$.pipe(E(e=>e.filter(t=>t.active)))}ngOnInit(){this._navService.updateNav({show:!0,back:!1,title:Zi.LAYOUT.children.RESERVATIONS.name,buttons:[{label:{text:"Change Month"},prefixIcon:{icon:"icon_calendar"},onClick:()=>this._openSearchByDate()},{label:{text:"Add Multiple"},prefixIcon:{icon:"icon_plus_circle"},hide:!this._canAdd,onClick:()=>this._addMultipleReservations()}]}),this._initializeGrid(),this._reservationService.date.set(new Date),this._reservationService.getReservations(),this._expensesService.getExpenses()}ngAfterViewInit(){this._reservationService.filteredReservations$.pipe(H(this._destroyRef)).subscribe(e=>{this.refresh$.next({data:e})})}changeDate(e){this._reservationService.changeDate(e)}selectionChanges(e){this._selectedReservations.set(e)}openReservation(e){!this._canAdd&&!e.reservation||this._dialog.open(En,{width:"95vw",maxWidth:"800px",maxHeight:"95vh",disableClose:!0,autoFocus:!1,restoreFocus:!0,data:e}).afterClosed().pipe(R(1)).subscribe(t=>{t&&(e.reservation?this._reservationService.updateReservation(t):this._reservationService.addReservation(t))})}_openSearchByDate(){this._sharedService.openSearchByDate().pipe(R(1)).subscribe(e=>e&&this._reservationService.changeDate(e))}_addMultipleReservations(){this._dialog.open(wn,{width:"95vw",maxWidth:"800px",maxHeight:"95vh",disableClose:!0,autoFocus:!1,restoreFocus:!1}).afterClosed().pipe(R(1)).subscribe(e=>{e&&e.dates&&Array.isArray(e.dates)&&e.dates.length&&e.reservation&&this._reservationService.addMultipleReservation(e.dates,e.reservation)})}_initializeGrid(){this.gridConfig={data:G([]),defaultPagination:100,maxTableHeight:this._configService.appConfig.maxTableHeightWithSearchAndChanger,noDataMessage:{text:"No Expenses Found"},multiSelect:!0,features:{showSearch:!0,buttons:[{label:{text:"Fully Pay "},matType:"mat-stroked-button",show:this._showGridBtns},{label:{text:"Delete "},matType:"mat-stroked-button",color:"warn",show:this._showGridBtns}]},columns:[{field:"done",title:"Status",type:"chip",extraStyles:{"max-width":"90px",width:"90px","min-width":"90px"},staticChip:e=>e.done?"Payed":e.deposit?"Deposit":"Reserved",setChipClass:e=>e.done?"rounded rounded-2 px-2 py-1 text-bg-primary":e.deposit?"rounded rounded-2 px-2 py-1 text-bg-danger":"rounded rounded-2 px-2 py-1 text-bg-success"},{field:"person.name",title:"Customer Name",type:"string",extraStyles:{"min-width":"170px"}},{field:"price",title:"Amount",type:"number",extraStyles:{"min-width":"70px","max-width":"70px",width:"70px"}},{field:"amountPayed",title:"Payed Amount",type:"number",extraStyles:{"min-width":"120px","max-width":"120px",width:"120px"}},{field:"source",title:"Source",type:"string",extraStyles:{"min-width":"120px"}},{field:"bookedDate",title:"Date",type:"date",dateFormat:"dd/MM/yyyy",extraStyles:{"min-width":"110px","max-width":"110px",width:"110px"}}],actionsColumn:Q(V({},this._configService.getActionColumn(2)),{enabled:this._canEdit||this._canDelete,buttons:[{prefixIcon:{icon:"icon_edit"},label:{text:"Edit"},onClickFn:e=>this.openReservation({bungalowId:e.bungalowId,date:new Date(e.bookedDate),reservation:e}),matType:"mat-icon-button",isVisibleFn:()=>this._canEdit},{prefixIcon:{icon:"icon_delete"},color:"warn",label:{text:"Delete"},matType:"mat-icon-button",isVisibleFn:()=>this._canDelete}]})}}};o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=F({type:o,selectors:[["ks-solutions-reservations"]],standalone:!0,features:[k],decls:5,vars:8,consts:[[1,"d-flex","align-items-center",3,"justify-content-end","justify-content-center"],[3,"btnClicked","config"],[1,"container-fluid","px-0"],[3,"config","refresh$"],[1,"d-flex","align-items-center"],[1,"text-bg-success","cs-c"],[1,"text-bg-danger","cs-c"],[1,"text-bg-primary","cs-c"],[1,"row"],[1,"col-12","col-lg-6","mb-4","mb-lg-0"],[3,"dateOutput","bungalow"],[3,"selectionChange","config","refresh$"]],template:function(t,n){t&1&&(f(0,Lr,7,4,"div",0),l(1,"ks-base-changer",1),S("btnClicked",function(s){return n.changeDate(s)}),p(),f(2,Vr,5,2,"div",2),l(3,"div"),f(4,jr,1,2,"ks-basic-grid",3),p()),t&2&&(_(n.view()==="calendar"?0:-1),c(),d("config",z(6,$r,n.date)),c(),_(n.view()==="calendar"?2:-1),c(),_i("display",n.view()==="grid"?"block":"none"),c(),_(n.gridConfig?4:-1))},dependencies:[Xi,nn,Ci,Yi],styles:[".cs-c[_ngcontent-%COMP%]{width:80px;display:flex;align-items:center;justify-content:center;padding:4px;margin-left:4px;border-radius:4px}[_nghost-%COMP%]     .cdk-header-cell input{display:none}"],changeDetection:0});let i=o;return i})()});Br();export{Ac as ReservationsComponent};
