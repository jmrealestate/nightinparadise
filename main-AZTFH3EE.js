import{a as $}from"./chunk-6GWNQVDS.js";import{a as u}from"./chunk-US4DBW3U.js";import{a as f}from"./chunk-IXDNPNBC.js";import{a as A}from"./chunk-IA4DM2LR.js";import{a as Z}from"./chunk-JU5LHE6N.js";import{a as t}from"./chunk-TRRKCROW.js";import{P as F,b as x,d as D,e as w,f as G,fa as S,h as H,ha as z,i as V,j as B,ja as m,k as K,ka as v,m as W,n as d,o as j,wa as X}from"./chunk-XVDAFDV3.js";import{$ as L,Cb as P,Db as U,H as N,I as C,L as O,Nb as T,Ob as b,P as I,Pb as _,fb as R,ia as i,ma as k,pc as Y,qb as y,rc as M,u as h}from"./chunk-PV357URW.js";var ie=e=>({loading:e,disableInteractions:!0}),J=(()=>{let n=class n{constructor(){this._router=i(d),this._navService=i(Z),this.loadingRouteSig=y(!1),this._keyBlocked=!1}ngOnInit(){this._navService.getThemeOnLoad(),document.addEventListener("keydown",r=>{if(["Enter"," "].includes(r.key)){if(this._keyBlocked){r.preventDefault(),r.stopPropagation();return}this._keyBlocked=!0,setTimeout(()=>{this._keyBlocked=!1},400)}}),this._router.events.subscribe(r=>{r instanceof H?(this.loadingRouteSig.set(!0),window.scrollTo(0,0)):(r instanceof V||r instanceof K||r instanceof B)&&this.loadingRouteSig.set(!1)})}};n.\u0275fac=function(o){return new(o||n)},n.\u0275cmp=k({type:n,selectors:[["app-root"]],standalone:!0,features:[Y],decls:4,vars:5,consts:[[1,"app-container"],[3,"config"],[1,"global-router-container"]],template:function(o,a){o&1&&(T(0,"div",0),_(1,"ks-loader-overlay",1),T(2,"div",2),_(3,"router-outlet"),b()()),o&2&&(R(),P("config",M(3,ie,a.loadingRouteSig)),R(),U("display",a.loadingRouteSig()?"none":"block"))},dependencies:[W,X],styles:[".app-container[_ngcontent-%COMP%], .app-container[_ngcontent-%COMP%]   .global-router-container[_ngcontent-%COMP%]{min-height:100dvh}"],changeDetection:0});let e=n;return e})();var p=e=>{let n=i(d),r=i(m).getItem(f.SS.user,!0);if(!r)return n.navigate([t.LOGIN.route]),!1;if(!e.data)return!0;let o=e.data.roles;if(!o||!Array.isArray(o)||o.length===0)return!0;let a=o.some(l=>r.admin||r.permissions[l]);return!a&&n.navigate([t.NOT_AUTHORIZED.route]),a};var Q=()=>{let e=i(d),c=i(m).getItem(f.SS.user,!0);return console.log(c),c?(e.navigate([t.LAYOUT.route]),!1):!0};var ae=[{path:"",redirectTo:t.LAYOUT.children.RESERVATIONS.endpoint,pathMatch:"full"},{path:t.LAYOUT.children.CUSTOMERS.endpoint,loadComponent:()=>import("./chunk-W4CBEAH5.js").then(e=>e.CustomersComponent),canActivate:[p]},{path:t.LAYOUT.children.RESERVATIONS.endpoint,loadComponent:()=>import("./chunk-LHP7K5UQ.js").then(e=>e.ReservationsComponent),canActivate:[p]},{path:t.LAYOUT.children.BUNGALOWS.endpoint,loadComponent:()=>import("./chunk-HH4ADXGV.js").then(e=>e.BungalowsComponent),canActivate:[p],data:{roles:[u.VIEW_BUNGALOW]}},{path:t.LAYOUT.children.REVIEWS.endpoint,loadComponent:()=>import("./chunk-42VCVNPJ.js").then(e=>e.ReviewsComponent),canActivate:[p],data:{roles:[u.VIEW_REVIEWS]}},{path:t.LAYOUT.children.REVENUES.endpoint,loadComponent:()=>import("./chunk-DT7DOHE2.js").then(e=>e.RevenuesComponent),canActivate:[p],data:{roles:[u.VIEW_REVENUE]}},{path:t.LAYOUT.children.EXPENSES.endpoint,loadComponent:()=>import("./chunk-EZOOIIHD.js").then(e=>e.ExpensesComponent),canActivate:[p],data:{roles:[u.VIEW_EXPENSE]}},{path:t.LAYOUT.children.USER_MANAGEMENT.endpoint,loadComponent:()=>import("./chunk-MK3ISH5J.js").then(e=>e.UsersComponent),canActivate:[p],data:{roles:[u.VIEW_USER]}},{path:t.LAYOUT.children.REPORTS.endpoint,loadComponent:()=>import("./chunk-LUZ2MGOD.js").then(e=>e.ReportsComponent),canActivate:[p],data:{roles:[u.VIEW_REPORTS]},children:[{path:"",pathMatch:"full",redirectTo:t.LAYOUT.children.REPORTS.children.YEARLY.endpoint},{path:t.LAYOUT.children.REPORTS.children.YEARLY.endpoint,loadComponent:()=>import("./chunk-4QTVON6V.js").then(e=>e.ReportByYearComponent)}]}],q=[{path:"",redirectTo:t.HOME.endpoint,pathMatch:"full"},{path:t.HOME.endpoint,loadComponent:()=>import("./chunk-6EFE2KK7.js").then(e=>e.MainPageComponent)},{path:t.LAYOUT.endpoint,loadComponent:()=>import("./chunk-LNOP7CI4.js").then(e=>e.LayoutComponent),children:ae,canActivate:[p]},{path:t.LOGIN.endpoint,loadComponent:()=>import("./chunk-CGYWCFEW.js").then(e=>e.LoginComponent),canActivate:[Q]},{path:t.NOT_AUTHORIZED.endpoint,loadComponent:()=>import("./chunk-GRC6YYJB.js").then(e=>e.NotAuthorizedComponent)},{path:t.PAGE_NOT_FOUND.endpoint,loadComponent:()=>import("./chunk-XA4A3J5I.js").then(e=>e.PageNotFoundComponent)},{path:"**",redirectTo:t.PAGE_NOT_FOUND.endpoint,pathMatch:"full"}];var E={production:!1,API_HOST:A.API_HOST.production};function g(e,n){return e.clone({setHeaders:{Authorization:"Bearer "+n.getItem(f.SS.token,!0)},withCredentials:!0})}var ee=(e,n)=>{let c=i(v),r=i(S),o=i($),a=i(m),l;return n(e).pipe(I(()=>{if(l){let s=l;s.showMessage&&s.message&&(s.isDialog?r.openConfirmPopup({title:{text:s.title??"Error",translate:!1},message:{text:s.message,translate:!1},hideYesNo:!0}):c.open({text:s.message,translate:!1},s.state??"error",{duration:s.snackbarDuration}))}}),N(s=>(l=s.error,s.status===401?e.url===E.API_HOST+A.AUTHENTICATION.refresh?(o.logOut(!0),h(()=>s)):o.isRefreshTokenCalled!==!0?(o.isRefreshTokenCalled=!0,o.callRefreshToken().pipe(O(1),C(ne=>(o.successfulRefreshToken(ne),n(g(e,a)))))):o.refreshToken$.pipe(O(1),C(()=>n(g(e,a)))):s.status===403?(o.isLogoutCalled||(r.closeAll(),r.openConfirmPopup({message:{text:"You don't have permission to access this resource."},title:{text:"Error"},hideYesNo:!0})),o.logOut(!0),h(()=>s)):s.status===0?(r.openConfirmPopup({message:[{tag:"span",text:"Please check your internet connection and ensure it is stable.",addClass:"fw-bold"},{tag:"span",text:"If the issue persists, please contact your administrator for further assistance."}],title:{text:"Something went wrong"},hideYesNo:!0}),h(()=>s)):h(()=>s))))};var te=(e,n)=>{let c=i(v),r=i(S);return n(e).pipe(L(o=>{if(o instanceof x&&o.body){let a=o.body;if(a.showMessage&&a.message)if(a.isDialog){let l={title:{text:a.title??"Message",translate:!1},message:{text:a.message,translate:!1},hideYesNo:!0};r.openConfirmPopup(l)}else c.open({text:a.message,translate:!1},a.state??"success",{duration:a.snackbarDuration})}}))};var oe=(e,n)=>{let c=i(m);return n(g(e,c))};var re={providers:[j(q),F(),D(w([oe,ee,te])),z({iconSize:"md",baseNetworkServiceUrl:E.API_HOST,forceLocal:!0,locale:"en-GB",enableTranslationByDefault:!0,snackbarDuration:3e3,storageSecretKey:"my_night_in_paradise_secret_Key",defaultLang:"en",defaultLoaderType:"dots",defaultMaximumAfterCommaLength:2,snackbarDefaultPositionY:"bottom",defaultDisableNegativeNumbers:!0,defaultMaximumNumberLength:15})]};G(J,re).catch(e=>console.error(e));
