import{a as V}from"./chunk-JHOHYJWD.js";import{a as B}from"./chunk-TL6R7WHS.js";import{a as O}from"./chunk-US4DBW3U.js";import"./chunk-IXDNPNBC.js";import{a as S}from"./chunk-IA4DM2LR.js";import{a as $}from"./chunk-JU5LHE6N.js";import{a as j}from"./chunk-TRRKCROW.js";import{K as k,L as F,Y as M,fa as T,ia as N,ua as P,xa as W}from"./chunk-XVDAFDV3.js";import{Cb as x,Da as I,Ib as h,L as c,Nb as a,Ob as s,Pb as A,Yb as v,ca as b,fb as o,gb as g,ha as R,hc as l,ia as m,jc as d,m as y,ma as f,n as _,oc as D,pc as w,qb as E,xb as u}from"./chunk-PV357URW.js";var C=(()=>{let t=class t{constructor(e){this._networkService=e,this._reviews$=new _([]),this.reviews$=this._reviews$.asObservable()}getAllReviews(){this._networkService.get(S.REVIEWS).pipe(c(1)).subscribe(e=>{e&&Array.isArray(e.data)&&this._reviews$.next(e.data)})}deleteReview(e){this._networkService.delete(S.REVIEWS,void 0,e._id).pipe(c(1)).subscribe(()=>{V.UpdateArrayBehaviorSubject(this._reviews$,e,"delete","_id")})}};t.\u0275fac=function(n){return new(n||t)(R(N))},t.\u0275prov=b({token:t,factory:t.\u0275fac});let i=t;return i})();function L(i,t){if(i&1&&(a(0,"div",1)(1,"ul",2)(2,"li",3),l(3),s(),a(4,"li",3),l(5),s(),a(6,"li",3),l(7),s(),a(8,"li",3),l(9),s(),a(10,"li",3),l(11),s(),a(12,"li",3),l(13),s(),a(14,"li",3),l(15),s(),a(16,"li",3),l(17),s(),a(18,"li",3),l(19),s()()()),i&2){let r=v();o(3),d("Customer Name: ",r.data.name,""),o(2),d("Experience: ",r.data.experience," / 5 stars"),o(2),d("Cleanliness: ",r.data.cleanliness," / 5 stars"),o(2),d("Comfort: ",r.data.comfort," / 5 stars"),o(2),d("Amenities: ",r.data.amenities," / 5 stars"),o(2),d("Customer Service: ",r.data.customerService," / 5 stars"),o(2),d("Recommend: ",r.data.recommend?"Yes":"No",""),o(2),d("Improvement: ",r.data.improvement?r.data.improvement:"N/A",""),o(2),d("Comments: ",r.data.comments?r.data.comments:"N/A","")}}var G=(()=>{let t=class t{constructor(e,n){this.data=e,this._dialogRef=n,this.cardConfig={header:{title:{text:"Customer Review",tag:"h3",fontWeight:"700"},position:"center",suffixButton:{label:{text:"Close"},matType:"mat-icon-button",prefixIcon:{icon:"icon_x_circle"},onClick:()=>{this._dialogRef.close()}}},content:{addClass:"card p-2"},footer:{buttons:[{label:{text:"Close"},onClick:()=>{this._dialogRef.close()},matType:"mat-flat-button"}],position:"center"}}}};t.\u0275fac=function(n){return new(n||t)(g(F),g(k))},t.\u0275cmp=f({type:t,selectors:[["app-review-popup"]],standalone:!0,features:[w],decls:2,vars:2,consts:[[3,"config"],[1,"container","py-2","cd-max"],[1,"row","text-start"],[1,"cs-r"]],template:function(n,p){n&1&&(a(0,"ks-base-card",0),u(1,L,20,9,"div",1),s()),n&2&&(x("config",p.cardConfig),o(),h(p.data?1:-1))},dependencies:[P],styles:[".cs-r[_ngcontent-%COMP%]{padding:7px;font-size:16px}"],changeDetection:0});let i=t;return i})();function U(i,t){if(i&1&&A(0,"ks-basic-grid",0),i&2){let r=v();x("config",r.gridConfig)("refresh$",r.refresh$)}}var fe=(()=>{let t=class t{constructor(){this._dialog=m(T),this._destroyRef=m(I),this._reviewsService=m(C),this._navService=m($),this._isAdmin=B(O.ADMIN),this.refresh$=new y}ngOnInit(){this._navService.updateNav({show:!0,back:!1,title:j.LAYOUT.children.REVIEWS.name,buttons:[]}),this._reviewsService.getAllReviews(),this._initializeGrid()}ngAfterViewInit(){this._reviewsService.reviews$.pipe(M(this._destroyRef)).subscribe(e=>{this.refresh$.next({data:e})})}_initializeGrid(){this.gridConfig={data:E([]),defaultPagination:100,maxTableHeight:"calc(100dvh - 115px - 50px - 50px - 80px)",noDataMessage:{text:"No Reviews Found"},features:{showSearch:!0},columns:[{field:"name",title:"Customer Name",type:"string",extraStyles:{"min-width":"170px","max-width":"170px",width:"170px"}},{title:"Experience",field:"experience",type:"number",extraStyles:{"min-width":"100px"},suffix:" / 5 stars"},{title:"Cleanliness",field:"cleanliness",type:"number",extraStyles:{"min-width":"100px"},suffix:" / 5 stars"},{title:"Comfort",field:"comfort",type:"number",extraStyles:{"min-width":"80px"},suffix:" / 5 stars"},{title:"Amenities",field:"amenities",type:"number",extraStyles:{"min-width":"90px"},suffix:" / 5 stars"},{title:"Customer Service",field:"customerService",type:"number",extraStyles:{"min-width":"140px"},suffix:" / 5 stars"},{field:"createdAt",title:"Date",type:"date",dateFormat:"dd/MM/yyyy - HH:mm:ss a",extraStyles:{"min-width":"170px","max-width":"170px",width:"170px"}}],actionsColumn:{enabled:!0,maxButtons:window.innerWidth<700?1:void 0,width:window.innerWidth<700?void 0:"110px",maxWidth:window.innerWidth<700?void 0:"110px",minWidth:window.innerWidth<700?void 0:"110px",buttons:[{prefixIcon:{icon:"icon_eye"},label:{text:"View"},onClickFn:e=>this._openReviewPopup(e),matType:"mat-icon-button"},{prefixIcon:{icon:"icon_delete"},color:"warn",label:{text:"Delete"},onClickFn:e=>this._deleteReview(e),matType:"mat-icon-button",isVisibleFn:()=>this._isAdmin}]}}}_openReviewPopup(e){this._dialog.open(G,{width:"95vw",maxWidth:"500px",maxHeight:"95vh",disableClose:!0,autoFocus:!1,restoreFocus:!0,data:e})}_deleteReview(e){this._dialog.openConfirmPopup({title:{text:"Confirm Delete"},message:{text:"Are you sure you want to delete this review?"}}).afterClosed().pipe(c(1)).subscribe(n=>{n&&e?._id&&this._reviewsService.deleteReview(e)})}};t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=f({type:t,selectors:[["ks-solutions-reviews-listing"]],standalone:!0,features:[D([C]),w],decls:1,vars:1,consts:[[3,"config","refresh$"]],template:function(n,p){n&1&&u(0,U,1,2,"ks-basic-grid",0),n&2&&h(p.gridConfig?0:-1)},dependencies:[W],changeDetection:0});let i=t;return i})();export{fe as ReviewsComponent};
