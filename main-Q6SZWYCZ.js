import{a as le,b as xe}from"./chunk-MBDYABHJ.js";import{a as d,b as be}from"./chunk-DQYI455W.js";import{a as ce,b as Pe,c as h,d as x}from"./chunk-PVQPB666.js";import{a as _,b as me}from"./chunk-UOQFKZ5Q.js";import{a as pe,b as Ue}from"./chunk-ITSNA3JG.js";import{a as r,b as Y}from"./chunk-DKBVEZ2J.js";import{Ca as O,Ea as ae,Ga as R,Ha as T,Ta as se,Wa as A,b as $,ba as ie,ca as ke,d as X,e as Z,f as J,g as Q,i as Le,j as q,k as ee,l as te,m as oe,o as re,p as f,q as ne,r as E}from"./chunk-OX4MXTMU.js";import{Fb as B,Gb as W,I as M,J as L,M as k,Q as D,Qb as P,Rb as F,Sb as b,Vc as l,aa as G,ba as H,e as c,f as Ne,h as N,ib as U,la as i,pa as V,sc as K,tb as j,uc as z,v as S}from"./chunk-LUSYJMV7.js";var Ye,de,ue=c(()=>{"use strict";l();E();A();Ue();x();l();Ye=e=>({loading:e,disableInteractions:!0}),de=(()=>{let t=class t{constructor(){this._router=i(f),this._navService=i(pe),this._sessionService=i(h),this._keyBlocked=!1,this.loadingRouteSig=j(!1)}ngOnInit(){this._sessionService.updateUser(),this._navService.getThemeOnLoad(),document.addEventListener("keydown",n=>{if(["Enter"," "].includes(n.key)){if(this._keyBlocked){n.preventDefault(),n.stopPropagation();return}this._keyBlocked=!0,setTimeout(()=>{this._keyBlocked=!1},300)}}),this._router.events.subscribe(n=>{n instanceof q?(this.loadingRouteSig.set(!0),window.scrollTo(0,0)):(n instanceof ee||n instanceof oe||n instanceof te)&&this.loadingRouteSig.set(!1)})}};t.\u0275fac=function(s){return new(s||t)},t.\u0275cmp=V({type:t,selectors:[["app-root"]],standalone:!0,features:[K],decls:4,vars:5,consts:[[1,"app-container"],[3,"config"],[1,"global-router-container"]],template:function(s,a){s&1&&(P(0,"div",0),b(1,"ks-loader-overlay",1),P(2,"div",2),b(3,"router-outlet"),F()()),s&2&&(U(),B("config",z(3,Ye,a.loadingRouteSig)),U(),W("display",a.loadingRouteSig()?"none":"block"))},dependencies:[re,se],styles:[".app-container[_ngcontent-%COMP%], .app-container[_ngcontent-%COMP%]   .global-router-container[_ngcontent-%COMP%]{min-height:100dvh}"],changeDetection:0});let e=t;return e})()});var m,fe=c(()=>{"use strict";l();E();Y();x();m=e=>{let t=i(f),p=i(h);if(!p.loggedInUser)return t.navigate([r.LOGIN.route]),!1;if(!e.data)return!0;let s=e.data.roles;if(!s||!Array.isArray(s)||s.length===0)return!0;let a=p.checkAccess(s);return!a&&t.navigate([r.NOT_AUTHORIZED.route]),a}});var he,ge=c(()=>{"use strict";l();E();Y();x();he=()=>{let e=i(f);return i(h).loggedInUser?(e.navigate([r.LAYOUT.route]),!1):!0}});var we,Se,Ae=c(()=>{"use strict";Y();fe();ge();be();we=[{path:"",redirectTo:r.LAYOUT.children.RESERVATIONS.endpoint,pathMatch:"full"},{path:r.LAYOUT.children.CUSTOMERS.endpoint,loadComponent:()=>import("./chunk-J4IA7UWR.js").then(e=>e.CustomersComponent),canActivate:[m]},{path:r.LAYOUT.children.RESERVATIONS.endpoint,loadComponent:()=>import("./chunk-7PFPI3FA.js").then(e=>e.ReservationsComponent),canActivate:[m]},{path:r.LAYOUT.children.BUNGALOWS.endpoint,loadComponent:()=>import("./chunk-CBQVHIFJ.js").then(e=>e.BungalowsComponent),canActivate:[m],data:{roles:[d.VIEW_BUNGALOW]}},{path:r.LAYOUT.children.REVIEWS.endpoint,loadComponent:()=>import("./chunk-6NK2P6EK.js").then(e=>e.ReviewsComponent),canActivate:[m],data:{roles:[d.VIEW_REVIEWS]}},{path:r.LAYOUT.children.REVENUES.endpoint,loadComponent:()=>import("./chunk-B2TIZMXO.js").then(e=>e.RevenuesComponent),canActivate:[m],data:{roles:[d.VIEW_REVENUE]}},{path:r.LAYOUT.children.EXPENSES.endpoint,loadComponent:()=>import("./chunk-7GAVRUQV.js").then(e=>e.ExpensesComponent),canActivate:[m],data:{roles:[d.VIEW_EXPENSE]}},{path:r.LAYOUT.children.USER_MANAGEMENT.endpoint,loadComponent:()=>import("./chunk-RR6TEF6P.js").then(e=>e.UsersComponent),canActivate:[m],data:{roles:[d.VIEW_USER]}},{path:r.LAYOUT.children.REPORTS.endpoint,loadComponent:()=>import("./chunk-VKVTVWNR.js").then(e=>e.ReportsComponent),canActivate:[m],data:{roles:[d.VIEW_REPORTS]},children:[{path:"",pathMatch:"full",redirectTo:r.LAYOUT.children.REPORTS.children.YEARLY.endpoint},{path:r.LAYOUT.children.REPORTS.children.YEARLY.endpoint,loadComponent:()=>import("./chunk-QYUDXQAY.js").then(e=>e.ReportByYearComponent)}]}],Se=[{path:"",redirectTo:r.HOME.endpoint,pathMatch:"full"},{path:r.HOME.endpoint,loadComponent:()=>import("./chunk-G7CC5OON.js").then(e=>e.MainPageComponent)},{path:r.LAYOUT.endpoint,loadComponent:()=>import("./chunk-CYCKAY6D.js").then(e=>e.LayoutComponent),children:we,canActivate:[m]},{path:r.LOGIN.endpoint,loadComponent:()=>import("./chunk-6GJD655P.js").then(e=>e.LoginComponent),canActivate:[he]},{path:r.NOT_AUTHORIZED.endpoint,loadComponent:()=>import("./chunk-VUPD2LDN.js").then(e=>e.NotAuthorizedComponent)},{path:r.PAGE_NOT_FOUND.endpoint,loadComponent:()=>import("./chunk-F32SMTXX.js").then(e=>e.PageNotFoundComponent)},{path:"**",redirectTo:r.PAGE_NOT_FOUND.endpoint,pathMatch:"full"}]});var g,y=c(()=>{"use strict";me();g={API_HOST:_.API_HOST.nip_prod,CONFIG_URL:"assets/config/nip.json"}});function v(e,t){return e.clone({setHeaders:{Authorization:"Bearer "+t.getItem(ce.SS.token,!0)},withCredentials:!0})}var w=c(()=>{"use strict";Pe()});var ve,Ce=c(()=>{"use strict";l();A();H();w();y();me();xe();ve=(e,t)=>{let p=i(O),n=i(le),s=i(T),a=i(R),u;return t(e).pipe(D(()=>{if(u){let o=u;if(o.showMessage&&o.message){let C=Array.isArray(o.message)?o.message.map(I=>({text:I,tag:"p",addClass:"mb-0",translate:!1})):[{text:o.message,translate:!1}];o.isDialog?p.openConfirmPopup({hideYesNo:!0,message:C,title:{text:o.title??"Error",translate:!1}}):s.open({text:C.map(I=>I.text).join(", "),translate:!1},o.state??"error",{duration:o.snackbarDuration})}}}),M(o=>(u=o.error,o.status===401?e.url===g.API_HOST+_.AUTHENTICATION.refresh?(n.logOut(!0),S(()=>o)):n.isRefreshTokenCalled!==!0?(n.isRefreshTokenCalled=!0,n.callRefreshToken().pipe(k(1),L(C=>(n.successfulRefreshToken(C),t(v(e,a)))))):n.refreshToken$.pipe(k(1),L(()=>t(v(e,a)))):o.status===403?(n.isLogoutCalled||(p.closeAll(),p.openConfirmPopup({message:{text:"You don't have permission to access this resource."},title:{text:"Error"},hideYesNo:!0})),n.logOut(!0),S(()=>o)):o.status===0?(p.openConfirmPopup({message:[{tag:"span",text:"Please check your internet connection and ensure it is stable.",addClass:"fw-bold"},{tag:"span",text:"If the issue persists, please contact your administrator for further assistance."}],title:{text:"Something went wrong"},hideYesNo:!0}),S(()=>o)):S(()=>o))))}});var Ee,Oe=c(()=>{"use strict";J();l();A();H();Ee=(e,t)=>{let p=i(O),n=i(T);return t(e).pipe(G(s=>{if(s instanceof $&&s.body){let a=s.body;if(a.showMessage&&a.message){let u=Array.isArray(a.message)?a.message.map(o=>({text:o,tag:"p",addClass:"mb-0",translate:!1})):[{text:a.message,translate:!1}];if(a.isDialog){let o={hideYesNo:!0,message:u,title:{text:a.title??"Message",translate:!1}};p.openConfirmPopup(o)}else n.open({text:u.map(o=>o.text).join(", "),translate:!1},a.state??"success",{duration:a.snackbarDuration})}}}))}});var Re,Te=c(()=>{"use strict";l();A();w();Re=(e,t)=>{let p=i(R);return t(v(e,p))}});var _e,ye=c(()=>{"use strict";J();ke();E();A();Ae();y();Ce();Oe();Te();_e={providers:[ne(Se),ie(),X(Z([Re,ve,Ee])),ae({iconSize:"md",locale:"en-GB",forceLocal:!0,defaultLang:"en",snackbarDuration:3e3,defaultLoaderType:"rings",defaultMaximumNumberLength:15,enableTranslationByDefault:!0,defaultMaximumAfterCommaLength:2,snackbarDefaultPositionY:"bottom",defaultDisableNegativeNumbers:!0,baseNetworkServiceUrl:g.API_HOST,storageSecretKey:"my_night_in_paradise_secret_Key"})]}});var De=Ne(Ie=>{Le();ue();ye();y();N(Ie,null,function*(){yield Me(),Q(de,_e).catch(e=>console.error(e))});function Me(){return N(this,null,function*(){let e=yield fetch(g.CONFIG_URL);if(!e.ok)throw new Error(`Failed to fetch config: ${e.status} ${e.statusText}`);let t=yield e.json();if(!t||Array.isArray(t)||typeof t!="object")throw new Error("Invalid config structure");localStorage.setItem("config",JSON.stringify(t))})}});export default De();
