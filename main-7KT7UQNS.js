import{a as q}from"./chunk-CDG2SB2K.js";import{a as m}from"./chunk-JE5EXO4F.js";import{a as J,b as u}from"./chunk-JWZPFOXC.js";import{a as Q}from"./chunk-6CYPE36V.js";import{a as C}from"./chunk-BPNGRFUY.js";import{a as $}from"./chunk-ONICS2XY.js";import{a as t}from"./chunk-5ML3MIDN.js";import{Aa as Z,P as z,b as D,d as w,e as B,f as G,h as V,i as H,j as K,ja as S,k as W,la as X,m as j,n as d,na as A,o as F,oa as v}from"./chunk-32GEDFAZ.js";import{$ as k,Cb as b,Db as P,H as y,I as R,L as O,Nb as _,Ob as Y,P as L,Pb as N,fb as T,ia as i,ma as I,pc as x,qb as U,rc as M,u as f}from"./chunk-OWBIYIKH.js";var se=e=>({loading:e,disableInteractions:!0}),ee=(()=>{let r=class r{constructor(){this._router=i(d),this._navService=i($),this._sessionService=i(u),this._keyBlocked=!1,this.loadingRouteSig=U(!1)}ngOnInit(){this._sessionService.updateUser(),this._navService.getThemeOnLoad(),document.addEventListener("keydown",n=>{if(["Enter"," "].includes(n.key)){if(this._keyBlocked){n.preventDefault(),n.stopPropagation();return}this._keyBlocked=!0,setTimeout(()=>{this._keyBlocked=!1},300)}}),this._router.events.subscribe(n=>{n instanceof V?(this.loadingRouteSig.set(!0),window.scrollTo(0,0)):(n instanceof H||n instanceof W||n instanceof K)&&this.loadingRouteSig.set(!1)})}};r.\u0275fac=function(s){return new(s||r)},r.\u0275cmp=I({type:r,selectors:[["app-root"]],standalone:!0,features:[x],decls:4,vars:5,consts:[[1,"app-container"],[3,"config"],[1,"global-router-container"]],template:function(s,a){s&1&&(_(0,"div",0),N(1,"ks-loader-overlay",1),_(2,"div",2),N(3,"router-outlet"),Y()()),s&2&&(T(),b("config",M(3,se,a.loadingRouteSig)),T(),P("display",a.loadingRouteSig()?"none":"block"))},dependencies:[j,Z],styles:[".app-container[_ngcontent-%COMP%], .app-container[_ngcontent-%COMP%]   .global-router-container[_ngcontent-%COMP%]{min-height:100dvh}"],changeDetection:0});let e=r;return e})();var c=e=>{let r=i(d),p=i(u);if(!p.loggedInUser)return r.navigate([t.LOGIN.route]),!1;if(!e.data)return!0;let s=e.data.roles;if(!s||!Array.isArray(s)||s.length===0)return!0;let a=p.checkAccess(s);return!a&&r.navigate([t.NOT_AUTHORIZED.route]),a};var te=()=>{let e=i(d);return i(u).loggedInUser?(e.navigate([t.LAYOUT.route]),!1):!0};var pe=[{path:"",redirectTo:t.LAYOUT.children.RESERVATIONS.endpoint,pathMatch:"full"},{path:t.LAYOUT.children.CUSTOMERS.endpoint,loadComponent:()=>import("./chunk-SOMBZZBT.js").then(e=>e.CustomersComponent),canActivate:[c]},{path:t.LAYOUT.children.RESERVATIONS.endpoint,loadComponent:()=>import("./chunk-ZMBOEQ3G.js").then(e=>e.ReservationsComponent),canActivate:[c]},{path:t.LAYOUT.children.BUNGALOWS.endpoint,loadComponent:()=>import("./chunk-AVOT5FTL.js").then(e=>e.BungalowsComponent),canActivate:[c],data:{roles:[m.VIEW_BUNGALOW]}},{path:t.LAYOUT.children.REVIEWS.endpoint,loadComponent:()=>import("./chunk-BKT7PLZ2.js").then(e=>e.ReviewsComponent),canActivate:[c],data:{roles:[m.VIEW_REVIEWS]}},{path:t.LAYOUT.children.REVENUES.endpoint,loadComponent:()=>import("./chunk-SO52R4IM.js").then(e=>e.RevenuesComponent),canActivate:[c],data:{roles:[m.VIEW_REVENUE]}},{path:t.LAYOUT.children.EXPENSES.endpoint,loadComponent:()=>import("./chunk-EF7M6PDH.js").then(e=>e.ExpensesComponent),canActivate:[c],data:{roles:[m.VIEW_EXPENSE]}},{path:t.LAYOUT.children.USER_MANAGEMENT.endpoint,loadComponent:()=>import("./chunk-6UWZJJRW.js").then(e=>e.UsersComponent),canActivate:[c],data:{roles:[m.VIEW_USER]}},{path:t.LAYOUT.children.REPORTS.endpoint,loadComponent:()=>import("./chunk-TZ3H7BF6.js").then(e=>e.ReportsComponent),canActivate:[c],data:{roles:[m.VIEW_REPORTS]},children:[{path:"",pathMatch:"full",redirectTo:t.LAYOUT.children.REPORTS.children.YEARLY.endpoint},{path:t.LAYOUT.children.REPORTS.children.YEARLY.endpoint,loadComponent:()=>import("./chunk-ZBX6VKQE.js").then(e=>e.ReportByYearComponent)},{path:t.LAYOUT.children.REPORTS.children.BENCHMARK.endpoint,loadComponent:()=>import("./chunk-YMQSQWRE.js").then(e=>e.ReportBenchmarkComponent)}]}],oe=[{path:"",redirectTo:t.HOME.endpoint,pathMatch:"full"},{path:t.HOME.endpoint,loadComponent:()=>import("./chunk-DA6KIXWA.js").then(e=>e.MainPageComponent)},{path:t.LAYOUT.endpoint,loadComponent:()=>import("./chunk-XKYVV5T6.js").then(e=>e.LayoutComponent),children:pe,canActivate:[c]},{path:t.LOGIN.endpoint,loadComponent:()=>import("./chunk-OT6WZKX5.js").then(e=>e.LoginComponent),canActivate:[te]},{path:t.NOT_AUTHORIZED.endpoint,loadComponent:()=>import("./chunk-VCNWQRXJ.js").then(e=>e.NotAuthorizedComponent)},{path:t.PAGE_NOT_FOUND.endpoint,loadComponent:()=>import("./chunk-NXKTL27W.js").then(e=>e.PageNotFoundComponent)},{path:"**",redirectTo:t.PAGE_NOT_FOUND.endpoint,pathMatch:"full"}];function h(e,r){return e.clone({setHeaders:{Authorization:"Bearer "+r.getItem(J.SS.token,!0)},withCredentials:!0})}var ne=(e,r)=>{let p=i(S),n=i(q),s=i(v),a=i(A),l;return r(e).pipe(L(()=>{if(l){let o=l;if(o.showMessage&&o.message){let g=Array.isArray(o.message)?o.message.map(E=>({text:E,tag:"p",addClass:"mb-0",translate:!1})):[{text:o.message,translate:!1}];o.isDialog?p.openConfirmPopup({hideYesNo:!0,message:g,title:{text:o.title??"Error",translate:!1}}):s.open({text:g.map(E=>E.text).join(", "),translate:!1},o.state??"error",{duration:o.snackbarDuration})}}}),y(o=>(l=o.error,o.status===401?e.url===C.API_HOST+Q.AUTHENTICATION.refresh?(n.logOut(!0),f(()=>o)):n.isRefreshTokenCalled!==!0?(n.isRefreshTokenCalled=!0,n.callRefreshToken().pipe(O(1),R(g=>(n.successfulRefreshToken(g),r(h(e,a)))))):n.refreshToken$.pipe(O(1),R(()=>r(h(e,a)))):o.status===403?(n.isLogoutCalled||(p.closeAll(),p.openConfirmPopup({message:{text:"You don't have permission to access this resource."},title:{text:"Error"},hideYesNo:!0})),n.logOut(!0),f(()=>o)):o.status===0?(p.openConfirmPopup({message:[{tag:"span",text:"Please check your internet connection and ensure it is stable.",addClass:"fw-bold"},{tag:"span",text:"If the issue persists, please contact your administrator for further assistance."}],title:{text:"Something went wrong"},hideYesNo:!0}),f(()=>o)):f(()=>o))))};var re=(e,r)=>{let p=i(S),n=i(v);return r(e).pipe(k(s=>{if(s instanceof D&&s.body){let a=s.body;if(a.showMessage&&a.message){let l=Array.isArray(a.message)?a.message.map(o=>({text:o,tag:"p",addClass:"mb-0",translate:!1})):[{text:a.message,translate:!1}];if(a.isDialog){let o={hideYesNo:!0,message:l,title:{text:a.title??"Message",translate:!1}};p.openConfirmPopup(o)}else n.open({text:l.map(o=>o.text).join(", "),translate:!1},a.state??"success",{duration:a.snackbarDuration})}}}))};var ie=(e,r)=>{let p=i(A);return r(h(e,p))};var ae={providers:[F(oe),z(),w(B([ie,ne,re])),X({iconSize:"md",locale:"en-GB",forceLocal:!0,defaultLang:"en",snackbarDuration:3e3,defaultLoaderType:"rings",defaultMaximumNumberLength:15,enableTranslationByDefault:!0,defaultMaximumAfterCommaLength:2,snackbarDefaultPositionY:"bottom",defaultDisableNegativeNumbers:!0,baseNetworkServiceUrl:C.API_HOST,storageSecretKey:"my_night_in_paradise_secret_Key"})]};G(ee,ae).catch(e=>console.error(e));
