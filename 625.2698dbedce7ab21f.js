"use strict";(self.webpackChunkpos=self.webpackChunkpos||[]).push([[625],{8532:(D,g,o)=>{o.d(g,{P:()=>A});var h=o(7700),m=o(7430),t=o(5879),c=o(6814),l=o(2025),p=o(5995);function e(d,v){if(1&d&&(t.TgZ(0,"div"),t._uU(1),t.qZA()),2&d){const a=t.oxw();t.xp6(1),t.hij(" ",a.data.bodyMessage," ")}}function C(d,v){if(1&d){const a=t.EpF();t.TgZ(0,"div",8)(1,"div",9)(2,"shared-button",10),t.NdJ("btnClicked",function(){t.CHM(a);const u=t.oxw();return t.KtG(u.yesClicked())}),t.qZA()(),t.TgZ(3,"div",9)(4,"shared-button",10),t.NdJ("btnClicked",function(){t.CHM(a);const u=t.oxw();return t.KtG(u.noClicked())}),t.qZA()()()}if(2&d){const a=t.oxw();t.xp6(2),t.Q6J("config",a.yesButtonConfig),t.xp6(2),t.Q6J("config",a.noButtonConfig)}}function x(d,v){if(1&d){const a=t.EpF();t.TgZ(0,"div",11)(1,"shared-button",10),t.NdJ("btnClicked",function(){t.CHM(a);const u=t.oxw();return t.KtG(u.okClicked())}),t.qZA()()}if(2&d){const a=t.oxw();t.xp6(1),t.Q6J("config",a.okButtonConfig)}}const y=function(){return{icon:"close",color:"var(--text-color)"}};let A=(()=>{class d{constructor(a,f){this.dialogRef=a,this.data=f,this.appName=(0,m.Cd)("constants",!0)?.appName?(0,m.Cd)("constants",!0)?.appName:"P.O.S",this.okButtonConfig={label:"OK",type:"button",color:"primary",matAttribute:"mat-raised-button"},this.yesButtonConfig={label:"Yes",color:"primary",matAttribute:"mat-raised-button",takeFullWidth:!0},this.noButtonConfig={label:"No",color:"primary",matAttribute:"mat-raised-button",takeFullWidth:!0}}yesClicked(){this.dialogRef.close("yes")}noClicked(){this.dialogRef.close("no")}okClicked(){this.dialogRef.close("ok")}closeClicked(){this.dialogRef.close()}static#e=this.\u0275fac=function(f){return new(f||d)(t.Y36(h.so),t.Y36(h.WI))};static#t=this.\u0275cmp=t.Xpm({type:d,selectors:[["ng-component"]],decls:11,vars:6,consts:[[2,"border-radius","7px 7px 0 0"],[1,"cs-pop-title","d-flex","justify-content-between","py-2","px-4","text-light","align-items-center"],[2,"cursor","pointer",3,"config","click"],[2,"display","flex","border-top","1px solid gainsboro","margin","0px"],[1,"text-center","py-2","px-2",2,"min-height","70px"],[4,"ngIf"],["class","py-2 align-items-center justify-content-center d-flex",4,"ngIf"],["class","py-2 text-center",4,"ngIf"],[1,"py-2","align-items-center","justify-content-center","d-flex"],[1,"mx-1",2,"width","120px"],[3,"config","btnClicked"],[1,"py-2","text-center"]],template:function(f,u){1&f&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div"),t._uU(3),t.qZA(),t.TgZ(4,"shared-icon",2),t.NdJ("click",function(){return u.closeClicked()}),t.qZA()(),t._UZ(5,"div",3),t.TgZ(6,"div",4),t.YNc(7,e,2,1,"div",5),t.qZA(),t._UZ(8,"div",3),t.YNc(9,C,5,2,"div",6),t.YNc(10,x,2,1,"div",7),t.qZA()),2&f&&(t.xp6(3),t.Oqu(u.data.title?u.data.title:u.appName),t.xp6(1),t.Q6J("config",t.DdM(5,y)),t.xp6(3),t.Q6J("ngIf",u.data.bodyMessage),t.xp6(2),t.Q6J("ngIf",1==u.data.showYesNo),t.xp6(1),t.Q6J("ngIf",1==u.data.showOk))},dependencies:[c.O5,l.o,p.r],styles:[".cs-pop-title[_ngcontent-%COMP%]{font-size:20px;font-weight:600}.cs-pop-title[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{color:var(--text-color)}"]})}return d})()},5693:(D,g,o)=>{o.d(g,{s:()=>m});var h=o(6223);function m(c){return c instanceof h.cw?(c.markAllAsTouched(),Object.values(c.controls).forEach(l=>{l instanceof h.cw?Object.values(l.controls).forEach(p=>{p.markAsDirty()}):l.markAsDirty()})):(c.markAsTouched(),c.markAsDirty()),c.valid}},9625:(D,g,o)=>{o.r(g),o.d(g,{UsersModule:()=>K});var h=o(6814),m=o(3403),t=o(6223),c=o(7700),l=o(5994),p=o(5693),e=o(5879),C=o(3493),x=o(4246),y=o(9866);const A=function(){return{label:"Reset Password to 00000"}};function d(i,M){if(1&i&&(e.TgZ(0,"div",6),e._UZ(1,"shared-checkbox",7),e.qZA()),2&i){const n=e.oxw();e.xp6(1),e.Q6J("config",e.DdM(2,A))("control",n.form.controls.password)}}function v(i,M){1&i&&(e.TgZ(0,"div",10)(1,"span",11),e._uU(2,"Password: 00000"),e.qZA()())}function a(i,M){if(1&i&&(e.TgZ(0,"div",10)(1,"span",11),e._uU(2),e.ALo(3,"date"),e.qZA()()),2&i){const n=e.oxw();e.xp6(2),e.hij("Created At: ",e.lcZ(3,1,n.data.createdAt),"")}}const f=function(i){return{title:i,showSave:!0,showCancel:!0}},u=function(){return{label:"Username"}},T=function(){return{label:"Admin"}},E=function(){return{label:"Editor"}};let I=(()=>{class i{constructor(n,s){this.data=n,this._dialogRef=s,this.form=new t.cw({username:new t.NI("",[t.kI.required,t.kI.minLength(5),t.kI.maxLength(25)]),password:new t.NI(!1),admin:new t.NI(!1),editor:new t.NI(!1)})}ngOnInit(){this.data&&(this.editForm(this.data),this.loadedUser=structuredClone(this.data),delete this.loadedUser.isAdmin,delete this.loadedUser.isEditor,delete this.loadedUser.isUser)}handleDialogActions(n){n&&"ok"!==n&&"cancel"!==n?"save"===n&&this.submit():this._dialogRef.close()}editForm(n){this.form.patchValue({username:n.username,admin:!!n.roles.admin,editor:!!n.roles.editor})}submit(){if((0,p.s)(this.form)){const n=this.format(this.form.value);this._dialogRef.close(n)}}format(n){const s={username:n.username,roles:{user:l.l.user,editor:n.editor?l.l.editor:void 0,admin:n.admin?l.l.admin:void 0}};return(n.password||!this.data)&&(s.password="00000"),s}static#e=this.\u0275fac=function(s){return new(s||i)(e.Y36(c.WI),e.Y36(c.so))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-user-popup"]],decls:15,vars:16,consts:[[3,"config","btnClicked"],[1,"cd-max"],[1,"my-2"],[3,"readonly","config","control"],[1,"container","container-fluid"],[1,"row"],[1,"col-12"],[3,"config","control"],["class","col-12",4,"ngIf"],["class","col-12 my-2",4,"ngIf"],[1,"col-12","my-2"],[1,"d-flex","align-items-center","h-100","ps-2"]],template:function(s,r){1&s&&(e.TgZ(0,"shared-confirm-body",0),e.NdJ("btnClicked",function(w){return r.handleDialogActions(w)}),e.TgZ(1,"div",1)(2,"form",2)(3,"div",2),e._UZ(4,"shared-input",3),e.qZA(),e.ynx(5),e.TgZ(6,"div",4)(7,"div",5)(8,"div",6),e._UZ(9,"shared-checkbox",7),e.qZA(),e.TgZ(10,"div",6),e._UZ(11,"shared-checkbox",7),e.qZA(),e.YNc(12,d,2,3,"div",8),e.YNc(13,v,3,0,"div",9),e.YNc(14,a,4,3,"div",9),e.qZA()(),e.BQk(),e.qZA()()()),2&s&&(e.Q6J("config",e.VKq(11,f,r.data?"Edit User":"Create New User")),e.xp6(4),e.Q6J("readonly",!!r.data)("config",e.DdM(13,u))("control",r.form.controls.username),e.xp6(5),e.Q6J("config",e.DdM(14,T))("control",r.form.controls.admin),e.xp6(2),e.Q6J("config",e.DdM(15,E))("control",r.form.controls.editor),e.xp6(1),e.Q6J("ngIf",r.data),e.xp6(1),e.Q6J("ngIf",!r.data),e.xp6(1),e.Q6J("ngIf",r.data))},dependencies:[h.O5,t._Y,t.JL,t.F,C.b,x.a,y.F,h.uU],styles:[".cd-max[_ngcontent-%COMP%]{max-height:calc(95vh - 170px);overflow-y:scroll}"]})}return i})();var b=o(9773),P=o(8180),Z=o(5649),k=o(2025);const J=function(){return{icon:"edit",ripple:!0}},R=function(){return{icon:"delete",ripple:!0}};let O=(()=>{class i{constructor(n){this._userService=n,this.innerWidth=window.innerWidth}agInit(n){this.cellValue=this.getValueToDisplay(n)}refresh(n){return this.cellValue=this.getValueToDisplay(n),!0}onView(){this._userService.changes$.next({user:this.rowValue,state:"edit"})}onDelete(){this._userService.changes$.next({user:this.rowValue,state:"delete"})}getValueToDisplay(n){return this.rowValue=n.data,n.valueFormatted?n.valueFormatted:n.value}static#e=this.\u0275fac=function(s){return new(s||i)(e.Y36(Z.K))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["total-value-component"]],decls:3,vars:4,consts:[[1,"h-100","w-100","d-flex","align-items-center","justify-content-center"],[1,"cursor-pointer",3,"config","click"],[1,"ms-3","cursor-pointer",3,"config","click"]],template:function(s,r){1&s&&(e.TgZ(0,"div",0)(1,"shared-icon",1),e.NdJ("click",function(){return r.onView()}),e.qZA(),e.TgZ(2,"shared-icon",2),e.NdJ("click",function(){return r.onDelete()}),e.qZA()()),2&s&&(e.xp6(1),e.Q6J("config",e.DdM(2,J)),e.xp6(1),e.Q6J("config",e.DdM(3,R)))},dependencies:[k.o]})}return i})();var B=o(6775),W=o(8532),F=o(1961),N=o(5083),U=function(i){return i.new="Create New",i}(U||{});const S=[{path:"",component:(()=>{class i extends B.H{constructor(n,s,r){super(r),this._dialog=n,this._userService=s,this._navService=r,this.innerWidth=window.innerWidth,this.columnDefs=this.getCols(),this.defaultColDef={initialWidth:140,sortable:!0,resizable:!0,filter:!0,flex:1,minWidth:140}}ngOnInit(){this.Navbar_Update({show:!0,back:!1,title:this.NAV_NAMES.USER_MANAGEMENT.children.users.name,buttons:[{label:U.new,prefixIcon:{icon:"add_circle"}}]}),this.NavButtons$.pipe((0,b.R)(this.__unsubscribe$)).subscribe(n=>{n===U.new&&this.openUserPopup()}),this._userService.getAllUsers(),this._userService.changes$.pipe((0,b.R)(this.__unsubscribe$)).subscribe(n=>{"edit"===n.state?n.user?.username&&this.openUserPopup(n.user):"delete"===n.state&&n.user?.username&&this.onDeleteUser(n.user)})}ngOnDestroy(){super.ngOnDestroy(),this._userService.changes$.next({})}onGridReady(n){this._userService.users$.pipe((0,b.R)(this.__unsubscribe$)).subscribe(s=>{s&&(this.rowData=s.map(r=>({...r,isAdmin:!!r.roles.admin,isEditor:!!r.roles.editor,isUser:!!r.roles.user})))})}openUserPopup(n){this._dialog.open(I,{width:"95vw",maxWidth:"400px",maxHeight:"95vh",disableClose:!0,autoFocus:!n,restoreFocus:!1,data:n}).afterClosed().pipe((0,P.q)(1)).subscribe(s=>{s&&n&&this._userService.editUser(s),s&&!n&&this._userService.addNewUser(s)})}onDeleteUser(n){this._dialog.open(W.P,{width:"95vw",maxWidth:"500px",disableClose:!0,restoreFocus:!1,autoFocus:!1,data:{title:"Confirm Delete",bodyMessage:`Are you sure you want to delete ${n?.username}?`,showYesNo:!0,showOk:!1}}).afterClosed().pipe((0,P.q)(1)).subscribe(s=>{s&&"yes"===s&&n?.username&&this._userService.deleteUser(n)})}getCols(){return[{headerName:"Username",field:"username"},{headerName:"Admin",field:"isAdmin"},{headerName:"Editor",field:"isEditor"},{headerName:"User",field:"isUser"},{headerName:"",cellRenderer:O,width:100,minWidth:100,maxWidth:100,sortable:!1,filter:!1,resizable:!1,pinned:"right"}]}onWindowResize(n){this.innerWidth=window.innerWidth}static#e=this.\u0275fac=function(s){return new(s||i)(e.Y36(c.uw),e.Y36(Z.K),e.Y36(F.t))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-users"]],hostBindings:function(s,r){1&s&&e.NdJ("resize",function(){return r.onWindowResize()},!1,e.Jf7)},features:[e.qOj],decls:1,vars:10,consts:[[2,"width","100%","min-height","400px","height","calc(100vh - 180px)",3,"rowHeight","columnDefs","defaultColDef","rowData","pagination","paginationAutoPageSize","gridReady"]],template:function(s,r){1&s&&(e.TgZ(0,"ag-grid-angular",0),e.NdJ("gridReady",function(w){return r.onGridReady(w)}),e.qZA()),2&s&&(e.ekj("ag-theme-alpine","light"===r.$theme)("ag-theme-alpine-dark","dark"===r.$theme),e.Q6J("rowHeight",35)("columnDefs",r.columnDefs)("defaultColDef",r.defaultColDef)("rowData",r.rowData)("pagination",r.innerWidth>700)("paginationAutoPageSize",!0))},dependencies:[N.N8]})}return i})()}];let Q=(()=>{class i{static#e=this.\u0275fac=function(s){return new(s||i)};static#t=this.\u0275mod=e.oAB({type:i});static#n=this.\u0275inj=e.cJS({imports:[m.Bz.forChild(S),m.Bz]})}return i})();var Y=o(9255),j=o(9781),V=o(7858);let K=(()=>{class i{static#e=this.\u0275fac=function(s){return new(s||i)};static#t=this.\u0275mod=e.oAB({type:i});static#n=this.\u0275inj=e.cJS({imports:[h.ez,Q,N.sF,Y.B,c.Is,j.n,V.j]})}return i})()}}]);