import{a as c}from"./chunk-JHOHYJWD.js";import{a as i}from"./chunk-6CYPE36V.js";import{Z as S,ma as E}from"./chunk-32GEDFAZ.js";import{L as p,ca as d,ia as f,n as h,qb as u,x as a,y as m}from"./chunk-OWBIYIKH.js";var g=(()=>{let n=class n{constructor(){this._networkService=f(E),this._expenses$=new h([]),this.date=u(new Date),this.expensesLov$=this._expenses$.pipe(a(e=>{let r=new Map;for(let t of e){let s=t.name.trim();r.has(s)||r.set(s,t.name.trim())}return Array.from(r.values()).map(t=>({name:t,value:t})).sort((t,s)=>t.name.localeCompare(s.name))})),this.filteredExpenses$=m([this._expenses$,S(this.date)]).pipe(a(([e,r])=>{let t=(r.getMonth()+1).toString().padStart(2,"0"),s=r.getFullYear();return e.filter(l=>l.date.startsWith(`${s}-${t}`))}))}changeDate(e){this.date.update(r=>{if(typeof e=="string"){let t=new Date(r);return t.setDate(15),e==="next"?t.setMonth(r.getMonth()+1):t.setMonth(r.getMonth()-1),t}else return new Date(e.year,e.month-1,15)})}getExpenses(){this._networkService.get(i.EXPENSES).pipe(p(1)).subscribe({next:e=>{e.data&&this._expenses$.next(e.data)}})}addExpense(e){return this._networkService.post(i.EXPENSES,e)}updateExpense(e){return this._networkService.patch(i.EXPENSES,e,e._id)}deleteExpense(e){this._networkService.delete(i.EXPENSES,void 0,e._id).pipe(p(1)).subscribe(()=>{c.UpdateArrayBehaviorSubject(this._expenses$,e,"delete","_id")})}_updateStream(e,r){c.UpdateArrayBehaviorSubject(this._expenses$,e,r,"_id")}};n.\u0275fac=function(r){return new(r||n)},n.\u0275prov=d({token:n,factory:n.\u0275fac,providedIn:"root"});let o=n;return o})();export{g as a};
