"use strict";(self.webpackChunkpos=self.webpackChunkpos||[]).push([[849],{9751:(E,g,o)=>{o.d(g,{r:()=>U});var h=o(5351),m=o(1349),t=o(7705),c=o(177),l=o(4848),f=o(8930);function e(d,v){if(1&d&&(t.j41(0,"div"),t.EFF(1),t.k0s()),2&d){const a=t.XpG();t.R7$(1),t.SpI(" ",a.data.bodyMessage," ")}}function C(d,v){if(1&d){const a=t.RV6();t.j41(0,"div",8)(1,"div",9)(2,"shared-button",10),t.bIt("btnClicked",function(){t.eBV(a);const u=t.XpG();return t.Njj(u.yesClicked())}),t.k0s()(),t.j41(3,"div",9)(4,"shared-button",10),t.bIt("btnClicked",function(){t.eBV(a);const u=t.XpG();return t.Njj(u.noClicked())}),t.k0s()()()}if(2&d){const a=t.XpG();t.R7$(2),t.Y8G("config",a.yesButtonConfig),t.R7$(2),t.Y8G("config",a.noButtonConfig)}}function b(d,v){if(1&d){const a=t.RV6();t.j41(0,"div",11)(1,"shared-button",10),t.bIt("btnClicked",function(){t.eBV(a);const u=t.XpG();return t.Njj(u.okClicked())}),t.k0s()()}if(2&d){const a=t.XpG();t.R7$(1),t.Y8G("config",a.okButtonConfig)}}const y=function(){return{icon:"close",color:"var(--text-color)"}};let U=(()=>{class d{constructor(a,p){this.dialogRef=a,this.data=p,this.appName=(0,m.$L)("constants",!0)?.appName?(0,m.$L)("constants",!0)?.appName:"P.O.S",this.okButtonConfig={label:"OK",type:"button",color:"primary",matAttribute:"mat-raised-button"},this.yesButtonConfig={label:"Yes",color:"primary",matAttribute:"mat-raised-button",takeFullWidth:!0},this.noButtonConfig={label:"No",color:"primary",matAttribute:"mat-raised-button",takeFullWidth:!0}}yesClicked(){this.dialogRef.close("yes")}noClicked(){this.dialogRef.close("no")}okClicked(){this.dialogRef.close("ok")}closeClicked(){this.dialogRef.close()}static#e=this.\u0275fac=function(p){return new(p||d)(t.rXU(h.CP),t.rXU(h.Vh))};static#t=this.\u0275cmp=t.VBU({type:d,selectors:[["ng-component"]],decls:11,vars:6,consts:[[2,"border-radius","7px 7px 0 0"],[1,"cs-pop-title","d-flex","justify-content-between","py-2","px-4","text-light","align-items-center"],[2,"cursor","pointer",3,"config","click"],[2,"display","flex","border-top","1px solid gainsboro","margin","0px"],[1,"text-center","py-2","px-2",2,"min-height","70px"],[4,"ngIf"],["class","py-2 align-items-center justify-content-center d-flex",4,"ngIf"],["class","py-2 text-center",4,"ngIf"],[1,"py-2","align-items-center","justify-content-center","d-flex"],[1,"mx-1",2,"width","120px"],[3,"config","btnClicked"],[1,"py-2","text-center"]],template:function(p,u){1&p&&(t.j41(0,"div",0)(1,"div",1)(2,"div"),t.EFF(3),t.k0s(),t.j41(4,"shared-icon",2),t.bIt("click",function(){return u.closeClicked()}),t.k0s()(),t.nrm(5,"div",3),t.j41(6,"div",4),t.DNE(7,e,2,1,"div",5),t.k0s(),t.nrm(8,"div",3),t.DNE(9,C,5,2,"div",6),t.DNE(10,b,2,1,"div",7),t.k0s()),2&p&&(t.R7$(3),t.JRh(u.data.title?u.data.title:u.appName),t.R7$(1),t.Y8G("config",t.lJ4(5,y)),t.R7$(3),t.Y8G("ngIf",u.data.bodyMessage),t.R7$(2),t.Y8G("ngIf",1==u.data.showYesNo),t.R7$(1),t.Y8G("ngIf",1==u.data.showOk))},dependencies:[c.bT,l.R,f.Q],styles:[".cs-pop-title[_ngcontent-%COMP%]{font-size:20px;font-weight:600}.cs-pop-title[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{color:var(--text-color)}"]})}return d})()},785:(E,g,o)=>{o.d(g,{v:()=>m});var h=o(9417);function m(c){return c instanceof h.gE?(c.markAllAsTouched(),Object.values(c.controls).forEach(l=>{l instanceof h.gE?Object.values(l.controls).forEach(f=>{f.markAsDirty()}):l.markAsDirty()})):(c.markAsTouched(),c.markAsDirty()),c.valid}},7849:(E,g,o)=>{o.r(g),o.d(g,{UsersModule:()=>L});var h=o(177),m=o(7062),t=o(9417),c=o(5351),l=o(8103),f=o(785),e=o(7705),C=o(5744),b=o(6983),y=o(9879);const U=function(){return{label:"Reset Password to 00000"}};function d(i,x){if(1&i&&(e.j41(0,"div",6),e.nrm(1,"shared-checkbox",7),e.k0s()),2&i){const n=e.XpG();e.R7$(1),e.Y8G("config",e.lJ4(2,U))("control",n.form.controls.password)}}function v(i,x){1&i&&(e.j41(0,"div",10)(1,"span",11),e.EFF(2,"Password: 00000"),e.k0s()())}function a(i,x){if(1&i&&(e.j41(0,"div",10)(1,"span",11),e.EFF(2),e.nI1(3,"date"),e.k0s()()),2&i){const n=e.XpG();e.R7$(2),e.SpI("Created At: ",e.bMT(3,1,n.data.createdAt),"")}}const p=function(i){return{title:i,showSave:!0,showCancel:!0}},u=function(){return{label:"Username"}},P=function(){return{label:"Admin"}},T=function(){return{label:"Editor"}};let $=(()=>{class i{constructor(n,s){this.data=n,this._dialogRef=s,this.form=new t.gE({username:new t.MJ("",[t.k0.required,t.k0.minLength(5),t.k0.maxLength(25)]),password:new t.MJ(!1),admin:new t.MJ(!1),editor:new t.MJ(!1)})}ngOnInit(){this.data&&(this.editForm(this.data),this.loadedUser=structuredClone(this.data),delete this.loadedUser.isAdmin,delete this.loadedUser.isEditor,delete this.loadedUser.isUser)}handleDialogActions(n){n&&"ok"!==n&&"cancel"!==n?"save"===n&&this.submit():this._dialogRef.close()}editForm(n){this.form.patchValue({username:n.username,admin:!!n.roles.admin,editor:!!n.roles.editor})}submit(){if((0,f.v)(this.form)){const n=this.format(this.form.value);this._dialogRef.close(n)}}format(n){const s={username:n.username,roles:{user:l.m.user,editor:n.editor?l.m.editor:void 0,admin:n.admin?l.m.admin:void 0}};return(n.password||!this.data)&&(s.password="00000"),s}static#e=this.\u0275fac=function(s){return new(s||i)(e.rXU(c.Vh),e.rXU(c.CP))};static#t=this.\u0275cmp=e.VBU({type:i,selectors:[["app-user-popup"]],decls:15,vars:16,consts:[[3,"config","btnClicked"],[1,"cd-max"],[1,"my-2"],[3,"readonly","config","control"],[1,"container","container-fluid"],[1,"row"],[1,"col-12"],[3,"config","control"],["class","col-12",4,"ngIf"],["class","col-12 my-2",4,"ngIf"],[1,"col-12","my-2"],[1,"d-flex","align-items-center","h-100","ps-2"]],template:function(s,r){1&s&&(e.j41(0,"shared-confirm-body",0),e.bIt("btnClicked",function(k){return r.handleDialogActions(k)}),e.j41(1,"div",1)(2,"form",2)(3,"div",2),e.nrm(4,"shared-input",3),e.k0s(),e.qex(5),e.j41(6,"div",4)(7,"div",5)(8,"div",6),e.nrm(9,"shared-checkbox",7),e.k0s(),e.j41(10,"div",6),e.nrm(11,"shared-checkbox",7),e.k0s(),e.DNE(12,d,2,3,"div",8),e.DNE(13,v,3,0,"div",9),e.DNE(14,a,4,3,"div",9),e.k0s()(),e.bVm(),e.k0s()()()),2&s&&(e.Y8G("config",e.eq3(11,p,r.data?"Edit User":"Create New User")),e.R7$(4),e.Y8G("readonly",!!r.data)("config",e.lJ4(13,u))("control",r.form.controls.username),e.R7$(5),e.Y8G("config",e.lJ4(14,P))("control",r.form.controls.admin),e.R7$(2),e.Y8G("config",e.lJ4(15,T))("control",r.form.controls.editor),e.R7$(1),e.Y8G("ngIf",r.data),e.R7$(1),e.Y8G("ngIf",!r.data),e.R7$(1),e.Y8G("ngIf",r.data))},dependencies:[h.bT,t.qT,t.cb,t.cV,C.P,b.S,y.m,h.vh],styles:[".cd-max[_ngcontent-%COMP%]{max-height:calc(95vh - 170px);overflow-y:scroll}"]})}return i})();var D=o(6977),A=o(6697),w=o(8065),M=o(4848);const j=function(){return{icon:"edit",ripple:!0}},G=function(){return{icon:"delete",ripple:!0}};let N=(()=>{class i{constructor(n){this._userService=n,this.innerWidth=window.innerWidth}agInit(n){this.cellValue=this.getValueToDisplay(n)}refresh(n){return this.cellValue=this.getValueToDisplay(n),!0}onView(){this._userService.changes$.next({user:this.rowValue,state:"edit"})}onDelete(){this._userService.changes$.next({user:this.rowValue,state:"delete"})}getValueToDisplay(n){return this.rowValue=n.data,n.valueFormatted?n.valueFormatted:n.value}static#e=this.\u0275fac=function(s){return new(s||i)(e.rXU(w.D))};static#t=this.\u0275cmp=e.VBU({type:i,selectors:[["total-value-component"]],decls:3,vars:4,consts:[[1,"h-100","w-100","d-flex","align-items-center","justify-content-center"],[1,"cursor-pointer",3,"config","click"],[1,"ms-3","cursor-pointer",3,"config","click"]],template:function(s,r){1&s&&(e.j41(0,"div",0)(1,"shared-icon",1),e.bIt("click",function(){return r.onView()}),e.k0s(),e.j41(2,"shared-icon",2),e.bIt("click",function(){return r.onDelete()}),e.k0s()()),2&s&&(e.R7$(1),e.Y8G("config",e.lJ4(2,j)),e.R7$(1),e.Y8G("config",e.lJ4(3,G)))},dependencies:[M.R]})}return i})();var V=o(1335),B=o(9751),F=o(8895),I=o(3524),R=function(i){return i.new="Create New",i}(R||{});const O=[{path:"",component:(()=>{class i extends V.${constructor(n,s,r){super(r),this._dialog=n,this._userService=s,this._navService=r,this.innerWidth=window.innerWidth,this.columnDefs=this.getCols(),this.defaultColDef={initialWidth:140,sortable:!0,resizable:!0,filter:!0,flex:1,minWidth:140}}ngOnInit(){this.Navbar_Update({show:!0,back:!1,title:this.NAV_NAMES.USER_MANAGEMENT.children.users.name,buttons:[{label:R.new,prefixIcon:{icon:"add_circle"}}]}),this.NavButtons$.pipe((0,D.Q)(this.__unsubscribe$)).subscribe(n=>{n===R.new&&this.openUserPopup()}),this._userService.getAllUsers(),this._userService.changes$.pipe((0,D.Q)(this.__unsubscribe$)).subscribe(n=>{"edit"===n.state?n.user?.username&&this.openUserPopup(n.user):"delete"===n.state&&n.user?.username&&this.onDeleteUser(n.user)})}ngOnDestroy(){super.ngOnDestroy(),this._userService.changes$.next({})}onGridReady(n){this._userService.users$.pipe((0,D.Q)(this.__unsubscribe$)).subscribe(s=>{s&&(this.rowData=s.map(r=>({...r,isAdmin:!!r.roles.admin,isEditor:!!r.roles.editor,isUser:!!r.roles.user})))})}openUserPopup(n){this._dialog.open($,{width:"95vw",maxWidth:"400px",maxHeight:"95vh",disableClose:!0,autoFocus:!n,restoreFocus:!1,data:n}).afterClosed().pipe((0,A.s)(1)).subscribe(s=>{s&&n&&this._userService.editUser(s),s&&!n&&this._userService.addNewUser(s)})}onDeleteUser(n){this._dialog.open(B.r,{width:"95vw",maxWidth:"500px",disableClose:!0,restoreFocus:!1,autoFocus:!1,data:{title:"Confirm Delete",bodyMessage:`Are you sure you want to delete ${n?.username}?`,showYesNo:!0,showOk:!1}}).afterClosed().pipe((0,A.s)(1)).subscribe(s=>{s&&"yes"===s&&n?.username&&this._userService.deleteUser(n)})}getCols(){return[{headerName:"Username",field:"username"},{headerName:"Admin",field:"isAdmin"},{headerName:"Editor",field:"isEditor"},{headerName:"User",field:"isUser"},{headerName:"",cellRenderer:N,width:100,minWidth:100,maxWidth:100,sortable:!1,filter:!1,resizable:!1,pinned:"right"}]}onWindowResize(n){this.innerWidth=window.innerWidth}static#e=this.\u0275fac=function(s){return new(s||i)(e.rXU(c.bZ),e.rXU(w.D),e.rXU(F.F))};static#t=this.\u0275cmp=e.VBU({type:i,selectors:[["app-users"]],hostBindings:function(s,r){1&s&&e.bIt("resize",function(){return r.onWindowResize()},!1,e.tSv)},features:[e.Vt3],decls:1,vars:10,consts:[[2,"width","100%","min-height","400px","height","calc(100vh - 180px)",3,"rowHeight","columnDefs","defaultColDef","rowData","pagination","paginationAutoPageSize","gridReady"]],template:function(s,r){1&s&&(e.j41(0,"ag-grid-angular",0),e.bIt("gridReady",function(k){return r.onGridReady(k)}),e.k0s()),2&s&&(e.AVh("ag-theme-alpine","light"===r.$theme)("ag-theme-alpine-dark","dark"===r.$theme),e.Y8G("rowHeight",35)("columnDefs",r.columnDefs)("defaultColDef",r.defaultColDef)("rowData",r.rowData)("pagination",r.innerWidth>700)("paginationAutoPageSize",!0))},dependencies:[I.xs]})}return i})()}];let W=(()=>{class i{static#e=this.\u0275fac=function(s){return new(s||i)};static#t=this.\u0275mod=e.$C({type:i});static#n=this.\u0275inj=e.G2t({imports:[m.iI.forChild(O),m.iI]})}return i})();var S=o(2422),Y=o(9334),X=o(5526);let L=(()=>{class i{static#e=this.\u0275fac=function(s){return new(s||i)};static#t=this.\u0275mod=e.$C({type:i});static#n=this.\u0275inj=e.G2t({imports:[h.MD,W,I.$V,S.m,c.hM,Y.H,X.V]})}return i})()}}]);