import{a as B}from"./chunk-JHOHYJWD.js";import{a as H}from"./chunk-JE5EXO4F.js";import{b as V}from"./chunk-JWZPFOXC.js";import{a as O}from"./chunk-Q7PONYZL.js";import{a as S}from"./chunk-6CYPE36V.js";import"./chunk-BPNGRFUY.js";import{a as j}from"./chunk-ONICS2XY.js";import{a as W}from"./chunk-5ML3MIDN.js";import{Ba as N,K as k,L as T,Y as F,ja as M,ma as P,ya as $}from"./chunk-32GEDFAZ.js";import{Cb as u,Da as E,Ib as h,L as d,Nb as s,Ob as c,Pb as D,Yb as x,a as C,b as _,ca as R,fb as a,hc as l,ia as r,jc as m,m as y,ma as p,n as b,oc as A,pc as v,qb as I,xb as f}from"./chunk-OWBIYIKH.js";function U(i,e){if(i&1&&(s(0,"ks-base-card",0)(1,"div",1)(2,"ul",2)(3,"li",3),l(4),c(),s(5,"li",3),l(6),c(),s(7,"li",3),l(8),c(),s(9,"li",3),l(10),c(),s(11,"li",3),l(12),c(),s(13,"li",3),l(14),c(),s(15,"li",3),l(16),c(),s(17,"li",3),l(18),c(),s(19,"li",3),l(20),c()()()()),i&2){let n=x();u("config",n.cardConfig),a(4),m("Customer Name: ",n.data.name,""),a(2),m("Experience: ",n.data.experience," / 5 stars"),a(2),m("Cleanliness: ",n.data.cleanliness," / 5 stars"),a(2),m("Comfort: ",n.data.comfort," / 5 stars"),a(2),m("Amenities: ",n.data.amenities," / 5 stars"),a(2),m("Customer Service: ",n.data.customerService," / 5 stars"),a(2),m("Recommend: ",n.data.recommend?"Yes":"No",""),a(2),m("Improvement: ",n.data.improvement?n.data.improvement:"N/A",""),a(2),m("Comments: ",n.data.comments?n.data.comments:"N/A","")}}var G=(()=>{let e=class e{constructor(){this._dialogRef=r(k),this.data=r(T),this.cardConfig={header:{title:{text:"Customer Review",tag:"h3",fontWeight:"700"},position:"center",suffixButton:{label:{text:"Close"},matType:"mat-icon-button",prefixIcon:{icon:"icon_x_circle"},onClick:()=>this._dialogRef.close()}},content:{addClass:"card p-2"},footer:{position:"center",buttons:[{label:{text:"Close"},onClick:()=>this._dialogRef.close(),matType:"mat-flat-button"}]}}}};e.\u0275fac=function(o){return new(o||e)},e.\u0275cmp=p({type:e,selectors:[["app-review-popup"]],standalone:!0,features:[v],decls:1,vars:1,consts:[[3,"config"],[1,"container","py-2","cd-max"],[1,"row","text-start"],[1,"cs-r"]],template:function(o,g){o&1&&f(0,U,21,10,"ks-base-card",0),o&2&&h(g.data?0:-1)},dependencies:[$],styles:[".cs-r[_ngcontent-%COMP%]{padding:7px;font-size:16px}"],changeDetection:0});let i=e;return i})();var w=(()=>{let e=class e{constructor(){this._networkService=r(P),this._reviews$=new b([]),this.reviews$=this._reviews$.asObservable()}getAllReviews(){this._networkService.get(S.REVIEWS).pipe(d(1)).subscribe(t=>{t&&Array.isArray(t.data)&&this._reviews$.next(t.data)})}deleteReview(t){this._networkService.delete(S.REVIEWS,void 0,t._id).pipe(d(1)).subscribe(()=>{B.UpdateArrayBehaviorSubject(this._reviews$,t,"delete","_id")})}};e.\u0275fac=function(o){return new(o||e)},e.\u0275prov=R({token:e,factory:e.\u0275fac});let i=e;return i})();function z(i,e){if(i&1&&D(0,"ks-basic-grid",0),i&2){let n=x();u("config",n.gridConfig)("refresh$",n.refresh$)}}var Se=(()=>{let e=class e{constructor(){this._destroyRef=r(E),this._dialog=r(M),this._navService=r(j),this._configService=r(O),this._reviewsService=r(w),this._sessionService=r(V),this._canDelete=this._sessionService.checkAccess(H.DELETE_REVIEWS),this.refresh$=new y}ngOnInit(){this._navService.updateNav({show:!0,back:!1,title:W.LAYOUT.children.REVIEWS.name,buttons:[]}),this._reviewsService.getAllReviews(),this._initializeGrid()}ngAfterViewInit(){this._reviewsService.reviews$.pipe(F(this._destroyRef)).subscribe(t=>{this.refresh$.next({data:t})})}_initializeGrid(){this.gridConfig={data:I([]),defaultPagination:100,maxTableHeight:this._configService.appConfig.maxTableHeightWithSearch,noDataMessage:{text:"No Reviews Found"},features:{showSearch:!0},columns:[{field:"name",title:"Customer Name",type:"string",extraStyles:{"min-width":"170px","max-width":"170px",width:"170px"}},{title:"Experience",field:"experience",type:"number",extraStyles:{"min-width":"100px"},suffix:" / 5 stars"},{title:"Cleanliness",field:"cleanliness",type:"number",extraStyles:{"min-width":"100px"},suffix:" / 5 stars"},{title:"Comfort",field:"comfort",type:"number",extraStyles:{"min-width":"80px"},suffix:" / 5 stars"},{title:"Amenities",field:"amenities",type:"number",extraStyles:{"min-width":"90px"},suffix:" / 5 stars"},{title:"Customer Service",field:"customerService",type:"number",extraStyles:{"min-width":"140px"},suffix:" / 5 stars"},{field:"createdAt",title:"Date",type:"date",dateFormat:"dd/MM/yyyy - HH:mm:ss a",extraStyles:{"min-width":"170px","max-width":"170px",width:"170px"}}],actionsColumn:_(C({},this._configService.getActionColumn(2)),{enabled:!0,buttons:[{prefixIcon:{icon:"icon_eye"},label:{text:"View"},onClickFn:t=>this._openReviewPopup(t),matType:"mat-icon-button"},{prefixIcon:{icon:"icon_delete"},color:"warn",label:{text:"Delete"},onClickFn:t=>this._deleteReview(t),matType:"mat-icon-button",isVisibleFn:()=>this._canDelete}]})}}_openReviewPopup(t){this._dialog.open(G,{width:"95vw",maxWidth:"500px",maxHeight:"95vh",disableClose:!0,autoFocus:!1,restoreFocus:!0,data:t})}_deleteReview(t){this._dialog.openConfirmPopup({title:{text:"Confirm Delete"},message:{text:"Are you sure you want to delete this review?"}}).afterClosed().pipe(d(1)).subscribe(o=>{o&&t?._id&&this._reviewsService.deleteReview(t)})}};e.\u0275fac=function(o){return new(o||e)},e.\u0275cmp=p({type:e,selectors:[["ks-solutions-reviews-listing"]],standalone:!0,features:[A([w]),v],decls:1,vars:1,consts:[[3,"config","refresh$"]],template:function(o,g){o&1&&f(0,z,1,2,"ks-basic-grid",0),o&2&&h(g.gridConfig?0:-1)},dependencies:[N],changeDetection:0});let i=e;return i})();export{Se as ReviewsComponent};
