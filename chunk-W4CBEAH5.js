import{a as K}from"./chunk-IA4DM2LR.js";import{a as z}from"./chunk-JU5LHE6N.js";import{a as H}from"./chunk-TRRKCROW.js";import{K as E,L as W,Y as B,fa as O,ia as N,ua as G,xa as U}from"./chunk-XVDAFDV3.js";import{Ac as P,Cb as u,Da as D,Ib as f,Jb as I,L as _,Lb as T,Mb as M,Nb as s,Ob as r,Pb as R,Yb as h,bd as j,ca as w,fb as a,gb as g,ha as S,hc as c,ia as d,ic as $,jc as v,m as y,ma as p,n as b,oc as A,pc as x,qb as k,xb as l,yc as F}from"./chunk-PV357URW.js";var C=(()=>{let e=class e{constructor(i){this._networkService=i,this._customers$=new b([]),this.customers$=this._customers$.asObservable()}getAllCustomers(){this._networkService.get(K.CUSTOMERS).pipe(_(1)).subscribe(i=>{i&&Array.isArray(i.data)&&this._customers$.next(i.data)})}};e.\u0275fac=function(o){return new(o||e)(S(N))},e.\u0275prov=w({token:e,factory:e.\u0275fac});let t=e;return t})();function Y(t,e){if(t&1&&(s(0,"div",3)(1,"div",4)(2,"div",5)(3,"h5",6),c(4),r(),s(5,"p",7)(6,"strong"),c(7,"Date:"),r(),c(8),F(9,"date"),r(),s(10,"p",8)(11,"strong"),c(12,"Price:"),r(),c(13),r()()()()),t&2){let n=e.$implicit;a(4),$(n.contact),a(4),v(" ",P(9,3,n.bookedDate,"dd MMM yyyy")," "),a(5),v(" ",n.price,"$ ")}}function q(t,e){if(t&1&&(s(0,"div",2),T(1,Y,14,6,"div",3,I),r()),t&2){let n=h();a(),M(n.data.bookings)}}var V=(()=>{let e=class e{constructor(i,o){this.data=i,this._dialogRef=o,this.cardConfig={header:{title:{text:"Customer's Reservations",tag:"h3",fontWeight:"700"},position:"center",suffixButton:{label:{text:"Close"},matType:"mat-icon-button",prefixIcon:{icon:"icon_x_circle"},onClick:()=>{this._dialogRef.close()}}},content:{addClass:"card p-2"},footer:{buttons:[{label:{text:"Close"},onClick:()=>{this._dialogRef.close()},matType:"mat-flat-button"}],position:"center"}}}};e.\u0275fac=function(o){return new(o||e)(g(W),g(E))},e.\u0275cmp=p({type:e,selectors:[["app-customer-popup"]],standalone:!0,features:[x],decls:3,vars:2,consts:[[3,"config"],[1,"container","my-4"],[1,"row","g-3"],[1,"col-12"],[1,"card","shadow-sm","h-100"],[1,"card-body"],[1,"card-title"],[1,"card-text","mb-1"],[1,"card-text"]],template:function(o,m){o&1&&(s(0,"ks-base-card",0)(1,"div",1),l(2,q,3,0,"div",2),r()()),o&2&&(u("config",m.cardConfig),a(2),f(m.data?2:-1))},dependencies:[G,j],changeDetection:0});let t=e;return t})();function J(t,e){if(t&1&&R(0,"ks-basic-grid",0),t&2){let n=h();u("config",n.gridConfig)("refresh$",n.refresh$)}}var xe=(()=>{let e=class e{constructor(){this._dialog=d(O),this._destroyRef=d(D),this._customerService=d(C),this._navService=d(z),this.refresh$=new y}ngOnInit(){this._navService.updateNav({show:!0,back:!1,title:H.LAYOUT.children.CUSTOMERS.name,buttons:[]}),this._customerService.getAllCustomers(),this._initializeGrid()}ngAfterViewInit(){this._customerService.customers$.pipe(B(this._destroyRef)).subscribe(i=>{this.refresh$.next({data:i})})}_initializeGrid(){this.gridConfig={data:k([]),defaultPagination:100,maxTableHeight:"calc(100dvh - 115px - 50px - 50px - 80px)",noDataMessage:{text:"No Customers Found"},features:{showSearch:!0},columns:[{field:"name",title:"Customer Name",type:"string",extraStyles:{"min-width":"170px"}},{title:"Reservations",field:"count",type:"number",extraStyles:{"min-width":"100px","max-width":"100px",width:"100px"}}],actionsColumn:{enabled:!0,maxButtons:window.innerWidth<700?1:void 0,width:window.innerWidth<700?void 0:"70px",maxWidth:window.innerWidth<700?void 0:"70px",minWidth:window.innerWidth<700?void 0:"70px",buttons:[{prefixIcon:{icon:"icon_eye"},label:{text:"View"},onClickFn:i=>this._openCustomerPopup(i),matType:"mat-icon-button"}]}}}_openCustomerPopup(i){this._dialog.open(V,{width:"95vw",maxWidth:"500px",maxHeight:"95vh",disableClose:!0,autoFocus:!1,restoreFocus:!0,data:i})}};e.\u0275fac=function(o){return new(o||e)},e.\u0275cmp=p({type:e,selectors:[["ks-solutions-customers-listing"]],standalone:!0,features:[A([C]),x],decls:1,vars:1,consts:[[3,"config","refresh$"]],template:function(o,m){o&1&&l(0,J,1,2,"ks-basic-grid",0),o&2&&f(m.gridConfig?0:-1)},dependencies:[U],changeDetection:0});let t=e;return t})();export{xe as CustomersComponent};
