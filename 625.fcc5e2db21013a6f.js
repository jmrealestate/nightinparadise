"use strict";(self.webpackChunkpos=self.webpackChunkpos||[]).push([[625],{5693:(y,u,o)=>{o.d(u,{s:()=>h});var d=o(6223);function h(r){return r instanceof d.cw?(r.markAllAsTouched(),Object.values(r.controls).forEach(a=>{a instanceof d.cw?Object.values(a.controls).forEach(l=>{l.markAsDirty()}):a.markAsDirty()})):(r.markAsTouched(),r.markAsDirty()),r.valid}},9625:(y,u,o)=>{o.r(u),o.d(u,{UsersModule:()=>Y});var d=o(6814),h=o(3403),c=o(6223),r=o(7700),a=o(5994),l=o(5693),e=o(5879),D=o(3493),b=o(4246),C=o(9866);const N=function(){return{label:"Reset Password to 00000"}};function T(n,w){if(1&n&&(e.TgZ(0,"div",6),e._UZ(1,"shared-checkbox",7),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("config",e.DdM(2,N))("control",t.form.controls.password)}}function x(n,w){1&n&&(e.TgZ(0,"div",10)(1,"span",11),e._uU(2,"Password: 00000"),e.qZA()())}function Z(n,w){if(1&n&&(e.TgZ(0,"div",10)(1,"span",11),e._uU(2),e.ALo(3,"date"),e.qZA()()),2&n){const t=e.oxw();e.xp6(2),e.hij("Created At: ",e.lcZ(3,1,t.data.createdAt),"")}}const I=function(n){return{title:n,showSave:!0,showCancel:!0}},J=function(){return{label:"Username"}},P=function(){return{label:"Admin"}},R=function(){return{label:"Editor"}};let S=(()=>{class n{constructor(t,s){this.data=t,this._dialogRef=s,this.form=new c.cw({username:new c.NI("",[c.kI.required,c.kI.minLength(5),c.kI.maxLength(25)]),password:new c.NI(!1),admin:new c.NI(!1),editor:new c.NI(!1)})}ngOnInit(){this.data&&(this.editForm(this.data),this.loadedUser=structuredClone(this.data),delete this.loadedUser.isAdmin,delete this.loadedUser.isEditor,delete this.loadedUser.isUser)}handleDialogActions(t){t&&"ok"!==t&&"cancel"!==t?"save"===t&&this.submit():this._dialogRef.close()}editForm(t){this.form.patchValue({username:t.username,admin:!!t.roles.admin,editor:!!t.roles.editor})}submit(){if((0,l.s)(this.form)){const t=this.format(this.form.value);this._dialogRef.close(t)}}format(t){const s={username:t.username,roles:{user:a.l.user,editor:t.editor?a.l.editor:void 0,admin:t.admin?a.l.admin:void 0}};return(t.password||!this.data)&&(s.password="00000"),s}static#e=this.\u0275fac=function(s){return new(s||n)(e.Y36(r.WI),e.Y36(r.so))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-user-popup"]],decls:15,vars:16,consts:[[3,"config","btnClicked"],[1,"cd-max"],[1,"my-2"],[3,"readonly","config","control"],[1,"container","container-fluid"],[1,"row"],[1,"col-12"],[3,"config","control"],["class","col-12",4,"ngIf"],["class","col-12 my-2",4,"ngIf"],[1,"col-12","my-2"],[1,"d-flex","align-items-center","h-100","ps-2"]],template:function(s,i){1&s&&(e.TgZ(0,"shared-confirm-body",0),e.NdJ("btnClicked",function(g){return i.handleDialogActions(g)}),e.TgZ(1,"div",1)(2,"form",2)(3,"div",2),e._UZ(4,"shared-input",3),e.qZA(),e.ynx(5),e.TgZ(6,"div",4)(7,"div",5)(8,"div",6),e._UZ(9,"shared-checkbox",7),e.qZA(),e.TgZ(10,"div",6),e._UZ(11,"shared-checkbox",7),e.qZA(),e.YNc(12,T,2,3,"div",8),e.YNc(13,x,3,0,"div",9),e.YNc(14,Z,4,3,"div",9),e.qZA()(),e.BQk(),e.qZA()()()),2&s&&(e.Q6J("config",e.VKq(11,I,i.data?"Edit User":"Create New User")),e.xp6(4),e.Q6J("readonly",!!i.data)("config",e.DdM(13,J))("control",i.form.controls.username),e.xp6(5),e.Q6J("config",e.DdM(14,P))("control",i.form.controls.admin),e.xp6(2),e.Q6J("config",e.DdM(15,R))("control",i.form.controls.editor),e.xp6(1),e.Q6J("ngIf",i.data),e.xp6(1),e.Q6J("ngIf",!i.data),e.xp6(1),e.Q6J("ngIf",i.data))},dependencies:[d.O5,c._Y,c.JL,c.F,D.b,b.a,C.F,d.uU],styles:[".cd-max[_ngcontent-%COMP%]{max-height:calc(95vh - 170px);overflow-y:scroll}"]})}return n})();var m=o(9773),v=o(8180),A=o(5649),M=o(2025);const W=function(){return{icon:"edit",ripple:!0}},F=function(){return{icon:"delete",ripple:!0}};let E=(()=>{class n{constructor(t){this._userService=t,this.innerWidth=window.innerWidth}agInit(t){this.cellValue=this.getValueToDisplay(t)}refresh(t){return this.cellValue=this.getValueToDisplay(t),!0}onView(){this._userService.changes$.next({user:this.rowValue,state:"edit"})}onDelete(){this._userService.changes$.next({user:this.rowValue,state:"delete"})}getValueToDisplay(t){return this.rowValue=t.data,t.valueFormatted?t.valueFormatted:t.value}static#e=this.\u0275fac=function(s){return new(s||n)(e.Y36(A.K))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["total-value-component"]],decls:3,vars:4,consts:[[1,"h-100","w-100","d-flex","align-items-center","justify-content-center"],[1,"cursor-pointer",3,"config","click"],[1,"ms-3","cursor-pointer",3,"config","click"]],template:function(s,i){1&s&&(e.TgZ(0,"div",0)(1,"shared-icon",1),e.NdJ("click",function(){return i.onView()}),e.qZA(),e.TgZ(2,"shared-icon",2),e.NdJ("click",function(){return i.onDelete()}),e.qZA()()),2&s&&(e.xp6(1),e.Q6J("config",e.DdM(2,W)),e.xp6(1),e.Q6J("config",e.DdM(3,F)))},dependencies:[M.o]})}return n})();var B=o(6775),V=o(8532),k=o(1961),U=o(5083),p=function(n){return n.new="Create New",n}(p||{});const _=[{path:"",component:(()=>{class n extends B.H{constructor(t,s,i){super(i),this._dialog=t,this._userService=s,this._navService=i,this.innerWidth=window.innerWidth,this.columnDefs=this.getCols(),this.defaultColDef={initialWidth:140,sortable:!0,resizable:!0,filter:!0,flex:1,minWidth:140}}ngOnInit(){this.Navbar_Update({show:!0,back:!1,title:this.NAV_NAMES.USER_MANAGEMENT.children.users.name,buttons:[{label:p.new,prefixIcon:{icon:"add_circle"}}]}),this.NavButtons$.pipe((0,m.R)(this.__unsubscribe$)).subscribe(t=>{t===p.new&&this.openUserPopup()}),this._userService.getAllUsers(),this._userService.changes$.pipe((0,m.R)(this.__unsubscribe$)).subscribe(t=>{"edit"===t.state?t.user?.username&&this.openUserPopup(t.user):"delete"===t.state&&t.user?.username&&this.onDeleteUser(t.user)})}ngOnDestroy(){super.ngOnDestroy(),this._userService.changes$.next({})}onGridReady(t){this._userService.users$.pipe((0,m.R)(this.__unsubscribe$)).subscribe(s=>{s&&(this.rowData=s.map(i=>({...i,isAdmin:!!i.roles.admin,isEditor:!!i.roles.editor,isUser:!!i.roles.user})))})}openUserPopup(t){this._dialog.open(S,{width:"95vw",maxWidth:"400px",maxHeight:"95vh",disableClose:!0,autoFocus:!t,restoreFocus:!1,data:t}).afterClosed().pipe((0,v.q)(1)).subscribe(s=>{s&&t&&this._userService.editUser(s),s&&!t&&this._userService.addNewUser(s)})}onDeleteUser(t){this._dialog.open(V.P,{width:"95vw",maxWidth:"500px",disableClose:!0,restoreFocus:!1,autoFocus:!1,data:{title:"Confirm Delete",bodyMessage:`Are you sure you want to delete ${t?.username}?`,showYesNo:!0,showOk:!1}}).afterClosed().pipe((0,v.q)(1)).subscribe(s=>{s&&"yes"===s&&t?.username&&this._userService.deleteUser(t)})}getCols(){return[{headerName:"Username",field:"username"},{headerName:"Admin",field:"isAdmin"},{headerName:"Editor",field:"isEditor"},{headerName:"User",field:"isUser"},{headerName:"",cellRenderer:E,width:100,minWidth:100,maxWidth:100,sortable:!1,filter:!1,resizable:!1,pinned:"right"}]}onWindowResize(t){this.innerWidth=window.innerWidth}static#e=this.\u0275fac=function(s){return new(s||n)(e.Y36(r.uw),e.Y36(A.K),e.Y36(k.t))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-users"]],hostBindings:function(s,i){1&s&&e.NdJ("resize",function(){return i.onWindowResize()},!1,e.Jf7)},features:[e.qOj],decls:1,vars:10,consts:[[2,"width","100%","min-height","400px","height","calc(100vh - 180px)",3,"rowHeight","columnDefs","defaultColDef","rowData","pagination","paginationAutoPageSize","gridReady"]],template:function(s,i){1&s&&(e.TgZ(0,"ag-grid-angular",0),e.NdJ("gridReady",function(g){return i.onGridReady(g)}),e.qZA()),2&s&&(e.ekj("ag-theme-alpine","light"===i.$theme)("ag-theme-alpine-dark","dark"===i.$theme),e.Q6J("rowHeight",35)("columnDefs",i.columnDefs)("defaultColDef",i.defaultColDef)("rowData",i.rowData)("pagination",i.innerWidth>700)("paginationAutoPageSize",!0))},dependencies:[U.N8]})}return n})()}];let j=(()=>{class n{static#e=this.\u0275fac=function(s){return new(s||n)};static#t=this.\u0275mod=e.oAB({type:n});static#s=this.\u0275inj=e.cJS({imports:[h.Bz.forChild(_),h.Bz]})}return n})();var z=o(9255),Q=o(9781),$=o(7858);let Y=(()=>{class n{static#e=this.\u0275fac=function(s){return new(s||n)};static#t=this.\u0275mod=e.oAB({type:n});static#s=this.\u0275inj=e.cJS({imports:[d.ez,j,U.sF,z.B,r.Is,Q.n,$.j]})}return n})()}}]);