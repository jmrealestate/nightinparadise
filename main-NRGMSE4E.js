import{a as le,b as xe}from"./chunk-KWUEJJJB.js";import{a as d,b as be}from"./chunk-Q4JN4NYI.js";import{a as ce,b as Pe,c as h,d as x}from"./chunk-ICNAXN57.js";import{a as _,b as me}from"./chunk-2JAAJZAJ.js";import{a as pe,b as Ue}from"./chunk-CCRCP4DV.js";import{a as o,b as Y}from"./chunk-APVBAPPR.js";import{Ca as R,Ea as ae,Ga as O,Ha as T,Ta as se,Wa as A,b as $,ba as ie,ca as ke,d as X,e as Z,f as J,g as Q,i as Le,j as q,k as ee,l as te,m as oe,o as ne,p as f,q as re,r as E}from"./chunk-HBX2KYD3.js";import{Fb as j,Gb as K,I as w,J as L,M as k,Q as D,Qb as P,Rb as W,Sb as b,Vc as l,aa as G,ba as B,e as c,f as Ie,h as I,ib as U,la as i,pa as H,sc as F,tb as V,uc as z,v as S}from"./chunk-J2DESNEB.js";var Ye,de,ue=c(()=>{"use strict";l();E();A();Ue();x();l();Ye=e=>({loading:e,disableInteractions:!0}),de=(()=>{let t=class t{constructor(){this._router=i(f),this._navService=i(pe),this._sessionService=i(h),this._keyBlocked=!1,this.loadingRouteSig=V(!1)}ngOnInit(){this._sessionService.updateUser(),this._navService.getThemeOnLoad(),document.addEventListener("keydown",r=>{if(["Enter"," "].includes(r.key)){if(this._keyBlocked){r.preventDefault(),r.stopPropagation();return}this._keyBlocked=!0,setTimeout(()=>{this._keyBlocked=!1},300)}}),this._router.events.subscribe(r=>{r instanceof q?(this.loadingRouteSig.set(!0),window.scrollTo(0,0)):(r instanceof ee||r instanceof oe||r instanceof te)&&this.loadingRouteSig.set(!1)})}};t.\u0275fac=function(s){return new(s||t)},t.\u0275cmp=H({type:t,selectors:[["app-root"]],standalone:!0,features:[F],decls:4,vars:5,consts:[[1,"app-container"],[3,"config"],[1,"global-router-container"]],template:function(s,a){s&1&&(P(0,"div",0),b(1,"ks-loader-overlay",1),P(2,"div",2),b(3,"router-outlet"),W()()),s&2&&(U(),j("config",z(3,Ye,a.loadingRouteSig)),U(),K("display",a.loadingRouteSig()?"none":"block"))},dependencies:[ne,se],styles:[".app-container[_ngcontent-%COMP%], .app-container[_ngcontent-%COMP%]   .global-router-container[_ngcontent-%COMP%]{min-height:100dvh}"],changeDetection:0});let e=t;return e})()});var m,fe=c(()=>{"use strict";l();E();Y();x();m=e=>{let t=i(f),p=i(h);if(!p.loggedInUser)return t.navigate([o.LOGIN.route]),!1;if(!e.data)return!0;let s=e.data.roles;if(!s||!Array.isArray(s)||s.length===0)return!0;let a=p.checkAccess(s);return!a&&t.navigate([o.NOT_AUTHORIZED.route]),a}});var he,ge=c(()=>{"use strict";l();E();Y();x();he=()=>{let e=i(f);return i(h).loggedInUser?(e.navigate([o.LAYOUT.route]),!1):!0}});var Me,Se,Ae=c(()=>{"use strict";Y();fe();ge();be();Me=[{path:"",redirectTo:o.LAYOUT.children.RESERVATIONS.endpoint,pathMatch:"full"},{path:o.LAYOUT.children.CUSTOMERS.endpoint,loadComponent:()=>import("./chunk-2DCUFSWD.js").then(e=>e.CustomersComponent),canActivate:[m]},{path:o.LAYOUT.children.RESERVATIONS.endpoint,loadComponent:()=>import("./chunk-MJMNUCHF.js").then(e=>e.ReservationsComponent),canActivate:[m]},{path:o.LAYOUT.children.BUNGALOWS.endpoint,loadComponent:()=>import("./chunk-NYHRW7EN.js").then(e=>e.BungalowsComponent),canActivate:[m],data:{roles:[d.VIEW_BUNGALOW]}},{path:o.LAYOUT.children.REVIEWS.endpoint,loadComponent:()=>import("./chunk-3S7L6PR6.js").then(e=>e.ReviewsComponent),canActivate:[m],data:{roles:[d.VIEW_REVIEWS]}},{path:o.LAYOUT.children.REVENUES.endpoint,loadComponent:()=>import("./chunk-VPM2NSUM.js").then(e=>e.RevenuesComponent),canActivate:[m],data:{roles:[d.VIEW_REVENUE]}},{path:o.LAYOUT.children.EXPENSES.endpoint,loadComponent:()=>import("./chunk-XT7ESTUZ.js").then(e=>e.ExpensesComponent),canActivate:[m],data:{roles:[d.VIEW_EXPENSE]}},{path:o.LAYOUT.children.USER_MANAGEMENT.endpoint,loadComponent:()=>import("./chunk-TGBPVMI6.js").then(e=>e.UsersComponent),canActivate:[m],data:{roles:[d.VIEW_USER]}},{path:o.LAYOUT.children.REPORTS.endpoint,loadComponent:()=>import("./chunk-OJ556FGV.js").then(e=>e.ReportsComponent),canActivate:[m],data:{roles:[d.VIEW_REPORTS]},children:[{path:"",pathMatch:"full",redirectTo:o.LAYOUT.children.REPORTS.children.YEARLY.endpoint},{path:o.LAYOUT.children.REPORTS.children.YEARLY.endpoint,loadComponent:()=>import("./chunk-52YQYBLK.js").then(e=>e.ReportByYearComponent)},{path:o.LAYOUT.children.REPORTS.children.BENCHMARK.endpoint,loadComponent:()=>import("./chunk-75JOIUHP.js").then(e=>e.ReportBenchmarkComponent)}]}],Se=[{path:"",redirectTo:o.HOME.endpoint,pathMatch:"full"},{path:o.HOME.endpoint,loadComponent:()=>import("./chunk-6MX75RQH.js").then(e=>e.MainPageComponent)},{path:o.LAYOUT.endpoint,loadComponent:()=>import("./chunk-E2IWYNMU.js").then(e=>e.LayoutComponent),children:Me,canActivate:[m]},{path:o.LOGIN.endpoint,loadComponent:()=>import("./chunk-GQIYNUDG.js").then(e=>e.LoginComponent),canActivate:[he]},{path:o.NOT_AUTHORIZED.endpoint,loadComponent:()=>import("./chunk-Y5NJYXZE.js").then(e=>e.NotAuthorizedComponent)},{path:o.PAGE_NOT_FOUND.endpoint,loadComponent:()=>import("./chunk-XYMF357Y.js").then(e=>e.PageNotFoundComponent)},{path:"**",redirectTo:o.PAGE_NOT_FOUND.endpoint,pathMatch:"full"}]});var g,y=c(()=>{"use strict";me();g={API_HOST:_.API_HOST.nip_prod,CONFIG_URL:"assets/config/nip.json"}});function v(e,t){return e.clone({setHeaders:{Authorization:"Bearer "+t.getItem(ce.SS.token,!0)},withCredentials:!0})}var M=c(()=>{"use strict";Pe()});var ve,Ce=c(()=>{"use strict";l();A();B();M();y();me();xe();ve=(e,t)=>{let p=i(R),r=i(le),s=i(T),a=i(O),u;return t(e).pipe(D(()=>{if(u){let n=u;if(n.showMessage&&n.message){let C=Array.isArray(n.message)?n.message.map(N=>({text:N,tag:"p",addClass:"mb-0",translate:!1})):[{text:n.message,translate:!1}];n.isDialog?p.openConfirmPopup({hideYesNo:!0,message:C,title:{text:n.title??"Error",translate:!1}}):s.open({text:C.map(N=>N.text).join(", "),translate:!1},n.state??"error",{duration:n.snackbarDuration})}}}),w(n=>(u=n.error,n.status===401?e.url===g.API_HOST+_.AUTHENTICATION.refresh?(r.logOut(!0),S(()=>n)):r.isRefreshTokenCalled!==!0?(r.isRefreshTokenCalled=!0,r.callRefreshToken().pipe(k(1),L(C=>(r.successfulRefreshToken(C),t(v(e,a)))))):r.refreshToken$.pipe(k(1),L(()=>t(v(e,a)))):n.status===403?(r.isLogoutCalled||(p.closeAll(),p.openConfirmPopup({message:{text:"You don't have permission to access this resource."},title:{text:"Error"},hideYesNo:!0})),r.logOut(!0),S(()=>n)):n.status===0?(p.openConfirmPopup({message:[{tag:"span",text:"Please check your internet connection and ensure it is stable.",addClass:"fw-bold"},{tag:"span",text:"If the issue persists, please contact your administrator for further assistance."}],title:{text:"Something went wrong"},hideYesNo:!0}),S(()=>n)):S(()=>n))))}});var Ee,Re=c(()=>{"use strict";J();l();A();B();Ee=(e,t)=>{let p=i(R),r=i(T);return t(e).pipe(G(s=>{if(s instanceof $&&s.body){let a=s.body;if(a.showMessage&&a.message){let u=Array.isArray(a.message)?a.message.map(n=>({text:n,tag:"p",addClass:"mb-0",translate:!1})):[{text:a.message,translate:!1}];if(a.isDialog){let n={hideYesNo:!0,message:u,title:{text:a.title??"Message",translate:!1}};p.openConfirmPopup(n)}else r.open({text:u.map(n=>n.text).join(", "),translate:!1},a.state??"success",{duration:a.snackbarDuration})}}}))}});var Oe,Te=c(()=>{"use strict";l();A();M();Oe=(e,t)=>{let p=i(O);return t(v(e,p))}});var _e,ye=c(()=>{"use strict";J();ke();E();A();Ae();y();Ce();Re();Te();_e={providers:[re(Se),ie(),X(Z([Oe,ve,Ee])),ae({iconSize:"md",locale:"en-GB",forceLocal:!0,defaultLang:"en",snackbarDuration:3e3,defaultLoaderType:"rings",defaultMaximumNumberLength:15,enableTranslationByDefault:!0,defaultMaximumAfterCommaLength:2,snackbarDefaultPositionY:"bottom",defaultDisableNegativeNumbers:!0,baseNetworkServiceUrl:g.API_HOST,storageSecretKey:"my_night_in_paradise_secret_Key"})]}});var De=Ie(Ne=>{Le();ue();ye();y();I(Ne,null,function*(){yield we(),Q(de,_e).catch(e=>console.error(e))});function we(){return I(this,null,function*(){let e=yield fetch(g.CONFIG_URL);if(!e.ok)throw new Error(`Failed to fetch config: ${e.status} ${e.statusText}`);let t=yield e.json();if(!t||Array.isArray(t)||typeof t!="object")throw new Error("Invalid config structure");localStorage.setItem("config",JSON.stringify(t))})}});export default De();
