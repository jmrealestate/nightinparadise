import{a as c}from"./chunk-JHOHYJWD.js";import{a as s}from"./chunk-IA4DM2LR.js";import{Z as u,ia as E}from"./chunk-XVDAFDV3.js";import{L as p,ca as d,ia as S,n as h,qb as f,x as a,y as m}from"./chunk-PV357URW.js";var y=(()=>{let i=class i{constructor(){this._networkService=S(E),this._expenses$=new h([]),this.dateSig=f(new Date),this.expensesLov$=this._expenses$.pipe(a(e=>{let r=new Map;for(let t of e){let n=t.name.trim();r.has(n)||r.set(n,t.name.trim())}return Array.from(r.values()).map(t=>({name:t,value:t})).sort((t,n)=>t.name.localeCompare(n.name))})),this.filteredExpenses$=m([this._expenses$,u(this.dateSig)]).pipe(a(([e,r])=>{let t=(r.getMonth()+1).toString().padStart(2,"0"),n=r.getFullYear();return e.filter(l=>l.date.startsWith(`${n}-${t}`))}))}changeDate(e){this.dateSig.update(r=>{if(typeof e=="string"){let t=new Date(r);return t.setDate(15),e==="next"?t.setMonth(r.getMonth()+1):t.setMonth(r.getMonth()-1),t}else return new Date(e.year,e.month-1,15)})}getExpenses(){this._networkService.get(s.EXPENSES).pipe(p(1)).subscribe({next:e=>{e.data&&this._expenses$.next(e.data)}})}addExpense(e){return this._networkService.post(s.EXPENSES,e)}updateExpense(e){return this._networkService.patch(s.EXPENSES,e,e._id)}deleteExpense(e){this._networkService.delete(s.EXPENSES,void 0,e._id).pipe(p(1)).subscribe(()=>{c.UpdateArrayBehaviorSubject(this._expenses$,e,"delete","_id")})}_update(e,r){c.UpdateArrayBehaviorSubject(this._expenses$,e,r,"_id")}};i.\u0275fac=function(r){return new(r||i)},i.\u0275prov=d({token:i,factory:i.\u0275fac,providedIn:"root"});let o=i;return o})();export{y as a};
