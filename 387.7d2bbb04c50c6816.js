"use strict";(self.webpackChunknight_in_paradise=self.webpackChunknight_in_paradise||[]).push([[387],{7732:(y,S,r)=>{r.d(S,{Fh:()=>n,MF:()=>p,OP:()=>P,PM:()=>d,RZ:()=>l,UD:()=>t,UV:()=>f,aL:()=>g,iP:()=>h,rY:()=>i,se:()=>c,uf:()=>v});var o=r(1241);const v=(0,o.PH)("[Reservations] get all reservations"),i=(0,o.PH)("[Reservations] all reservations loaded successfully",(0,o.Ky)()),d=(0,o.PH)("[Reservations] all reservations failed loading",(0,o.Ky)()),P=(0,o.PH)("[Reservations] request add reservation"),f=(0,o.PH)("[Reservations] delete reservation failed",(0,o.Ky)()),c=(0,o.PH)("[Reservations] edit reservation request",(0,o.Ky)()),l=(0,o.PH)("[Reservations] add reservation",(0,o.Ky)()),h=(0,o.PH)("[Reservations] add reservation success",(0,o.Ky)()),t=(0,o.PH)("[Reservations] edit reservation",(0,o.Ky)()),n=(0,o.PH)("[Reservations] edit reservation success",(0,o.Ky)()),g=(0,o.PH)("[Reservations] delete reservation",(0,o.Ky)()),p=(0,o.PH)("[Reservations] delete reservation success",(0,o.Ky)())},978:(y,S,r)=>{r.d(S,{Lz:()=>d,Qb:()=>i,X3:()=>h,eJ:()=>f,h4:()=>l,lY:()=>c});var o=r(1241);const v=t=>t.reservations,i=(0,o.P1)(v,t=>t.allReservations),d=(0,o.P1)(v,t=>t.status),f=((0,o.P1)(v,t=>t.error),(0,o.P1)(v,t=>t.customersNames)),c=(0,o.P1)(v,t=>t.reservationStatus),l=(0,o.P1)(v,t=>t.reservationError),h=(0,o.P1)(v,t=>t.reservation)},6387:(y,S,r)=>{r.r(S),r.d(S,{ReservationShellModule:()=>N});var o=r(4755),v=r(2280),i=r(9523);const d=[{path:"",redirectTo:"calendar",pathMatch:"full"},{path:"calendar",loadChildren:()=>Promise.all([r.e(592),r.e(513)]).then(r.bind(r,1513)).then(e=>e.AllReservationsModule)}];let P=(()=>{class e{}return e.\u0275fac=function(a){return new(a||e)},e.\u0275mod=i.oAB({type:e}),e.\u0275inj=i.cJS({imports:[v.Bz.forChild(d),v.Bz]}),e})();var f=r(5428),c=r(7654),l=r(2512);let h=(()=>{class e{constructor(a){this._networkService=a}getAllReservations(){return this._networkService.get(c.b.RESERVATIONS)}addNewReservation(a){return this._networkService.post(c.b.RESERVATIONS,a)}editReservation(a){return this._networkService.patch(c.b.RESERVATIONS,a,a._id)}deleteReservation(a){return this._networkService.delete(c.b.RESERVATIONS,a)}}return e.\u0275fac=function(a){return new(a||e)(i.LFG(l.S))},e.\u0275prov=i.Yz7({token:e,factory:e.\u0275fac}),e})();var t=r(1241),n=r(7732),g=r(7946);const T=(0,t.Lq)({allReservations:[],customersNames:[],reservation:{bookedDate:"",notes:"",number:0,person:{contact:"",name:""},_id:"",price:0},error:null,status:"Pending",reservationError:null,reservationStatus:"Pending"},(0,t.on)(n.uf,e=>({...e,status:"Loading"})),(0,t.on)(n.rY,(e,s)=>({...e,allReservations:s.reservations,error:null,status:"Success",customersNames:M(s.reservations)})),(0,t.on)(n.PM,(e,s)=>({...e,error:(0,g.V)(s.error),status:"Error"})),(0,t.on)(n.OP,e=>({...e,reservationStatus:"Pending",reservationError:null})),(0,t.on)(n.UV,(e,s)=>({...e,reservationError:(0,g.V)(s.error),reservationStatus:"Error"})),(0,t.on)(n.se,(e,s)=>({...e,reservation:s.reservation,reservationError:null,reservationStatus:"Pending"})),(0,t.on)(n.RZ,(e,s)=>({...e,reservationStatus:"Loading",reservation:s.reservation})),(0,t.on)(n.iP,(e,s)=>({...e,allReservations:[...e.allReservations,s.reservation],reservationError:null,reservationStatus:"Success",customersNames:M(e.allReservations)})),(0,t.on)(n.UD,(e,s)=>({...e,reservationStatus:"Loading",reservation:s.reservation})),(0,t.on)(n.Fh,(e,s)=>({...e,allReservations:C(e.allReservations,s.reservation),reservationError:null,reservationStatus:"Success",customersNames:M(e.allReservations)})),(0,t.on)(n.aL,(e,s)=>({...e,reservationStatus:"Loading",reservation:s.reservation})),(0,t.on)(n.MF,(e,s)=>({...e,allReservations:F(e.allReservations,s.reservation),reservationError:null,reservationStatus:"Success",customersNames:M(e.allReservations)})));function M(e){let s=[];return e.forEach(a=>{s.includes(a.person.name.toLowerCase())||s.push(a.person.name.toLowerCase()),s.sort()}),s}function C(e,s){let a=e.filter(m=>m._id!==s._id);return a.push(s),a}function F(e,s){return e.filter(m=>m._id!==s._id)}var u=r(8057),O=r(3900),D=r(4004),L=r(262),U=r(9646),A=r(9234),I=r(8577);let K=(()=>{class e{constructor(a,m,V,B){this._actions$=a,this._reservationService=m,this._router=V,this._snackbar=B,this.loadAllReservations$=(0,u.GW)(()=>this._actions$.pipe((0,u.l4)(n.uf),(0,O.w)(()=>this._reservationService.getAllReservations().pipe((0,D.U)(R=>(0,n.rY)({reservations:R.reservations})),(0,L.K)(R=>(this._snackbar.showError(A.l.RESERVATIONS.LIST_ERROR),(0,U.of)((0,n.PM)({error:R.status})))))))),this.AddReservation$=(0,u.GW)(()=>this._actions$.pipe((0,u.l4)(n.RZ),(0,O.w)(R=>this._reservationService.addNewReservation(R.reservation).pipe((0,D.U)(E=>(this._router.navigateByUrl("reservations/calendar"),this._snackbar.showSuccess(A.l.RESERVATIONS.ADD_SUCCESS),(0,n.iP)({reservation:E}))),(0,L.K)(E=>(this._snackbar.showError(A.l.RESERVATIONS.ADD_ERROR),(0,U.of)((0,n.UV)({error:E.status})))))))),this.EditReservation$=(0,u.GW)(()=>this._actions$.pipe((0,u.l4)(n.UD),(0,O.w)(R=>this._reservationService.editReservation(R.reservation).pipe((0,D.U)(E=>(this._router.navigateByUrl("reservations/calendar"),this._snackbar.showSuccess(A.l.RESERVATIONS.PATCH_SUCCESS),(0,n.Fh)({reservation:E}))),(0,L.K)(E=>(this._snackbar.showError(A.l.RESERVATIONS.PATCH_ERROR),(0,U.of)((0,n.UV)({error:E.status})))))))),this.DeleteReservation$=(0,u.GW)(()=>this._actions$.pipe((0,u.l4)(n.aL),(0,O.w)(R=>this._reservationService.deleteReservation(R.reservation._id).pipe((0,D.U)(()=>(this._router.navigateByUrl("reservations/calendar"),this._snackbar.showSuccess(A.l.RESERVATIONS.DELETE_SUCCESS),(0,n.MF)({reservation:R.reservation}))),(0,L.K)(E=>(this._snackbar.showError(A.l.RESERVATIONS.DELETE_ERROR),(0,U.of)((0,n.UV)({error:E.status}))))))))}}return e.\u0275fac=function(a){return new(a||e)(i.LFG(u.eX),i.LFG(h),i.LFG(v.F0),i.LFG(I.o))},e.\u0275prov=i.Yz7({token:e,factory:e.\u0275fac}),e})(),N=(()=>{class e{}return e.\u0275fac=function(a){return new(a||e)},e.\u0275mod=i.oAB({type:e}),e.\u0275inj=i.cJS({providers:[f.S,h],imports:[o.ez,P,t.Aw.forFeature("reservations",T),u.sQ.forFeature([K])]}),e})()},5428:(y,S,r)=>{r.d(S,{S:()=>c});var o=r(978),v=r(2722),i=r(3772),d=r(9523),P=r(1241),f=r(2280);let c=(()=>{class l extends i.f{constructor(t,n){super(),this._store=t,this._router=n,this.$=this._store.select(o.X3).pipe((0,v.R)(this.unsubscribe$)).subscribe(g=>this.reservation=g)}canActivate(){return""!==this.reservation._id||(this._router.navigateByUrl("reservations/calendar"),!1)}}return l.\u0275fac=function(t){return new(t||l)(d.LFG(P.yh),d.LFG(f.F0))},l.\u0275prov=d.Yz7({token:l,factory:l.\u0275fac}),l})()}}]);